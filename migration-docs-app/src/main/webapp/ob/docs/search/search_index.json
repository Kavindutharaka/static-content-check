{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"page-not-found/","title":"Page not found","text":"<p> Page Not Found <p>Sorry, but the page you are looking for does not exist, has been removed, renamed, or is temporarily unavailable. Please try using one of the navigation links above or the search bar in the top right corner.</p> <p>For further inquiries, reach us at the <code>help-asgardeo</code> channel in the WSO2 Discord server.             Alternatively, you can reach out to the Asgardeo support team.</p> </p>"},{"location":"open-banking/migration-docs/ob-1.2.0-to-1.3.0/upgrading-wso2-ob-130-for%20uk/","title":"Upgrade the Solution to 1.3.0 for UK","text":"<p>Follow the steps below to upgrade WSO2 Open Banking from 1.2.0 to 1.3.0.</p>"},{"location":"open-banking/migration-docs/ob-1.2.0-to-1.3.0/upgrading-wso2-ob-130-for%20uk/#step-1-update-your-applications","title":"Step 1: Update your applications","text":"<p>In your new setup, update the following applications:</p> In WSO2 API Manager In Key Manager - API Store Jaggery App - Consent Revocations App - API Publisher Jaggery App - Authentication Endpoint App - API Admin Jaggery App"},{"location":"open-banking/migration-docs/ob-1.2.0-to-1.3.0/upgrading-wso2-ob-130-for%20uk/#step-2-migrate-your-data-to-the-new-setup","title":"Step 2: Migrate your data to the new setup","text":"<p>After the applications are updated, point to your databases from the new setup.</p> <p>Note</p> <p>If you want to configure the new setup with previously used databases, set up the <code>REGISTRY_DB</code> database separately.</p> <ol> <li> <p>Stop all Open Banking servers that are running.</p> </li> <li> <p>Take a backup of <code>WSO2_CONSENT_DB</code>, which is configured in <code>&lt;WSO2_OBKM_HOME&gt;/repository/conf/datasources/open-banking-datasources.xml</code> as shown in the example below.</p> <pre><code>&lt;datasources&gt;\n       &lt;datasource&gt;\n           &lt;name&gt;WSO2_CONSENT_DB&lt;/name&gt;\n           &lt;description&gt;The datasource used for registry and user manager&lt;/description&gt;\n           &lt;jndiConfig&gt;\n               &lt;name&gt;jdbc/WSO2ConsentDB&lt;/name&gt;\n           &lt;/jndiConfig&gt;\n           &lt;definition type=\"RDBMS\"&gt;\n               &lt;configuration&gt;\n                   &lt;url&gt;jdbc:mysql://localhost:3306/openbank_consentdb_dev?autoReconnect=true&amp;amp;useSSL=false&lt;/url&gt;\n</code></pre> </li> </ol> <p>Info</p> <ul> <li>Note that the migration scripts are available in the data-migration   directory. By default, the consent database's name is given as    <code>openbank_consentdb</code> in the migration scripts. If your consent database's  name is different to that, replace <code>openbank_consentdb</code> with your database's     name in the migration scripts.</li> <li>Note that the event-notification tables that existed in a separate database   in previous versions, were moved to the consent-db database.</li> </ul> <ol> <li>Execute the SQL script in the <code>&lt;WSO2_OBKM_HOME&gt;/dbscripts/finance/openbanking.org.uk/migration-from-1.2.0/</code> against <code>WSO2_CONSENT_DB</code>. It changes the existing database according to the requirements of WSO2 Open Banking version 1.3.0.</li> </ol> <p>Note</p> <p>This step is needed only if your database is MySQL.</p> <ol> <li>Execute the data migration script that is relevant to your database type in the <code>&lt;WSO2_OBKM_HOME&gt;/dbscripts/finance/openbanking.org.uk/migration-from-1.2.0/data-migration/ directory against WSO2_CONSENT_DB</code> to insert/ update existing data according to the requirements of WSO2 Open Banking version 1.3.0.</li> </ol> <p>Note</p> <p>Note that the migration scripts are compatible only with Oracle 12c release   2 or newer.</p> <ol> <li>Create table <code>AM_API_CLIENT_CERTIFICATE</code> under the datasource <code>WSO2AM_DB</code> by executing the following configuration based on your database.</li> </ol> <p>MySQL</p> <pre><code>CREATE TABLE IF NOT EXISTS `AM_API_CLIENT_CERTIFICATE` (\n `TENANT_ID` INT(11) NOT NULL,\n `ALIAS` VARCHAR(45) NOT NULL,\n `API_ID` INTEGER NOT NULL,\n `CERTIFICATE` BLOB NOT NULL,\n `REMOVED` BOOLEAN NOT NULL DEFAULT 0,\n `TIER_NAME` VARCHAR (512),\n FOREIGN KEY (API_ID) REFERENCES AM_API (API_ID) ON DELETE CASCADE ON UPDATE CASCADE,\n PRIMARY KEY (`ALIAS`, `TENANT_ID`, `REMOVED`)\n) ENGINE=InnoDB;\n</code></pre> <p>MSSQL</p> <pre><code>IF NOT  EXISTS (SELECT * FROM SYS.OBJECTS WHERE OBJECT_ID = OBJECT_ID(N'[DBO].[AM_API_CLIENT_CERTIFICATE]') AND TYPE IN (N'U'))\nCREATE TABLE AM_API_CLIENT_CERTIFICATE (\n   TENANT_ID INTEGER NOT NULL,\n   ALIAS VARCHAR(45) NOT NULL,\n   API_ID INTEGER NOT NULL,\n   CERTIFICATE VARBINARY(MAX) NOT NULL,\n   REMOVED BIT NOT NULL DEFAULT 0,\n   TIER_NAME VARCHAR(512),\n   PRIMARY KEY (ALIAS, TENANT_ID, REMOVED),\n   FOREIGN KEY (API_ID) REFERENCES AM_API(API_ID) ON DELETE CASCADE\n);\n</code></pre> <p>Oracle</p> <pre><code>CREATE TABLE AM_API_CLIENT_CERTIFICATE (\n TENANT_ID INTEGER NOT NULL,\n ALIAS VARCHAR2(45) NOT NULL,\n API_ID INTEGER NOT NULL,\n CERTIFICATE BLOB NOT NULL,\n REMOVED INTEGER DEFAULT 0 NOT NULL,\n TIER_NAME VARCHAR2 (512),\n FOREIGN KEY (API_ID) REFERENCES AM_API (API_ID) ON DELETE CASCADE,\n PRIMARY KEY (ALIAS, TENANT_ID, REMOVED)\n)\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.2.0-to-1.3.0/upgrading-wso2-ob-130-for-berlin/","title":"Upgrade the Solution to 1.3.0 for Berlin","text":"<p>Follow the steps below to upgrade WSO2 Open Banking from 1.2.0 to 1.3.0.</p>"},{"location":"open-banking/migration-docs/ob-1.2.0-to-1.3.0/upgrading-wso2-ob-130-for-berlin/#step-1-update-your-applications","title":"Step 1: Update your applications","text":"<p>In your new setup, update the following applications:</p> In WSO2 API Manager In Key Manager - API Store Jaggery App - Consent Revocations App - API Publisher Jaggery App - Authentication Endpoint App - API Admin Jaggery App"},{"location":"open-banking/migration-docs/ob-1.2.0-to-1.3.0/upgrading-wso2-ob-130-for-berlin/#step-2-migrate-your-data-to-the-new-setup","title":"Step 2: Migrate your data to the new setup","text":"<p>After the applications are updated, point to your databases from the new setup.</p> <p>Note</p> <p>If you want to configure the new setup with previously used databases, set up the <code>REGISTRY_DB</code> database separately.</p> <ol> <li> <p>Stop all Open Banking servers that are running.</p> </li> <li> <p>Take a backup of <code>WSO2_CONSENT_DB</code>, which is configured in <code>&lt;WSO2_OBKM_HOME&gt;/repository/conf/datasources/open-banking-datasources.xml</code> as shown in the example below.</p> </li> </ol> <pre><code>&lt;datasources&gt;\n        &lt;datasource&gt;\n            &lt;name&gt;WSO2_CONSENT_DB&lt;/name&gt;\n            &lt;description&gt;The datasource used for registry and user  manager&lt;/description&gt;\n            &lt;jndiConfig&gt;\n                &lt;name&gt;jdbc/WSO2ConsentDB&lt;/name&gt;\n            &lt;/jndiConfig&gt;\n            &lt;definition type=\"RDBMS\"&gt;\n                &lt;configuration&gt;\n                    &lt;url&gt;jdbc:mysql://localhost:3306/   openbank_consentdb_dev?autoReconnect=true&amp;amp; useSSL=false&lt;/url&gt;\n</code></pre> <p>Info</p> <ul> <li>Note that the migration scripts are available in the data-migration directory. By default, the consent database's name is given as <code>openbank_consentdb</code> in the migration scripts. If your consent database's name is different to that, replace <code>openbank_consentdb</code> with your database's name in the migration scripts.</li> </ul> <ol> <li>Execute the relevant data migration script given below according to your database type against <code>WSO2_CONSENT_DB</code> to insert/ update existing data according to the requirements of WSO2 Open Banking version 1.3.0.</li> </ol> <p>MySQL</p> <pre><code>```\n&lt;obkm-home&gt;/dbscripts/finance/berlin-group.org/migration-1.2.0_to_1.3.0/mysql.sql\n```\n</code></pre> <p>MSSQL</p> <pre><code>```\n&lt;obkm-home&gt;/dbscripts/finance/berlin-group.org/migration-1.2.0_to_1.3.0/mssql.sql\n```\n</code></pre> <p>Oracle</p> <pre><code>```\n&lt;obkm-home&gt;/dbscripts/finance/berlin-group.org/oracle.sql\n```\n</code></pre> <ol> <li>Create table <code>AM_API_CLIENT_CERTIFICATE</code> under the datasource <code>WSO2AM_DB</code> by executing the following configuration based on your database.</li> </ol> <p>MySQL</p> <pre><code>```\nCREATE TABLE IF NOT EXISTS `AM_API_CLIENT_CERTIFICATE` (\n `TENANT_ID` INT(11) NOT NULL,\n `ALIAS` VARCHAR(45) NOT NULL,\n `API_ID` INTEGER NOT NULL,\n `CERTIFICATE` BLOB NOT NULL,\n `REMOVED` BOOLEAN NOT NULL DEFAULT 0,\n `TIER_NAME` VARCHAR (512),\n FOREIGN KEY (API_ID) REFERENCES AM_API (API_ID) ON DELETE CASCADE ON UPDATE CASCADE,\n PRIMARY KEY (`ALIAS`, `TENANT_ID`, `REMOVED`)\n) ENGINE=InnoDB;\n```\n</code></pre> <p>MSSQL</p> <pre><code>```\nIF NOT  EXISTS (SELECT * FROM SYS.OBJECTS WHERE OBJECT_ID = OBJECT_ID(N'[DBO].  [AM_API_CLIENT_CERTIFICATE]') AND TYPE IN (N'U'))\nCREATE TABLE AM_API_CLIENT_CERTIFICATE (\n   TENANT_ID INTEGER NOT NULL,\n   ALIAS VARCHAR(45) NOT NULL,\n   API_ID INTEGER NOT NULL,\n   CERTIFICATE VARBINARY(MAX) NOT NULL,\n   REMOVED BIT NOT NULL DEFAULT 0,\n   TIER_NAME VARCHAR(512),\n   PRIMARY KEY (ALIAS, TENANT_ID, REMOVED),\n   FOREIGN KEY (API_ID) REFERENCES AM_API(API_ID) ON DELETE CASCADE\n);\n```\n</code></pre> <p>Oracle</p> <pre><code>```\nCREATE TABLE AM_API_CLIENT_CERTIFICATE (\n TENANT_ID INTEGER NOT NULL,\n ALIAS VARCHAR2(45) NOT NULL,\n API_ID INTEGER NOT NULL,\n CERTIFICATE BLOB NOT NULL,\n REMOVED INTEGER DEFAULT 0 NOT NULL,\n TIER_NAME VARCHAR2 (512),\n FOREIGN KEY (API_ID) REFERENCES AM_API (API_ID) ON DELETE CASCADE,\n PRIMARY KEY (ALIAS, TENANT_ID, REMOVED)\n)\n```\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/authentication-script/","title":"Authentication Script","text":"<p>The <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/conf/finance/common.auth.script.js</code> authentication script is introduced, with the latest release of the Transactional Risk Analysis (TRA) module. The script supports the following functionalities.</p> <p>When the second factor is enabled:</p> <ul> <li>When TRA is enabled, the script executes the TRA functions and applies Strong Customer Authentication.</li> <li>Publishes authentication data for Data Reporting.</li> </ul> <p>Note</p> <p>If you have customized <code>&lt;WSO2_OB_APIM_130_HOME&gt;/repository/conf/finance/conditional.auth.script.js</code>, update your script with the new changes in the <code>common.auth.script.js</code>.</p> <p>Run the relevant migration script, to store common.auth.script.js as the new conditional auth script against the existing service providers.</p> <ul> <li>The migration scripts are available in the <code>&lt;WSO2_OB_KM_140_HOME&gt;/dbscripts/finance/openbanking.org.uk/migration-from-1.3.0</code> directory.</li> <li>Select the script, according to your database.</li> <li>Update path to conditional auth script variable as follows:</li> </ul> <p>MySQL</p> <pre><code>```\npath to conditional auth script: The path to common.auth.script.js (including the filename).\n```\n</code></pre> <p>MSSQL</p> <pre><code>```\npath to conditional auth script: The path to common.auth.script.js (including the filename).\n```\n</code></pre> <p>Oracle</p> <pre><code>```\npath to conditional auth script: The path to common.auth.script.js (excluding the filename).\n```\n</code></pre> <ul> <li>Run the relevant script against the <code>openbank_apimgtdb</code> database.</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/custom-configurations/","title":"Custom configurations","text":"<p>Copy the following configurations from WSO2 Open Banking 1.3.0 to WSO2 Open Banking 1.4.0:</p> Content Copy from Copy to Synapse configurations <code>&lt;WSO2_OB_APIM_130_HOME&gt;/repository/deployment/server/synapse-configs</code> <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/deployment/server/synapse-configs</code> Custom configurations <code>&lt;WSO2_OB_KM_130_HOME&gt;/repository/conf</code> <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/deployment/server/synapse-configs</code> Custom configurations <code>&lt;WSO2_OB_APIM_130_HOME&gt;/repository/conf</code> <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/conf</code> Custom OSGI bundles <code>&lt;WSO2_OB_KM_130_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_KM_140_HOME&gt;/repository/components/dropins</code> Custom OSGI bundles <code>&lt;WSO2_OB_APIM_130_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/components/dropins</code> Custom JAR files <code>&lt;WSO2_OB_KM_130_HOME&gt;/repository/components/lib</code> <code>&lt;WSO2_OB_KM_140_HOME&gt;/repository/components/lib</code> Custom JAR files <code>&lt;WSO2_OB_APIM_130_HOME&gt;/repository/components/lib</code> <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/components/lib</code>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/datasource-changes/","title":"Datasource changes","text":"<p>Warning</p> <p>The following datasource and database are renamed. - The <code>WSO2_CONSENT_DB</code> datasource is renamed as <code>WSO2_OPEN_BANKING_DB</code>. - The <code>openbank_consentdb</code> database is renamed as <code>openbank_openbankingdb</code>.</p> <p>Update the <code>WSO2_CONSENT_DB</code> datasource values and set them to <code>WSO2_OPEN_BANKING_DB</code> in the following files:</p> <ul> <li><code>&lt;WSO2_OB_KM_HOME&gt;/repository/conf/datasources/master-datasources.xml</code></li> <li><code>&lt;WSO2_OB_KM_HOME&gt;/repository/conf/finance/open-banking.xml</code></li> <li><code>&lt;WSO2_OB_APIM_HOME&gt;/repository/conf/datasources/master-datasources.xml</code></li> <li><code>&lt;WSO2_OB_APIM_HOME&gt;/repository/conf/finance/open-banking.xml</code></li> </ul>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/db-and-synapse-configurations/","title":"Databases and Synapse configurations","text":"<ul> <li>Take a backup of the existing database used by WSO2 Open Banking 1.3.0. This backup is necessary in case the migration causes issues in the existing database.</li> <li>Take a backup of the existing synapse configurations in WSO2 Open Banking 1.3.0. The synapse configuration is available in the <code>&lt;WSO2_OB_APIM_HOME&gt;/repository/deployment/server/synapse-configs</code> directory.</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/fraud-detection/","title":"Fraud Detection","text":"<p>Fraud Detection is for transaction monitoring mechanisms to detect unauthorized or fraudulent transactions and generate alerts. It also exempts the security requirements of strong customer authentication based on the identified level of risk and recurrence of the payment transaction.</p> <p>Open the <code>&lt;WSO2_OB_KM_HOME&gt;/repository/conf/finance/open-banking.xml</code> and <code>&lt;WSO2_OB_APIM_HOME&gt;/repository/conf/finance/open-banking.xml</code> files to enable Fraud Detection:</p> <ol> <li> <p>Set the <code>&lt;IsEnabled&gt;</code> property under <code>&lt;FraudDetection&gt;</code> to true to enable the feature.</p> </li> <li> <p>Replace the <code>&lt;WSO2_OB_BI_HOST&gt;</code> place holder with the hostname of the Business Intelligence server.</p> <pre><code>&lt;BIServer&gt;\n    &lt;!-- Include all configurations related to OBBI component --&gt;\n    &lt;FraudDetection&gt;\n        &lt;!-- Include all configurations related to Fraud Detection --&gt;\n\n        &lt;!-- Enable FD in WSO2 Open Banking--&gt;\n        &lt;IsEnabled&gt;true&lt;/IsEnabled&gt;\n        &lt;!-- Configurations related to FD Receivers--&gt;\n        &lt;Receivers&gt;\n            &lt;!-- Administrator username to login to the remote BI server. --&gt;\n            &lt;Username&gt;admin@wso2.com@carbon.super&lt;/Username&gt;\n            &lt;!-- Administrator password to login to the remote BI server. --&gt;\n            &lt;Password&gt;wso2123&lt;/Password&gt;\n            &lt;!-- Receiver URLs of the Siddhi Apps used to validate for FD.--&gt;\n            &lt;FraudDetectionURL&gt;http://&lt;WSO2_OB_BI_HOST&gt;:8007/FraudDetectionApp/FraudDetectionStream&lt;/FraudDetectionURL&gt;\n            &lt;InvalidSubmissionURL&gt;http://&lt;WSO2_OB_BI_HOST&gt;:8006/InvalidSubmissionsApp/InvalidSubmissionsStream&lt;/InvalidSubmissionURL&gt;\n        &lt;/Receivers&gt;\n    &lt;/FraudDetection&gt;\n&lt;/BIServer&gt;\n</code></pre> </li> <li> <p>Open the <code>&lt;WSO2_OB_BI_HOME&gt;/deployment/siddhi-files/FraudStatusUpdaterApp.siddhi</code> file and update <code>&lt;localhost&gt;</code> in the receiver URL with the hostname of your WSO2 OB BI server.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_BI_HOME&gt;/conf/dashboard/deployment.yaml</code>. Add the <code>APIM-alerts.enabled</code> and <code>wso2-is-analytics</code> configurations under <code>analytics.solutions</code> and set as <code>false</code>. Once you add the configurations, the <code>deployment.yaml</code> file should be as follows:</p> </li> </ol> <pre><code>    analytics.solutions:\n        IS-analytics.enabled: false\n        APIM-analytics.enabled: true\n        EI-analytics.enabled: false\n        APIM-alerts.enabled: false\n        wso2-is-analytics: false\n</code></pre> <ol> <li> <p>Open the <code>&lt;WSO2_OB_BI_HOME&gt;/conf/worker/deployment.yaml</code> file and configure <code>auth.configs</code>:</p> <ul> <li>username: <code>admin@wso2.com@carbon.super</code></li> <li>password: <code>d3NvMjEyMw==</code> (Password is <code>wso2123</code>. Make sure you encode the password with Base64).</li> </ul> <pre><code>auth.configs:\n    type: 'local'\n    userManager:\n        adminRole: admin\n        userStore:\n            users:\n            -\n                user:\n                    username: admin@wso2.com@carbon.super\n                    password: d3NvMjEyMw==\n                    roles: 1\n            roles:\n            -\n                role:\n                    id: 1\n                    displayName: admin\n</code></pre> </li> <li> <p>Once you configure the TRA and FD modules, start the servers in the order of:</p> <ol> <li>Dashboard profile in WSO2 OB BI</li> <li>Worker profile in WSO2 OB BI</li> <li>WSO2 OB KM</li> <li>WSO2 OB APIM</li> </ol> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/key-manager-extension/","title":"Key Manager Extension","text":"<p>The Key Manager Extension is upgraded for Data Reporting.</p> <p>If you have customized the default WSO2 Open Banking Key Manager extension:</p> <ul> <li>Extend it from the WSO2 Open Banking Keymanger extension.</li> <li>Set the authentication steps according to the WSO2 Open Banking Keymanger extension.</li> </ul> <p>For more information see, Customising Key Manager extension.</p>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/psd2-data-reporting/","title":"PSD2 Data Reporting","text":"<p>If you are using WSO2 Open Banking Business Intelligence (WSO2 OB BI) for PSD2 Data Reporting, execute the relevant database script against the mentioned database.</p> Database Script location <code>openbank_ob_reporting_statsdb</code> <code>&lt;WSO2_OB_BI_HOME&gt;/resources/finance/dbscripts/migration/stats_db/migration-1.3.0_to_1.4.0</code>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/request-payload-validation/","title":"Request Payload Validation","text":"<p>Request Payload Validation adds flexibility to validate an incoming request against any customisations done to the swagger definition. You need to republish the API to apply the swagger based validations.</p> <p>Note</p> <p>Follow the steps below to use the Request Payload Validation feature, if you haven't applied the WUM update released on June 25, 2019 (06-25-2019). </p> <ol> <li> <p>Go to the API Manager Management Console at https://:9443/carbon. <li> <p>Navigate to the Extensions tab and click Lifecycles.</p> </li> <p></p> <ol> <li> <p>Click View/Edit of APILifeCycle.</p> </li> <li> <p>Add the following changes to the XML file, under the respective tags to enable publishing the swagger as a local entry in the <code>&lt;WSO2_OB_APIM_HOST&gt;/repository/deployment/server/synapse-configs/default/local-entries</code> directory.</p> </li> <li> <p>In the <code>state id= \"Published\"</code> element, add a new execution element under <code>transitionExecution</code> data with the properties below:</p> <pre><code>&lt;state id=\"Published\"&gt;\n    &lt;datamodel&gt;\n        &lt;data name=\"transitionExecution\"&gt;\n            &lt;execution forEvent=\"Publish\"\n           class=\"com.wso2.finance.open.banking.api.executor.OBAPIPublisherExecutor\"&gt;&lt;/ execution&gt;\n        &lt;/data&gt;\n    &lt;/datamodel&gt;\n&lt;/state&gt;\n</code></pre> </li> <li> <p>In the state <code>id=\"Created\"</code> element, under <code>data name=\"transitionExecution\"</code> find the default execution class value for event <code>Publish</code>. Replace that default execution class with <code>com.wso2.finance.open.banking.api.executor.OBAPIPublisherExecutor</code> as follows:</p> <pre><code>&lt;state id=\"Created\"&gt;\n    &lt;datamodel&gt;\n        &lt;data name=\"transitionExecution\"&gt;\n            &lt;execution forEvent=\"Publish\"\n      class=\"com.wso2.finance.open.banking.api.executor.OBAPIPublisherExecutor\"&gt;&lt;/  execution&gt;\n        &lt;/data&gt;\n    &lt;/datamodel&gt;\n&lt;/state&gt;\n</code></pre> </li> <li> <p>Republish the APIs.</p> </li> </ol> <p>You need to republish the API to apply the swagger based validations. Therefore, follow the steps below:</p> <p>a. Sign in to the API Publisher at <code>https://&lt;WSO2_OB_APIM_HOST&gt;:9443/publisher</code>  using the credentials of a user, whose role is an API Publisher. For more information on users and roles, see here.</p> <p>b. Select the respective API and click Edit API.</p> <p></p> <p>c. You are redirected to the Design phase. Click the Edit Source button under   the API Definition section.</p> <p></p> <p>d. Click Apply Changes to save the changes and go back to the Design page.</p> <p></p> <p>e. Scroll down and click Save.</p> <p>f. Click Next: Implement &gt; Next: Manage and Save and Publish.</p>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/transaction-risk-analysis/","title":"Transaction Risk Analysis (TRA)","text":"<p>Transaction Risk Analysis enables analyzing the risk level based on predefined rules and exempts the user from having to provide the second factor.</p> <ol> <li>Open the <code>&lt;WSO2_OB_KM_HOME&gt;/repository/conf/finance/open-banking.xml</code> and <code>&lt;WSO2_OB_APIM_HOME&gt;/repository/conf/finance/open-banking.xml</code> files to enable Transaction Risk Analysis (TRA):</li> </ol> <p>a. Set the <code>&lt;IsEnabled&gt;</code> property under <code>&lt;TRA&gt;</code> to true to enable the TRA feature.</p> <p>b. Replace the <code>&lt;WSO2_OB_BI_HOST&gt;</code> place holder with the hostname of the Business   Intelligence server.</p> <p>c. To enable TRA for:</p> <ul> <li>payments, set the <code>&lt;PaymentValidationEnabled&gt;</code> property to <code>true</code></li> <li>accounts, set the <code>&lt;AccountValidationEnabled&gt;</code> property to <code>true</code></li> </ul> <p>d. The configurations related to TRA Receivers are under the <code>&lt;Receivers&gt;</code> property. You may use the default WSO2 Open Banking Business Intelligence server username and password. Replace the placeholders in <code>&lt;TRAAccountValidationURL&gt;</code> and  <code>&lt;TRAPaymentValidationURL&gt;</code> properties to set the Account and Payment validation URLs respectively.</p> <pre><code>```\n&lt;BIServer&gt;\n    &lt;!-- Include all configurations related to OBBI component --&gt;\n    &lt;TRA&gt;\n        &lt;!-- Include all configurations related to Transaction Risk Analysis --&gt;\n\n        &lt;!-- Enable TRA in WSO2 Open Banking--&gt;\n        &lt;IsEnabled&gt;true&lt;/IsEnabled&gt;\n        &lt;!-- following configurations are used to enable TRA for specific flows only--&gt;\n        &lt;!-- Enable TRA for Payments--&gt;\n        &lt;PaymentValidationEnabled&gt;true&lt;/PaymentValidationEnabled&gt;\n        &lt;!-- Enable TRA for Accounts--&gt;\n        &lt;AccountValidationEnabled&gt;true&lt;/AccountValidationEnabled&gt;\n        &lt;!-- Configurations related to TRA Receivers--&gt;\n        &lt;Receivers&gt;\n            &lt;!-- Administrator username to login to the remote BI server. --&gt;\n            &lt;Username&gt;admin@wso2.com@carbon.super&lt;/Username&gt;\n            &lt;!-- Administrator password to login to the remote BI server. --&gt;\n            &lt;Password&gt;wso2123&lt;/Password&gt;\n            &lt;!-- Receiver URLs of the Siddhi Apps used to validate for TRA.--&gt;\n            &lt;TRAAccountValidationURL&gt;http://&lt;WSO2_OB_BI_HOST&gt;:8007/    TRAAccountValidationApp/TRAValidationStream&lt;/TRAAccountValidationURL&gt;\n            &lt;TRAPaymentValidationURL&gt;http://&lt;WSO2_OB_BI_HOST&gt;:8007/    TRAPaymentValidationApp/TRAValidationStream&lt;/TRAPaymentValidationURL&gt;\n        &lt;/Receivers&gt;\n        &lt;TimePeriodOfRecurringPayment&gt;90&lt;/TimePeriodOfRecurringPayment&gt;\n        &lt;MaxFrequencyOfTransactionsWithoutSCA&gt;5&lt;/MaxFrequencyOfTransactionsWithoutSCA&gt;\n        &lt;TotalAmountLimitOfTransactionsWithoutSCA&gt;100&lt;/    TotalAmountLimitOfTransactionsWithoutSCA&gt;\n        &lt;LastSCATimeLimit&gt;90&lt;/LastSCATimeLimit&gt;\n        &lt;TransactionAmountLimit&gt;30&lt;/TransactionAmountLimit&gt;\n    &lt;/TRA&gt;\n&lt;/BIServer&gt;\n```\n</code></pre> <ol> <li>Make the following changes to the files given below.</li> </ol> <p>a. Open the <code>&lt;WSO2_OB_BI_HOME&gt;/deployment/siddhi-files/TRAAccountValidationApp.siddhi</code> file.</p> <pre><code>- Update the `&lt;WSO2_OB_BI_HOST&gt;` placeholder in the receiver URL, with the hostname of your WSO2 OB BI server.\n\n    ```\n    receiver.url='http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAAccountValidationApp/TRAValidationStream'\n    ```\n</code></pre> <p>b. Open the <code>&lt;WSO2_OB_BI_HOME&gt;/deployment/siddhi-files/TRAPaymentValidationApp.siddhi</code> file.</p> <pre><code>- Update the `&lt;WSO2_OB_BI_HOSTNAME&gt;` placeholder in the receiver URL, with the hostname of your WSO2 OB BI server.\n\n    ```\n    receiver.url='http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAPaymentValidationApp/TRAValidationStream'\n    ```\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/upgrade-the-solution/","title":"Upgrade the solution","text":"<p>Follow the steps below to upgrade WSO2 Open Banking from 1.3.0 to 1.4.0.</p> <ul> <li>Databases and Synapse configurations</li> <li>Datasource changes</li> <li>Custom configurations</li> <li>Request Payload Validation</li> <li>Authentication Script</li> <li>Key Manager Extension</li> <li>Transaction Risk Analysis (TRA)</li> <li>Fraud Detection</li> <li>PSD2 Data Reporting</li> <li>UK (Upgrading from v3.1 to v3.1.1)</li> <li>Berlin (Upgrading from 1.1.0 to 1.3.0)</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/upgrading-wso2-ob-berlin/","title":"WSO2 Open Banking Berlin (Upgrading from 1.1.0 to 1.3.0)","text":""},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/upgrading-wso2-ob-berlin/#accounts-and-payments-tables","title":"Accounts and Payments tables","text":"<ul> <li>A new column named <code>API_VERSION</code> is added to the <code>BG_ACCOUNT_INITIALIZATION</code> and <code>BG_PAYMENT_CONSENT</code> tables. These are used in the accounts and payments flows respectively.</li> <li>Run the relevant SQL migration script in the <code>&lt;WSO2_OB_KM_HOME&gt;/dbscripts/finance/berlin-group.org/migration-1.3.0_to_1.4.0</code> directory, against the <code>openbank_openbankingdb</code> database.</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/upgrading-wso2-ob-berlin/#authorize-payment-cancellation","title":"Authorize payment cancellation","text":"<p>The AuthorizeCancellation property is introduced to configure whether PSU authorization is required for payment cancellation or not.</p> <ul> <li>Open the <code>&lt;WSO2_OB_KM_HOME&gt;/repository/conf/finance/open-banking.xml</code> file.</li> <li>Update the <code>&lt;AuthorizeCancellation&gt;</code> property, under <code>&lt;Berlin&gt;</code>.</li> <li> <p>The possible values are:</p> <ul> <li><code>true</code>: Required to authorize the cancellation by completing authorization flow.</li> <li><code>false</code>: Authorization is not required.</li> </ul> <pre><code>&lt;Berlin&gt;\n    &lt;AuthorizeCancellation&gt;false&lt;/AuthorizeCancellation&gt;\n&lt;/Berlin&gt;\n</code></pre> </li> </ul>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/upgrading-wso2-ob-berlin/#configure-sca-methods","title":"Configure SCA methods","text":"<p>The <code>AuthenticationObject</code> property is introduced to configure the SCA methods for API responses.</p> <ul> <li>Open the <code>&lt;WSO2_OB_KM_HOME&gt;/repository/conf/finance/open-banking.xml</code> file and add the <code>AuthenticationObject</code> configurations.</li> <li>Depending on the risk management of the ASPSP this choice might be offered before or after the PSU has been identified with the first relevant factor, or if an access token is transported.</li> </ul> <p>Following are the possible SCA Authentication types:</p> SMS_OTP An SCA method, where an OTP linked to the transaction to be authorised is sent to the PSU through an SMS channel. CHIP_OTP An SCA method, where an OTP is generated by a chip card. PHOTO_OTP An SCA method, where the challenge is a QR code or similar encoded visual data which can be read in by a consumer device or specific mobile app. PUSH_OTP An OTP is pushed to a dedicated authentication APP and displayed to the PSU. <p>Given below is a sample configuration for a <code>SMS_OTP</code> authentication.</p> <pre><code>&lt;Berlin&gt;\n    &lt;SCA&gt;\n        &lt;SCAMethods&gt;\n            &lt;AuthenticationObject&gt;\n                &lt;AuthenticationType&gt;SMS_OTP&lt;/AuthenticationType&gt;\n                &lt;AuthenticationVersion&gt;1.0&lt;/AuthenticationVersion&gt;\n                &lt;AuthenticationMethodId&gt;sms-otp&lt;/AuthenticationMethodId&gt;\n                &lt;Name&gt;SMS OTP on Mobile&lt;/Name&gt;\n                &lt;Explanation&gt;SMS based one time password&lt;/Explanation&gt;\n                &lt;Default&gt;true&lt;/Default&gt;\n            &lt;/AuthenticationObject&gt;\n        &lt;/SCAMethods&gt;\n    &lt;/SCA&gt;\n&lt;/Berlin&gt;\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/upgrading-wso2-ob-uk/","title":"WSO2 Open Banking UK (Upgrading from v3.1 to v3.1.1)","text":""},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/upgrading-wso2-ob-uk/#uk_consent_rev-table","title":"<code>UK_CONSENT_REV</code> table","text":"<ul> <li>The <code>UK_CONSENT_REV</code> table is altered to have an auto increment field as the new primary key instead of the complex primary key used in v1.3.0.</li> <li>Run the relevant database script in the <code>&lt;WSO2_OB_KM_HOME&gt;/dbscripts/finance/openbanking.org.uk/migration-from-1.3.0</code> directory against the <code>openbank_openbankingdb</code> database.</li> </ul> <p>For Oracle database:</p> <p>When dropping the constraints, if there is more than one <code>UK_CONSENT_REV</code> table, change the SQL query as below and execute. Update the <code>&lt;ORACLE_USER&gt;</code> placeholder with the current database user.</p> <pre><code>SELECT * FROM all_constraints WHERE table_name = 'UK_CONSENT_REV' AND index_owner= '&lt;ORACLE_USER&gt;';\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.3.0-to-1.4.0/upgrading-wso2-ob-uk/#ob_dcr_details-table","title":"<code>OB_DCR_DETAILS</code> table","text":"<p>The following changes are done to support Dynamic Client Registration v3.2.</p> <ul> <li>Run the relevant SQL migration script in the <code>&lt;WSO2_OB_APIM_HOME&gt;/dbscripts/finance/dynamic-client-registration/migration-3.1_to_3.2</code> directory, against the <code>openbank_openbankingdb</code> database. The SQL script modifies the <code>OB_DCR_DETAILS</code> table by adding the following columns:<ul> <li><code>APPLICATION_ID</code></li> <li><code>SOFTWARE_ID</code></li> <li><code>CLID_ISSUED_AT</code></li> </ul> </li> </ul>"},{"location":"open-banking/migration-docs/ob-1.4.0-to-1.5.0/","title":"Upgrade the solution","text":"<p>Follow the steps below to upgrade WSO2 Open Banking from 1.4.0 to 1.5.0.</p> <ul> <li>Databases and Synapse configurations</li> <li>Custom configurations</li> <li>Application attribute changes</li> <li>PSD2 Data Reporting</li> <li>WSO2 Open Banking UK</li> <li>WSO2 Open Banking Berlin (Upgrading from 1.3.0 to 1.3.3)</li> <li>WSO2 Open Banking AU (Upgrading from v1.0.0 to v1.2.0)</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.4.0-to-1.5.0/application-attribution-changes/","title":"Application attribute changes","text":"<p>WSO2 Open Banking 1.5.0 supports both regulatory and non-regulatory APIs. To use this feature, you need to update the application attributes. Run the relevant migration script in the given locations against the <code>openbank_apimgtdb</code> database.</p> Database Script location <code>openbank_apimgtdb</code> <code>&lt;WSO2_OB_KM_HOME&gt;/dbscripts/finance/apimgt/migration-1.4.0_to_1.5.0</code>"},{"location":"open-banking/migration-docs/ob-1.4.0-to-1.5.0/custom-configurations/","title":"Custom configurations","text":"<p>Copy the following content from WSO2 Open Banking 1.4.0 to WSO2 Open Banking 1.5.0:</p> Content Copy from Copy to Synapse configurations <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/deployment/server/synapse-configs</code> <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/deployment/server/synapse-configs</code> Custom configurations <code>&lt;WSO2_OB_KM_140_HOME&gt;/repository/conf</code> <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/conf</code> Custom configurations <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/conf</code> <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/conf</code> Custom OSGI bundles (manually added files) <code>&lt;WSO2_OB_KM_140_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/components/dropins</code> Custom OSGI bundles (manually added files) <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/components/dropins</code> Custom JAR files (manually added files) <code>&lt;WSO2_OB_KM_140_HOME&gt;/repository/components/lib</code> <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/components/lib</code> Custom JAR files (manually added files) <code>&lt;WSO2_OB_APIM_140_HOME&gt;/repository/components/lib</code> <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/components/lib</code>"},{"location":"open-banking/migration-docs/ob-1.4.0-to-1.5.0/db-and-synapse-configurations/","title":"Databases and Synapse configurations","text":"<ul> <li>Take a backup of the existing database used by WSO2 Open Banking 1.4.0. This backup is necessary in case the migration causes issues in the existing database.</li> <li>Take a backup of the existing synapse configurations in WSO2 Open Banking 1.4.0. The synapse configuration is available in the <code>&lt;WSO2_OB_APIM_HOME&gt;/repository/deployment/server/synapse-configs</code> directory.</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.4.0-to-1.5.0/psd2-data-reporting/","title":"PSD2 Data Reporting","text":"<p>If you are using WSO2 Open Banking Business Intelligence (WSO2 OB BI) for PSD2 Data Reporting, execute the relevant database script against the mentioned databases:</p> Database Script location <code>openbank_ob_reporting_statsdb</code> <code>&lt;WSO2_OB_BI_150_HOME&gt;/resources/finance/dbscripts/migration-to-1.5.0/ob_stats_db</code> <code>openbank_ob_reporting_summarizeddb</code> <code>&lt;WSO2_OB_BI_150_HOME&gt;/resources/finance/dbscripts/migration-to-1.5.0/</code>ob_summarize_db`"},{"location":"open-banking/migration-docs/ob-1.4.0-to-1.5.0/upgrading-wso2-ob-au/","title":"WSO2 Open Banking AU (Upgrading from v1.0.0 to v1.2.0)","text":"<ol> <li> <p>Run the relevant database script in the <code>&lt;WSO2_OB_KM_HOME&gt;/dbscripts/finance/openbanking.org.uk/migration-1.4.0_to_1.5.0</code> directory against the <code>openbank_openbankingdb</code> database.</p> </li> <li> <p>Add the following configurations to the open-banking.xml files, under the <code>&lt;Server&gt;</code> tag. The <code>open-banking.xml</code> files are in the below locations:</p> </li> <li> <p><code>&lt;WSO2_OB_KM_HOME&gt;/repository/conf/finance/open-banking.xml</code></p> </li> <li><code>&lt;WSO2_OB_APIM_HOME&gt;/repository/conf/finance/open-banking.xml</code></li> </ol> <p>These configurations are for:</p> <ul> <li>Metadata Cache Management</li> <li>Enable extended endpoints and holder specific versioning</li> <li>Cache the responses received for the Consumer Data Standards API requests</li> </ul> <pre><code>&lt;AU&gt;\n    &lt;MetaDataCache&gt;\n        &lt;EnableMetaDataCache&gt;true&lt;/EnableMetaDataCache&gt;\n        &lt;MetaDataCacheUpdatePeriod&gt;5&lt;/MetaDataCacheUpdatePeriod&gt;\n        &lt;DefaultCacheTimeout&gt;1&lt;/DefaultCacheTimeout&gt;\n        &lt;DataRecipientsDiscoveryURL&gt;DR_DISCOVERY_MOCK_URL&lt;/DataRecipientsDiscoveryURL&gt;\n        &lt;SoftwareProductsDiscoveryURL&gt;SP_DISCOVERY_MOCK_URL&lt;/SoftwareProductsDiscoveryURL&gt;\n        &lt;DCRInternalURL&gt;https://\n            &lt;WSO2_OB_APIM_HOST&gt;:9443/dynamic-client-registration/common/register/\n            &lt;/DCRInternalURL&gt;\n        &lt;/MetaDataCache&gt;\n        &lt;ResourcePaths&gt;\n            /banking/accounts,\n            /banking/accounts/balances,\n            /banking/accounts/direct-debits,\n            /banking/accounts/{AccountId}/balance,\n            /banking/accounts/{AccountId},\n            /banking/accounts/{AccountId}/transactions,\n            /banking/accounts/{AccountId}/transactions/{transactionId},\n            /banking/accounts/{AccountId}/direct-debits,\n            /banking/accounts/{AccountId}/payments/scheduled,\n            /banking/payments/scheduled,\n            /banking/payees,\n            /banking/payees/{payeeId},\n            /banking/products,\n            /banking/products/{productId},\n            /common/customer,\n            /common/customer/detail,\n            /discovery/status,\n            /discovery/outages\n        &lt;/ResourcePaths&gt;\n        &lt;HolderIdentifier&gt;\n            &lt;!--configure bank specific identifier--&gt;\n        &lt;/HolderIdentifier&gt;\n        &lt;Enforcement&gt;\n            &lt;Cache&gt;\n                &lt;CacheEnabled&gt;true&lt;/CacheEnabled&gt;\n                &lt;ModifiedExpiryMinutes&gt;15&lt;/ModifiedExpiryMinutes&gt;\n                &lt;AccessedExpiryMinutes&gt;15&lt;/AccessedExpiryMinutes&gt;\n            &lt;/Cache&gt;\n        &lt;/Enforcement&gt;\n&lt;/AU&gt;\n</code></pre> <ol> <li>Add the following configurations for Dynamic Client Registration under <code>&lt;Server&gt;</code> tag and update them accordingly. Remove any DCR configurations within the <code>&lt;UK&gt;</code> tags.</li> </ol> <pre><code>&lt;DCR&gt;\n    &lt;TokenAuthentication&gt;\n        &lt;Method&gt;private_key_jwt&lt;/Method&gt;\n        &lt;Method&gt;tls_client_auth&lt;/Method&gt;\n    &lt;/TokenAuthentication&gt;\n    &lt;ConnectionTimeout&gt;0&lt;/ConnectionTimeout&gt;\n    &lt;ReadTimeout&gt;0&lt;/ReadTimeout&gt;\n    &lt;!--The endpoint urls are to access the rest APIs of API manager in order to\n        create the application, service provider and generate keys for the application.\n         --&gt;\n    &lt;EndPointURL&gt;\n        &lt;ServiceProviderCreation&gt;/client-registration/v0.14/register&lt;/ServiceProviderCreation&gt;\n        &lt;Application&gt;/api/am/store/v0.14/applications&lt;/Application&gt;\n        &lt;Token&gt;/token&lt;/Token&gt;\n        &lt;KeyGeneration&gt;/api/am/store/v0.14/applications/generate-keys&lt;/KeyGeneration&gt;\n        &lt;ApiSearch&gt;/api/am/store/v0.14/apis&lt;/ApiSearch&gt;\n        &lt;ApiSubscribe&gt;/api/am/store/v0.14/subscriptions/multiple&lt;/ApiSubscribe&gt;\n    &lt;/EndPointURL&gt;\n    &lt;EnableURIValidation&gt;false&lt;/EnableURIValidation&gt;\n    &lt;EnableHostNameValidation&gt;false&lt;/EnableHostNameValidation&gt;\n    &lt;!-- Use SoftwareID in SSA as Application Name--&gt;\n    &lt;UseSoftwareIdAsApplicationName&gt;false&lt;/UseSoftwareIdAsApplicationName&gt;\n&lt;/DCR&gt;\n</code></pre> <ol> <li>Go to the API Publisher (<code>https://&lt;WSO2_OB_APIM_HOST&gt;:9443/publisher</code>), add the following API properties to the already deployed APIs and republish them. For more information, see Deploying APIs for AU.</li> </ol> API Property Name Property Value Consumer Data Standards API v1.2.0 <code>ob-spec</code> <code>au</code> Consumer Data Standards API v1.2.0 <code>ob-api-type</code> <code>account</code> Consumer Data Standards Administration API v1.2.0 N/A N/A Dynamic Client Registration API v0.1 <code>ob-spec</code> <code>au</code> Dynamic Client Registration API v0.1 <code>ob-api-type</code> <code>dcr</code>"},{"location":"open-banking/migration-docs/ob-1.4.0-to-1.5.0/upgrading-wso2-ob-berlin/","title":"WSO2 Open Banking Berlin (Upgrading from 1.3.0 to 1.3.3)","text":"<ul> <li>Go to the API Publisher (<code>https://&lt;WSO2_OB_APIM_HOST&gt;:9443/publisher</code>), add the following API properties to the already deployed APIs and republish them. For more information, see Deploying APIs for Berlin.</li> </ul> Property Name Property Value ob-spec berlin ob-api-type psd2"},{"location":"open-banking/migration-docs/ob-1.4.0-to-1.5.0/upgrading-wso2-ob-uk/","title":"WSO2 Open Banking UK","text":"<ol> <li>Run the relevant database script in the given locations against the <code>openbank_openbankingdb</code> database.</li> </ol> Database Script location <code>openbank_openbankingdb</code> <code>&lt;WSO2_OB_KM_HOME&gt;/dbscripts/finance/openbanking.org.uk/migration-1.4.0_to_1.5.0/</code> <code>openbank_openbankingdb</code> <code>&lt;WSO2_OB_KM_HOME&gt;/dbscripts/finance/event-notification/migration-1.4.0_to_1.5.0/</code> <ol> <li> <p>To disable validating and signing payload for x-jws-signature header, set the following configuration to <code>false</code> in the <code>open-banking.xml</code> files.</p> </li> <li> <p><code>&lt;WSO2_OB_KM_HOME&gt;/repository/conf/finance/open-banking.xml</code></p> </li> <li> <p><code>&lt;WSO2_OB_APIM_HOME&gt;/repository/conf/finance/open-banking.xml</code></p> <pre><code>&lt;SigningConfiguration&gt;\n&lt;Enable&gt;false&lt;/Enable&gt;\n</code></pre> </li> <li> <p>Changes for Dynamic Client Registration:</p> <ol> <li> <p>Add the following configurations for Dynamic Client Registration under <code>&lt;Server&gt;</code> tag and update them accordingly. Remove any DCR configurations within the <code>&lt;UK&gt;</code> tags. </p> <p>DCR v1.0.0</p> <p><pre><code>   &lt;DCR&gt;\n    &lt;TokenAuthentication&gt;\n        &lt;Method&gt;private_key_jwt&lt;/Method&gt;\n        &lt;Method&gt;tls_client_auth&lt;/Method&gt;\n    &lt;/TokenAuthentication&gt;\n    &lt;ConnectionTimeout&gt;0&lt;/ConnectionTimeout&gt;\n    &lt;ReadTimeout&gt;0&lt;/ReadTimeout&gt;\n    &lt;EndPointURL&gt;\n        &lt;ServiceProviderCreation&gt;/client-registration/v0.14/register&lt;/ServiceProviderCreation&gt;\n        &lt;Application&gt;/api/am/store/v0.14/applications&lt;/Application&gt;\n        &lt;Token&gt;/token&lt;/Token&gt;\n        &lt;KeyGeneration&gt;/api/am/store/v0.14/applications/generate-keys&lt;/KeyGeneration&gt;\n        &lt;ApiSearch&gt;/api/am/store/v0.14/apis&lt;/ApiSearch&gt;\n        &lt;ApiSubscribe&gt;/api/am/store/v0.14/subscriptions/multiple&lt;/ApiSubscribe&gt;\n    &lt;/EndPointURL&gt;\n    &lt;EnableURIValidation&gt;false&lt;/EnableURIValidation&gt;\n    &lt;EnableHostNameValidation&gt;false&lt;/EnableHostNameValidation&gt;\n    &lt;APISubscriptions&gt;\n        &lt;PISP&gt;\n            &lt;APIContext&gt;/open-banking/v3.1/pisp&lt;/APIContext&gt;\n            &lt;APIContext&gt;/open-banking/v3.0/pisp&lt;/APIContext&gt;\n            &lt;APIContext&gt;/open-banking/v2.0/pisp&lt;/APIContext&gt;\n        &lt;/PISP&gt;\n        &lt;AISP&gt;\n            &lt;APIContext&gt;/open-banking/v3.1/aisp&lt;/APIContext&gt;\n            &lt;APIContext&gt;/open-banking/v3.0/aisp&lt;/APIContext&gt;\n            &lt;APIContext&gt;/open-banking/v2.0/aisp&lt;/APIContext&gt;\n        &lt;/AISP&gt;\n    &lt;/APISubscriptions&gt;\n    &lt;UseSoftwareIdAsApplicationName&gt;true&lt;/UseSoftwareIdAsApplicationName&gt;\n    &lt;JwksUrlSandbox&gt;https://keystore.openbankingtest.org.uk/keystore/openbanking.jwks&lt;/JwksUrlSandbox&gt;\n    &lt;JwksUrlProduction&gt;https://keystore.openbanking.org.uk/keystore/openbanking.jwks&lt;/JwksUrlProduction&gt;\n   &lt;/DCR&gt;\n</code></pre> DCR v3.2</p> <pre><code>&lt;DCR&gt;\n    &lt;TokenAuthentication&gt;\n        &lt;Method&gt;private_key_jwt&lt;/Method&gt;\n        &lt;Method&gt;tls_client_auth&lt;/Method&gt;\n    &lt;/TokenAuthentication&gt;\n    &lt;ConnectionTimeout&gt;0&lt;/ConnectionTimeout&gt;\n    &lt;ReadTimeout&gt;0&lt;/ReadTimeout&gt;\n    &lt;EnableURIValidation&gt;false&lt;/EnableURIValidation&gt;\n    &lt;EnableHostNameValidation&gt;false&lt;/EnableHostNameValidation&gt;\n    &lt;UseSoftwareIdAsApplicationName&gt;true&lt;/UseSoftwareIdAsApplicationName&gt;\n    &lt;JwksUrlSandbox&gt;https://keystore.openbankingtest.org.uk/keystore/openbanking.jwks&lt;/JwksUrlSandbox&gt;\n    &lt;JwksUrlProduction&gt;https://keystore.openbanking.org.uk/keystore/openbanking.jwks&lt;/JwksUrlProduction&gt;\n&lt;/DCR&gt;\n</code></pre> </li> <li> <p>Update the <code>&lt;WSO2_OB_APIM_HOME&gt;/repository/deployment/server/synapse-configs/default/sequences/&lt;USERNAME&gt;--DynamicClientRegistrationAPI_vv3.2--In.xml</code> file as follows: </p> </li> <li> <p>Replace <code>&lt;header name=\"To\" value=\"https://&lt;WSO2_OB_APIM_HOST&gt;:9443/ob-dynamic-client-registration\"/&gt;</code> property with the new <code>/dynamic-client-registration/common</code> endpoint.</p> </li> </ol> <pre><code>&lt;header name=\"To\" value=\"https://&lt;WSO2_OB_APIM_HOST&gt;:9443/dynamic-client-registration/common\"/&gt;\n</code></pre> </li> <li> <p>Update the <code>ApplicationDeletion</code> executor value as follows. See Dynamic Client Registration v3.2 - Configuring application deletion workflow, for more information.</p> <pre><code>&lt;ApplicationDeletion executor=\"com.wso2.finance.open.banking.application.deletion.workflow.impl.ApplicationDeletionWorkflow\"/&gt;\n</code></pre> </li> <li> <p>Go to the API Publisher (<code>https://&lt;WSO2_OB_APIM_HOST&gt;:9443/publisher</code>), add the following API properties to the already deployed APIs and republish them. For more information, see Deploying APIsfor UK.</p> </li> </ol> API Property Name Property Value AccountInfo API v3.1.1 <code>ob-spec</code> <code>uk</code> AccountInfo API v3.1.1 <code>ob-api-type</code> <code>account</code> AccountInfo API v3.1.1 <code>ob-api-version</code> <code>3.1.1</code> Payments API v3.1.1 <code>ob-spec</code> <code>uk</code> Payments API v3.1.1 <code>ob-api-type</code> <code>payment</code> Payments API v3.1.1 <code>ob-api-version</code> <code>3.1.1</code> Funds Confirmation API v3.1.1 <code>ob-spec</code> <code>uk</code> Funds Confirmation API v3.1.1 <code>ob-api-type</code> <code>cof</code> Funds Confirmation API v3.1.1 <code>ob-api-version</code> <code>3.1.1</code> Event Notifications API v3.1.0 <code>ob-spec</code> <code>uk</code> Event Notifications API v3.1.0 <code>ob-api-type</code> <code>event</code> Event Notifications API v3.1.0 <code>ob-api-version</code> <code>3.1.0</code> Dynamic Client Registration API v3.2 <code>ob-spec</code> <code>uk</code> Dynamic Client Registration API v3.2 <code>ob-api-type</code> <code>dcr</code> Dynamic Client Registration API v3.2 <code>ob-api-version</code> <code>3.2</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/","title":"Upgrading WSO2 Open Banking from 1.5.0 to 2.0.0 - Introduction","text":"<p>This section contains the complete upgrading process from WSO2 Open Banking solution 1.5.0 to WSO2 Open Banking 2.0.0.</p> <p>Note</p> <p>WSO2 Open Banking 2.0.0 introduces a new configuration model. This allows configuring WSO2 Open Banking with a simplified, centralized configuration model (toml-based configuration). For information on how to map the xml configurations in your 1.5.0 setup to the toml configurations in 2.0.0, refer to the Mapping XML Configurations to TOML Configurations (<code>map-xml-to-toml.md</code>) documentation.</p> <p>Go through the guidelines given below before attempting to upgrade the production environment. The base products for the WSO2 Open Banking 2.0.0 have changed to WSO2 API Manager 3.1.0 and WSO2 Identity Server 5.10.0 products. Follow the relevant documentation based on your specification and upgrade your setup to the latest version.</p> <ul> <li>Map XML Configurations to TOML Configurations</li> <li>Upgrade the solution for UK</li> <li>Upgrade the solution for Berlin</li> <li>Upgrade the solution for Australia</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/","title":"Map XML Configurations to TOML Configurations","text":"<p>WSO2 Open Banking 2.0.0 introduces a new simplified and centralized TOML-based configuration model instead of the several XML file module used in previous versions. This document explains how to map your XML configurations in Open Banking 1.5.0 to the latest TOML configurations.</p> <p>The following components/modules now contain a <code>deployment.toml</code> in each. Unlike the previous versions, now we have to configure that single toml file to configure each component. Given below are the most common XML configurations in each component and the corresponding TOML configurations.</p> <ul> <li>Key Manager</li> <li>API Manager</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#key-manager","title":"Key Manager","text":"<p>WSO2 Open Banking 2.0.0 refers to the Key Manager as the Identity and Access Management module. From this point onwards, let's refer to this root directory of this module as <code>WSO2_OB_IAM_HOME</code>.</p> <p>This section explains the corresponding TOML configurations in the following files:</p> <ul> <li><code>master-datasources.xml</code></li> <li><code>open-banking-datasources.xml</code></li> <li><code>carbon.xml</code></li> <li><code>application-authentication.xml</code></li> <li><code>identity.xml</code></li> <li><code>open-banking.xml</code></li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#master-datasourcesxml","title":"master-datasources.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/datasources/master-datasources.xml          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration          Given below is a sample configuration for a datasource, refer to the XML/TOML files to see how to configure all the relevant datasources.     <pre><code>&lt;datasource&gt;\n    &lt;name&gt;WSO2_SHARED_DB&lt;/name&gt;\n    &lt;description&gt;Shared Database for user and registry data&lt;/description&gt;\n    &lt;jndiConfig&gt;\n        &lt;name&gt;jdbc/SHARED_DB&lt;/name&gt;\n    &lt;/jndiConfig&gt;\n    &lt;definition type=\"RDBMS\"&gt;\n        &lt;configuration&gt;\n            &lt;url&gt;jdbc:mysql://&lt;DATABASE_HOST&gt;:3306/openbank_govdb?autoReconnect=true&amp;useSSL=false&lt;/url&gt;\n            &lt;username&gt;root&lt;/username&gt;\n            &lt;password&gt;root&lt;/password&gt;\n            &lt;driverClassName&gt;com.mysql.jdbc.Driver&lt;/driverClassName&gt;\n            &lt;validationQuery&gt;&lt;/validationQuery&gt;\n            &lt;testOnBorrow&gt;true&lt;/testOnBorrow&gt;\n            &lt;minIdle&gt;5&lt;/minIdle&gt;\n            &lt;maxWait&gt;60000&lt;/maxWait&gt;\n            &lt;defaultAutoCommit&gt;false&lt;/defaultAutoCommit&gt;\n            &lt;validationQuery&gt;SELECT 1&lt;/validationQuery&gt;\n            &lt;validationInterval&gt;30000&lt;/validationInterval&gt;\n            &lt;maxActive&gt;150&lt;/maxActive&gt;\n        &lt;/configuration&gt;\n    &lt;/definition&gt;\n&lt;/datasource&gt;\n</code></pre> <pre><code># for registry data\n[database.shared_db]\nurl = \"jdbc:mysql://&lt;DATABASE_HOST&gt;:3306/openbank_govdbautoReconnect=true&amp;useSSL=false\"\nusername = \"root\"\npassword = \"root\"\ndriver = \"com.mysql.jdbc.Driver\"\n\n[database.shared_db.pool_options]\nmaxActive = \"150\"\nmaxWait = \"60000\"\nminIdle =\"5\"\ntestOnBorrow = true\nvalidationQuery=\"SELECT 1\"\n#Use below for oracle\n#validationQuery=\"SELECT 1 FROM DUAL\"\nvalidationInterval=\"30000\"\ndefaultAutoCommit=false\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#open-banking-datasourcesxml","title":"open-banking-datasources.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/datasources/open-banking-datasources.xml          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration     <pre><code>&lt;datasources&gt;\n    &lt;datasource&gt;\n        &lt;name&gt;WSO2_OPEN_BANKING_DB&lt;/name&gt;\n        &lt;description&gt;The datasource used for open-banking data&lt;/description&gt;\n        &lt;jndiConfig&gt;\n            &lt;name&gt;jdbc/WSO2OpenBankingDB&lt;/name&gt;\n        &lt;/jndiConfig&gt;\n        &lt;definition type=\"RDBMS\"&gt;\n            &lt;configuration&gt;\n                &lt;url&gt;jdbc:mysql://&lt;DATABASE_HOST&gt;:3306/openbank_openbankingdb?autoReconnect=true&amp;useSSL=false&lt;/url&gt;\n                &lt;username&gt;root&lt;/username&gt;\n                &lt;password&gt;root&lt;/password&gt;\n                &lt;driverClassName&gt;com.mysql.jdbc.Driver&lt;/driverClassName&gt;\n                &lt;maxActive&gt;150&lt;/maxActive&gt;\n                &lt;testOnBorrow&gt;true&lt;/testOnBorrow&gt;\n                &lt;defaultAutoCommit&gt;false&lt;/defaultAutoCommit&gt;\n                &lt;validationQuery&gt;SELECT 1&lt;/validationQuery&gt;\n                &lt;maxWait&gt;60000&lt;/maxWait&gt;\n                &lt;validationInterval&gt;30000&lt;/validationInterval&gt;\n                &lt;minIdle&gt;5&lt;/minIdle&gt;\n            &lt;/configuration&gt;\n        &lt;/definition&gt;\n    &lt;/datasource&gt;\n&lt;/datasources&gt;undefined&lt;/datasources-configuration&gt;\n</code></pre> <pre><code>[open_banking_database]\nconfig.url = \"jdbc:mysql://&lt;DATABASE_HOST&gt;:3306/openbank_openbankingdb?autoReconnect=true&amp;useSSL=false\"\nconfig.username = \"root\"\nconfig.password = \"root\"\nconfig.driver = \"com.mysql.jdbc.Driver\"\n\n[open_banking_database.config.pool_options]\nmaxActive = \"150\"\nmaxWait = \"60000\"\nminIdle =\"5\"\ntestOnBorrow = true\nvalidationQuery=\"SELECT 1\"\n#Use below for oracle\n#validationQuery=\"SELECT 1 FROM DUAL\"\nvalidationInterval=\"30000\"\ndefaultAutoCommit=false\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#carbonxml","title":"carbon.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/carbon.xml          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration          Update the configurations with the hostname of your Open Banking Key Manager server/Identity and Access Management module.     <pre><code>&lt;HostName&gt;&lt;WSO2_OB_IAM_HOST&gt;&lt;/HostName&gt;\n&lt;MgtHostName&gt;&lt;WSO2_OB_IAM_HOST&gt;&lt;/MgtHostName&gt;\n</code></pre> <pre><code>[server]\nhostname = \"&lt;WSO2_OB_IAM_HOST&gt;\"\nnode_ip = \"127.0.0.1\"\nbase_path = \"https://$ref{server.hostname}:${carbon.management.port}\"\nserverDetails = \"WSO2 IS as KM 5.10.0\"\nmode = \"single\"\nuserAgent = \"WSO2 IS as KM 5.10.0\"\noffset = 3\n</code></pre>      Update the configurations according to your Keystore.     <pre><code>&lt;KeyStore&gt;\n    &lt;!-- Keystore file location--&gt;\n    &lt;Location&gt;\n${carbon.home}/repository/resources/security/wso2carbon.jks\n&lt;/Location&gt;\n    &lt;!-- Keystore type (JKS/PKCS12 etc.)--&gt;\n    &lt;Type&gt;JKS&lt;/Type&gt;\n    &lt;!-- Keystore password--&gt;\n    &lt;Password&gt;wso2carbon&lt;/Password&gt;\n    &lt;!-- Private Key alias--&gt;\n    &lt;KeyAlias&gt;wso2carbon&lt;/KeyAlias&gt;\n    &lt;!-- Private Key password--&gt;\n    &lt;KeyPassword&gt;wso2carbon&lt;/KeyPassword&gt;\n&lt;/KeyStore&gt;\n</code></pre> <pre><code>[keystore.primary]\nname = \"wso2carbon.jks\"\npassword = \"wso2carbon\"\ntype = \"JKS\"\nalias = \"wso2carbon\"\nkey_password = \"wso2carbon\"\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#application-authenticationxml","title":"application-authentication.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/datasources/open-banking-datasources.xml          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration          Update the following with the URLs of the authentication web application, as shown below:     <pre><code>&lt;AuthenticationEndpointURL&gt;\n    https://&lt;WSO2_OB_IAM_HOST&gt;:9446/authenticationendpoint/login.do\n&lt;/AuthenticationEndpointURL&gt;\n\n&lt;AuthenticationEndpointRetryURL&gt;\n    https://&lt;WSO2_OB_IAM_HOST&gt;:9446/authenticationendpoint/retry.do\n&lt;/AuthenticationEndpointRetryURL&gt;\n</code></pre> <pre><code>[authentication.endpoints]\nlogin_url = \"https://&lt;WSO2_OB_IAM_HOST&gt;:9446/authenticationendpoint/login.do\"\nretry_url = \"https://&lt;WSO2_OB_IAM_HOST&gt;:9446/authenticationendpoint/retry.do\"\n</code></pre>      In the authentication web application, when the action is set to include, the defined parameters will be sent to the  `AuthenticationEndpoint`  as query parameters.     **Note**     If you're using a customized authentication web app, you can access the hidden parameters using the  sessionDataKeyConsent  parameter. For more information, see  Authentication Data API.     <pre><code>&lt;AuthenticationEndpointRedirectParams action=\"include\" removeOnConsumeFromAPI=\"true\"&gt;\n        &lt;AuthenticationEndpointRedirectParam name=\"sessionDataKeyConsent\"/&gt;\n        &lt;AuthenticationEndpointRedirectParam name=\"relyingParty\"/&gt;\n        &lt;AuthenticationEndpointRedirectParam name=\"authenticators\"/&gt;\n        &lt;AuthenticationEndpointRedirectParam name=\"authFailureMsg\"/&gt;\n        &lt;AuthenticationEndpointRedirectParam name=\"authFailure\"/&gt;\n&lt;/AuthenticationEndpointRedirectParams&gt;\n</code></pre> <pre><code>[authentication.endpoint.redirect_params]\nfilter_policy = \"include\"\nremove_on_consume_from_api = \"true\"\nparameters = [\"sessionDataKeyConsent\",\"relyingParty\", \"authenticators\", \"authFailureMsg\", \"authFailure\"]\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#identityxml","title":"identity.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/identity/identity.xml          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration          Update the following configurations with the hostname of the Open Banking API Manager Gateway.     <pre><code>&lt;OAuth2AuthzEPUrl&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:8243/authorize\n&lt;/OAuth2AuthzEPUrl&gt;    \n&lt;OAuth2TokenEPUrl&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:8243/token\n&lt;/OAuth2TokenEPUrl&gt;\n&lt;OAuth2UserInfoEPUrl&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:8243/userinfo\n&lt;/OAuth2UserInfoEPUrl&gt;\n\n&lt;OAuth2DCREPUrl&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:8243/register\n&lt;/OAuth2DCREPUrl&gt;\n</code></pre> <pre><code>[oauth.endpoints]\noauth2_authz_url = \"${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:8243/authorize\"\noauth2_token_url = \"${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:8243/token\"\noauth2_user_info_url = \"${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:8243/userinfo\"\noauth2_consent_page = \"${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:${carbon.management.port}/ob/authenticationendpoint/oauth2_authz.do\"\noidc_consent_page = \"${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:${carbon.management.port}/ob/authenticationendpoint/oauth2_consent.do\"\noauth2_dcr_url = \"${carbon.protocol}://&lt;WSO2_OB_APIM_HOST&gt;:8243/register\"\n</code></pre> <pre><code>&lt;IDTokenIssuerID&gt;https://&lt;WSO2_OB_APIM_HOST&gt;:8243/token&lt;/IDTokenIssuerID&gt;\n</code></pre> <pre><code>[oauth.oidc]\nid_token.issuer = \"https://&lt;WSO2_OB_APIM_HOST&gt;:8243/token\"\n</code></pre>      Update the following configurations with the hostname of your Open Banking Key Manager server (referred as the Identity and Access Management module now).     <pre><code>&lt;OAuth2ConsentPage&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/ob/authenticationendpoint/oauth2_authz.do\n&lt;/OAuth2ConsentPage&gt;\n&lt;OAuth2ErrorPage&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/authenticationendpoint/oauth2_error.do\n&lt;/OAuth2ErrorPage&gt;\n&lt;OIDCConsentPage&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/ob/authenticationendpoint/oauth2_consent.do\n&lt;/OIDCConsentPage&gt;\n&lt;OIDCLogoutConsentPage&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/authenticationendpoint/oauth2_logout_consent.do\n&lt;/OIDCLogoutConsentPage&gt;\n&lt;OIDCLogoutPage&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/authenticationendpoint/oauth2_logout.do\n&lt;/OIDCLogoutPage&gt;\n&lt;OIDCWebFingerEPUrl&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/.well-known/webfinger\n&lt;/OIDCWebFingerEPUrl&gt;\n\n&lt;OIDCDiscoveryEPUrl&gt;\n    ${carbon.protocol}://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/oauth2/oidcdiscovery\n&lt;/OIDCDiscoveryEPUrl&gt;\n</code></pre> <pre><code>oauth2_consent_page = \"${carbon.protocol}://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/ob/authenticationendpoint/oauth2_authz.do\"\noauth2_error_page = \"https://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/authenticationendpoint/oauth2_error.do\"\noidc_consent_page = \"${carbon.protocol}://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/ob/authenticationendpoint/oauth2_consent.do\"\noauth.endpoints.oauth2_error_page = \"https://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/authenticationendpoint/oauth2_error.do\"\noidc_logout_consent_page = \"https://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/authenticationendpoint/oauth2_logout_consent.do\"\noidc_web_finger_url = \"https://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/.well-known/webfinger\"\noidc_discovery_url = \"https://&lt;WSO2_OB_IAM_HOST&gt;:${carbon.management.port}/oauth2/oidcdiscovery\"\n</code></pre>      Configure the ReceiverURL of the  &lt;EventPublisher&gt;  under  &lt;AdaptiveAuth&gt;  with the hostname of the Open Banking Business Intelligence Server. By default, the relevant Siddhi Apps are configured to listen to port 8006.     <pre><code>&lt;ReceiverURL&gt;http://&lt;WSO2_OB_BI_HOST&gt;:8006/&lt;/ReceiverURL&gt;\n</code></pre> <pre><code>[authentication.adaptive.event_publisher]\nurl = \"http://&lt;WSO2_OB_BI_HOST&gt;:8006/\"\n</code></pre>      The ID Token Builder and the algorithm that signs the ID Token Builder are configurable.     By default,  `` is set to  `com.wso2.finance.open.banking.idtoken.builder.OBIDTokenBuilder`. For example, to sign the `` with the `SHA256withRSA` algorithm the configurations are as follows:     <pre><code>&lt;IDTokenBuilder&gt;com.wso2.finance.open.banking.idtoken.builder.OBIDTokenBuilder&lt;/IDTokenBuilder&gt;\n&lt;SignatureAlgorithm&gt;SHA256withRSA&lt;/SignatureAlgorithm&gt;\n</code></pre> <pre><code>[oauth.oidc]\nextensions.id_token_builder = \"com.wso2.finance.open.banking.idtoken.builder.OBIDTokenBuilder\"\nid_token.signature_algorithm\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#open-bankingxml","title":"open-banking.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/finance/open-banking.xml          &lt;WSO2_OB_IAM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration          Define the specification that you plan to deploy.     Possible values: UK, BERLIN, AU     <pre><code>&lt;DeployedSpecification&gt;UK&lt;/DeployedSpecification&gt;\n</code></pre> <pre><code>[open_banking]\ndeployed_spec = \"UK\"\n</code></pre>      Configuring bank backend: <ul> <li>&lt;SharableAccountsRetrieveEndpoint&gt;: Configures the endpoint to retrieve sharable accounts that are listed on the consent page.  <li>&lt;PayableAccountsRetrieveEndpoint&gt;: Configures the endpoint to retrieve accounts that the user can make payments with, which are listed on the consent page.     <pre><code>&lt;PayableAccountsRetrieveEndpoint&gt;\n    http://localhost:9763/api/openbanking/backend-uk/services/bankaccounts/bankaccountservice/payable-accounts\n&lt;/PayableAccountsRetrieveEndpoint&gt;\n&lt;SharableAccountsRetrieveEndpoint&gt;\n    http://localhost:9763/api/openbanking/backend-uk/services/bankaccounts/bankaccountservice/sharable-accounts\n&lt;/SharableAccountsRetrieveEndpoint&gt;\n</code></pre> </li> <pre><code>[open_banking]\npayable_accounts_retrieve_endpoint = \"http://localhost:9763/api/openbanking/backend-uk/services/bankaccounts/bankaccountservice/payable-accounts\"\nsharable_accounts_retrieve_endpoint = \"http://localhost:9763/api/openbanking/backend-uk/services/bankaccounts/bankaccountservice/sharable-accounts\"\n</code></pre>      To enable the Event Notification feature (for Open Banking UK):     <pre><code>&lt;EventNotifications&gt;\n    &lt;IsEnabled&gt;true&lt;/IsEnabled&gt;\n    &lt;TokenIssuer&gt;www.openbank.com&lt;/TokenIssuer&gt;\n    &lt;NotificationAPIUrl&gt;\n        https://localhost:8243/open-banking/v3.1/event-notification\n    &lt;/NotificationAPIUrl&gt;\n&lt;/EventNotifications&gt;\n</code></pre> <pre><code>[open_banking.event_notifications]\nenable = true\ntoken_issuer = \"www.openbank.com\"\napi_url = \"https://localhost:8243/open-banking/v3.1/event-notification\"\n</code></pre>      To enable Request-URI validation during the account retrieval process; validate the account ID against the account ID in the consent (for Open Banking UK and Open Banking Australia)     <pre><code>&lt;ValidateAccountIdOnRetrieval&gt;true&lt;/ValidateAccountIdOnRetrieval&gt;\n</code></pre> <pre><code>[open_banking.account_id_validation_on_retrieval]\nenable = true\n</code></pre>      For Open Banking UK - The unique ID of the bank to which the request is issued. The unique ID is issued by OBIE and corresponds to the Organization ID of the ASPSP in the Open Banking Directory. If the value does not match the expected value (based on the Client ID or network certificate of the caller), the bank must reject the request with a 403 (Forbidden) status code.     <pre><code>&lt;XFAPIFinancialId&gt;open-bank&lt;/XFAPIFinancialId&gt;\n</code></pre> <pre><code>[open_banking.uk]\nx_fapi_financial_id = \"open-bank\"\n</code></pre>      For the Data Reporting feature, to enable data publishing set the  &lt;Enabled&gt;  property value to true. So, the WSO2 Open Banking Business Intelligence can capture and summarize data. Replace the  &lt;WSO2_OB_BI_HOSTNAME&gt;  placeholder with the hostname of Open Banking Business Intelligence server.     <pre><code>&lt;DataPublishing&gt;\n    &lt;Enabled&gt;true&lt;/Enabled&gt;\n    &lt;ServerURL&gt;{tcp://&lt;WSO2_OB_BI_HOST&gt;:7612}&lt;/ServerURL&gt;\n&lt;/DataPublishing&gt;\n</code></pre> <pre><code>[open_banking.bi_server.data_publishing]\nenable = true\nserver_url = \"{tcp://&lt;WSO2_OB_BI_HOST&gt;:7612}\"\n</code></pre>      To enable Transaction Risk Analysis: <ul> <li>Set the &lt;IsEnabled&gt; property under &lt;TRA&gt; to true.  <li>Replace the &lt;WSO2_OB_BI_HOST&gt; place holder with the hostname of Open Banking Business Intelligence server.  <li>Use the &lt;AccountValidationEnabled&gt; and &lt;PaymentValidationEnabled&gt; properties to enable TRA for Accounts and Payments respectively.     <pre><code>&lt;TRA&gt;\n    &lt;IsEnabled&gt;true&lt;/IsEnabled&gt;\n    &lt;PaymentValidationEnabled&gt;true&lt;/PaymentValidationEnabled&gt;\n    &lt;AccountValidationEnabled&gt;true&lt;/AccountValidationEnabled&gt;\n    &lt;Receivers&gt;\n        &lt;TRAAccountValidationURL&gt;http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAAccountValidationApp/TRAValidationStream&lt;/TRAAccountValidationURL&gt;\n        &lt;TRAPaymentValidationURL&gt;http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAPaymentValidationApp/TRAValidationStream&lt;/TRAPaymentValidationURL&gt;\n    &lt;/Receivers&gt;\n&lt;/TRA&gt;\n</code></pre> </li> <pre><code>[open_banking.bi_server.tra]\nenable = true\npayment_validation.enable = true\naccount_validation.enable = true\n\n[open_banking.bi_server.tra.receivers]\naccount_validation_url = \"http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAAccountValidationApp/TRAValidationStream\"\npayment_validation_url = \"http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAPaymentValidationApp/TRAValidationStream\"\n</code></pre>      You can enable the Fraud Detection feature by setting the &lt;IsEnabled&gt; value to true. Replace the &lt;WSO2_OB_BI_HOST&gt; placeholder with the hostname of WSO2 Open Banking Business Intelligence server.     <pre><code>&lt;FraudDetection&gt;\n    &lt;IsEnabled&gt;false&lt;/IsEnabled&gt;\n    &lt;Receivers&gt;\n        &lt;FraudDetectionURL&gt;\n            http://&lt;WSO2_OB_BI_HOST&gt;:8007/FraudDetectionApp/FraudDetectionStream\n        &lt;/FraudDetectionURL&gt;\n        &lt;InvalidSubmissionURL&gt;\n            http://&lt;WSO2_OB_BI_HOST&gt;:8006/InvalidSubmissionsApp/InvalidSubmissionsStream\n        &lt;/InvalidSubmissionURL&gt;\n    &lt;/Receivers&gt;\n&lt;/FraudDetection&gt;\n</code></pre> <pre><code>[open_banking.bi_server.fraud_detection]\nenable = false\n\n[open_banking.bi_server.fraud_detection.receivers]\nfraud_detection_url = \"http://localhost:8007/FraudDetectionApp/FraudDetectionStream\"\ninvalid_submission_url = \"http://localhost:8006/InvalidSubmissionsApp/InvalidSubmissionsStream\"\n</code></pre>      To enable MTLS token binding:     <pre><code>&lt;EnableMTLSTokenBinding&gt;true&lt;/EnableMTLSTokenBinding&gt;\n</code></pre>     Now configure the client certificate header as follows:      <pre><code>&lt;ClientAuthenticationHeader&gt;x-wso2-mutual-auth-cert&lt;/ClientAuthenticationHeader&gt;\n</code></pre> <pre><code>[open_banking.api_security]\nmtls_token_binding.enable = true\n</code></pre> <pre><code>[open_banking.cert_mgt]\nclient_auth_header = \"x-wso2-mutual-auth-cert\"\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#api-manager","title":"API Manager","text":"<p>From this point onwards, the root directory of the API Management module is known as <code>WSO2_OB_APIM_HOME</code>.</p> <p>This section explains the corresponding TOML configurations in the following files:</p> <ul> <li><code>master-datasources.xml</code></li> <li><code>open-banking-datasources.xml</code></li> <li><code>carbon.xml</code></li> <li><code>api-manager.xml</code></li> <li><code>synapse-handlers.xml</code></li> <li><code>open-banking.xml</code></li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#master-datasourcesxml_1","title":"master-datasources.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/datasources/master-datasources.xml          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration          Given below is a sample configuration for a datasource, refer to the XML/TOML files to see how to configure all the relevant datasources.     <pre><code>&lt;datasource&gt;\n    &lt;name&gt;WSO2_SHARED_DB&lt;/name&gt;\n    &lt;description&gt;Shared Database for user and registry data&lt;/description&gt;\n    &lt;jndiConfig&gt;\n        &lt;name&gt;jdbc/SHARED_DB&lt;/name&gt;\n    &lt;/jndiConfig&gt;\n    &lt;definition type=\"RDBMS\"&gt;\n        &lt;configuration&gt;\n            &lt;url&gt;\njdbc:mysql://&lt;DATABASE_HOST&gt;:3306/openbank_govdb?autoReconnect=true&amp;useSSL=false\n&lt;/url&gt;\n            &lt;username&gt;root&lt;/username&gt;\n            &lt;password&gt;root&lt;/password&gt;\n            &lt;driverClassName&gt;com.mysql.jdbc.Driver&lt;/driverClassName&gt;\n            &lt;validationQuery/&gt;\n            &lt;testOnBorrow&gt;true&lt;/testOnBorrow&gt;\n            &lt;minIdle&gt;5&lt;/minIdle&gt;\n            &lt;maxWait&gt;60000&lt;/maxWait&gt;\n            &lt;defaultAutoCommit&gt;false&lt;/defaultAutoCommit&gt;\n            &lt;validationQuery&gt;SELECT 1&lt;/validationQuery&gt;\n            &lt;validationInterval&gt;30000&lt;/validationInterval&gt;\n            &lt;maxActive&gt;150&lt;/maxActive&gt;\n        &lt;/configuration&gt;\n    &lt;/definition&gt;\n&lt;/datasource&gt;\n</code></pre> <pre><code># for registry data\n[database.shared_db]\nurl = \"jdbc:mysql://&lt;DATABASE_HOST&gt;:3306/openbank_govdb?autoReconnect=true&amp;useSSL=false\"\nusername = \"root\"\npassword = \"root\"\ndriver = \"com.mysql.jdbc.Driver\"\n\n[database.shared_db.pool_options]\nmaxActive = \"150\"\nmaxWait = \"60000\"\nminIdle =\"5\"\ntestOnBorrow = true\nvalidationQuery=\"SELECT 1\"\n#Use below for oracle\n#validationQuery=\"SELECT 1 FROM DUAL\"\nvalidationInterval=\"30000\"\ndefaultAutoCommit=false\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#open-banking-datasourcesxml_1","title":"open-banking-datasources.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/api-manager.xml          &lt;WSO2_OB_APM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration     <pre><code>&lt;datasources&gt;\n    &lt;datasource&gt;\n        &lt;name&gt;WSO2_OPEN_BANKING_DB&lt;/name&gt;\n        &lt;description&gt;The datasource used for open-banking data&lt;/description&gt;\n        &lt;jndiConfig&gt;\n            &lt;name&gt;jdbc/WSO2OpenBankingDB&lt;/name&gt;\n        &lt;/jndiConfig&gt;\n        &lt;definition type=\"RDBMS\"&gt;\n            &lt;configuration&gt;\n                &lt;url&gt;jdbc:mysql://&lt;DATABASE_HOST&gt;:3306/openbank_openbankingdb?autoReconnect=true&amp;useSSL=false&lt;/url&gt;\n                &lt;username&gt;root&lt;/username&gt;\n                &lt;password&gt;root&lt;/password&gt;\n                &lt;driverClassName&gt;com.mysql.jdbc.Driver&lt;/driverClassName&gt;\n                &lt;maxActive&gt;150&lt;/maxActive&gt;\n                &lt;testOnBorrow&gt;true&lt;/testOnBorrow&gt;\n                &lt;defaultAutoCommit&gt;false&lt;/defaultAutoCommit&gt;\n                &lt;validationQuery&gt;SELECT 1&lt;/validationQuery&gt;\n                &lt;maxWait&gt;60000&lt;/maxWait&gt;\n                &lt;validationInterval&gt;30000&lt;/validationInterval&gt;\n                &lt;minIdle&gt;5&lt;/minIdle&gt;\n            &lt;/configuration&gt;\n        &lt;/definition&gt;\n    &lt;/datasource&gt;\n&lt;/datasources&gt;undefined&lt;/datasources-configuration&gt;\n</code></pre> <pre><code>[open_banking_database]\nconfig.url = \"jdbc:mysql://&lt;DATABASE_HOST&gt;:3306/openbank_openbankingdb?autoReconnect=true&amp;useSSL=false\"\nconfig.username = \"root\"\nconfig.password = \"root\"\nconfig.driver = \"com.mysql.jdbc.Driver\"\n\n[open_banking_database.config.pool_options]\nmaxActive = \"150\"\nmaxWait = \"60000\"\nminIdle =\"5\"\ntestOnBorrow = true\nvalidationQuery=\"SELECT 1\"\n#Use below for oracle\n#validationQuery=\"SELECT 1 FROM DUAL\"\nvalidationInterval=\"30000\"\ndefaultAutoCommit=false\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#carbonxml_1","title":"carbon.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/carbon.xml          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration          Update the configurations with the hostname of your Open Banking Key Manager server/Identity and Access Management module.     <pre><code>&lt;HostName&gt;&lt;WSO2_OB_APIM_HOST&gt;&lt;/HostName&gt;\n&lt;MgtHostName&gt;&lt;WSO2_OB_APIM_HOST&gt;&lt;/MgtHostName&gt;\n</code></pre> <pre><code>[server]\nhostname = \"&lt;WSO2_OB_APIM_HOST&gt;\"\n</code></pre>      Update the configurations according to your Keystore.     <pre><code>&lt;KeyStore&gt;\n    &lt;!-- Keystore file location--&gt;\n    &lt;Location&gt;\n${carbon.home}/repository/resources/security/wso2carbon.jks\n&lt;/Location&gt;\n    &lt;!-- Keystore type (JKS/PKCS12 etc.)--&gt;\n    &lt;Type&gt;JKS&lt;/Type&gt;\n    &lt;!-- Keystore password--&gt;\n    &lt;Password&gt;wso2carbon&lt;/Password&gt;\n    &lt;!-- Private Key alias--&gt;\n    &lt;KeyAlias&gt;wso2carbon&lt;/KeyAlias&gt;\n    &lt;!-- Private Key password--&gt;\n    &lt;KeyPassword&gt;wso2carbon&lt;/KeyPassword&gt;\n&lt;/KeyStore&gt;\n</code></pre> <pre><code>[keystore.primary]\nname = \"wso2carbon.jks\"\npassword = \"wso2carbon\"\ntype = \"JKS\"\nalias = \"wso2carbon\"\nkey_password = \"wso2carbon\"\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#api-managerxml","title":"api-manager.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/api-manager.xml          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration          Update the following configurations according to the given placeholder.     <pre><code>&lt;AuthManager&gt;\n    &lt;!-- Server URL of the Authentication service --&gt;\n    &lt;ServerURL&gt;\n        https://&lt;WSO2_OB_IAM_HOST&gt;:${mgt.transport.https.port}${carbon.context}services/\n    &lt;/ServerURL&gt;\n</code></pre> <pre><code>[apim.key_manager]\nservice_url = \"https://&lt;WSO2_OB_IAM_HOST&gt;:9446${carbon.context}services/\"\n</code></pre> <pre><code>&lt;GatewayEndpoint&gt;\n    http://&lt;WSO2_OB_APIM_HOST&gt;:${http.nio.port},https://&lt;WSO2_OB_APIM_HOST&gt;:${https.nio.port}\n&lt;/GatewayEndpoint&gt;\n</code></pre> <pre><code>http_endpoint = \"http://&lt;WSO2_OB_APIM_HOST&gt;:${http.nio.port}\"\n</code></pre>      To configure Analytics for the API Management module:     <pre><code>&lt;Analytics&gt;\n    &lt;Enabled&gt;true&lt;/Enabled&gt;\n    &lt;StreamProcessorServerURL&gt;{tcp://localhost:7612}&lt;/StreamProcessorServerURL&gt;\n</code></pre> <pre><code>[apim.analytics]\nenable = true\nreceiver_urls = \"{tcp://&lt;WSO2_OB_BI_HOST&gt;:7612}\"\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#synapse-handlersxml","title":"synapse-handlers.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/synapse-handlers.xml          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration     <pre><code>&lt;handler name = \"UkJwsResponseSignatureHandler\" class=\"com.wso2.finance.open.banking.gateway.jws.UkJwsResponseSignatureHandler\"&gt;&lt;/handler&gt;\n</code></pre>      Following configuration must be added to the top of the &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/deployment.toml file:     <pre><code>enabled_global_handlers= [\"jws\", \"externalCallLogger\", \"open_tracing\"]\n[synapse_handlers.jws]\nname= \"jws\"\nclass= \"com.wso2.finance.open.banking.gateway.jws.UkJwsResponseSignatureHandler\"\n\n[synapse_handlers.externalCallLogger]\nname= \"externalCallLogger\"\nclass= \"org.wso2.carbon.apimgt.gateway.handlers.LogsHandler\"\n\n[synapse_handlers.open_tracing]\nname= \"open_tracing\"\nclass= \"org.wso2.carbon.apimgt.gateway.handlers.common.APIMgtLatencySynapseHandler\"\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/map-xml-to-toml/#open-bankingxml_1","title":"open-banking.xml","text":"Location of the XML file          Location of the TOML file          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/finance/open-banking.xml          &lt;WSO2_OB_APIM_HOME&gt;/repository/conf/deployment.toml          XML configuration          TOML configuration         Define the specification that you plan to deploy.     Possible values:   UK, BERLIN, AU     <pre><code>&lt;DeployedSpecification&gt;UK&lt;/DeployedSpecification&gt;\n</code></pre> <pre><code>[open_banking]\ndeployed_spec = \"UK\"\n</code></pre>      Configuring bank backend: <ul> <li>&lt;SharableAccountsRetrieveEndpoint&gt;: Configures the endpoint to retrieve sharable accounts that are listed on the consent page.  <li>&lt;PayableAccountsRetrieveEndpoint&gt;: Configures the endpoint to retrieve accounts that the user can make payments with, which are listed on the consent page.     <pre><code>&lt;PayableAccountsRetrieveEndpoint&gt;\n    http://localhost:9763/api/openbanking/backend-uk/services/bankaccounts/bankaccountservice/payable-accounts\n&lt;/PayableAccountsRetrieveEndpoint&gt;\n&lt;SharableAccountsRetrieveEndpoint&gt;\n    http://localhost:9763/api/openbanking/backend-uk/services/bankaccounts/bankaccountservice/sharable-accounts\n&lt;/SharableAccountsRetrieveEndpoint&gt;\n</code></pre> </li> <pre><code>[open_banking]\npayable_accounts_retrieve_endpoint = \"http://localhost:9763/api/openbanking/backend-uk/services/bankaccounts/bankaccountservice/payable-accounts\"\nsharable_accounts_retrieve_endpoint = \"http://localhost:9763/api/openbanking/backend-uk/services/bankaccounts/bankaccountservice/sharable-accounts\"\n</code></pre>      To enable the Event Notification feature (for Open Banking UK):     <pre><code>&lt;EventNotifications&gt;\n    &lt;IsEnabled&gt;true&lt;/IsEnabled&gt;\n    &lt;TokenIssuer&gt;www.openbank.com&lt;/TokenIssuer&gt;\n    &lt;NotificationAPIUrl&gt;\n        https://localhost:8243/open-banking/v3.1/event-notification\n    &lt;/NotificationAPIUrl&gt;\n&lt;/EventNotifications&gt;\n</code></pre> <pre><code>[open_banking.event_notifications]\nenable = true\ntoken_issuer = \"www.openbank.com\"\napi_url = \"https://localhost:8243/open-banking/v3.1/event-notification\"\n</code></pre>      To enable Request-URI validation during the account retrieval process; validate the account ID against the account ID in the consent (for Open Banking UK and Open Banking Australia)     <pre><code>&lt;ValidateAccountIdOnRetrieval&gt;true&lt;/ValidateAccountIdOnRetrieval&gt;\n</code></pre> <pre><code>[open_banking.account_id_validation_on_retrieval]\nenable = true\n</code></pre>      For Open Banking UK - The unique ID of the bank to which the request is issued. The unique ID is issued by OBIE and corresponds to the Organization ID of the ASPSP in the Open Banking Directory. If the value does not match the expected value (based on the Client ID or network certificate of the caller), the bank must reject the request with a 403 (Forbidden) status code.     <pre><code>&lt;XFAPIFinancialId&gt;open-bank&lt;/XFAPIFinancialId&gt;\n</code></pre> <pre><code>[open_banking.uk]\nx_fapi_financial_id = \"open-bank\"\n</code></pre>      For the Data Reporting feature, to enable data publishing set the  &lt;Enabled&gt;  property value to true. So, the WSO2 Open Banking Business Intelligence can capture and summarize data. Replace the  &lt;WSO2_OB_BI_HOSTNAME&gt;  placeholder with the hostname of Open Banking Business Intelligence server.     <pre><code>&lt;DataPublishing&gt;\n    &lt;Enabled&gt;true&lt;/Enabled&gt;\n    &lt;ServerURL&gt;{tcp://&lt;WSO2_OB_BI_HOST&gt;:7612}&lt;/ServerURL&gt;\n&lt;/DataPublishing&gt;\n</code></pre> <pre><code>[open_banking.bi_server.data_publishing]\nenable = true\nserver_url = \"{tcp://&lt;WSO2_OB_BI_HOST&gt;:7612}\"\n</code></pre>      To enable Transaction Risk Analysis:  <ul> <li>Set the &lt;IsEnabled&gt; property under &lt;TRA&gt; to true.  <li>Replace the &lt;WSO2_OB_BI_HOST&gt; place holder with the hostname of Open Banking Business Intelligence server.  <li>Use the &lt;AccountValidationEnabled&gt; and &lt;PaymentValidationEnabled&gt; properties to enable TRA for Accounts and Payments respectively.     <pre><code>&lt;TRA&gt;\n    &lt;IsEnabled&gt;true&lt;/IsEnabled&gt;\n    &lt;PaymentValidationEnabled&gt;true&lt;/PaymentValidationEnabled&gt;\n    &lt;AccountValidationEnabled&gt;true&lt;/AccountValidationEnabled&gt;\n    &lt;Receivers&gt;\n        &lt;TRAAccountValidationURL&gt;http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAAccountValidationApp/TRAValidationStream&lt;/TRAAccountValidationURL&gt;\n        &lt;TRAPaymentValidationURL&gt;http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAPaymentValidationApp/TRAValidationStream&lt;/TRAPaymentValidationURL&gt;\n    &lt;/Receivers&gt;\n&lt;/TRA&gt;\n</code></pre> </li> <pre><code>[open_banking.bi_server.tra]\nenable = true\npayment_validation.enable = true\naccount_validation.enable = true\n\n[open_banking.bi_server.tra.receivers]\naccount_validation_url = \"http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAAccountValidationApp/TRAValidationStream\"\npayment_validation_url = \"http://&lt;WSO2_OB_BI_HOST&gt;:8007/TRAPaymentValidationApp/TRAValidationStream\"\n</code></pre>      You can enable the Fraud Detection feature by setting the &lt;IsEnabled&gt; value to true. Replace the &lt;WSO2_OB_BI_HOST&gt; placeholder with the hostname of WSO2 Open Banking Business Intelligence server.     <pre><code>&lt;FraudDetection&gt;\n    &lt;IsEnabled&gt;false&lt;/IsEnabled&gt;\n    &lt;Receivers&gt;\n        &lt;FraudDetectionURL&gt;\n            http://&lt;WSO2_OB_BI_HOST&gt;:8007/FraudDetectionApp/FraudDetectionStream\n        &lt;/FraudDetectionURL&gt;\n        &lt;InvalidSubmissionURL&gt;\n            http://&lt;WSO2_OB_BI_HOST&gt;:8006/InvalidSubmissionsApp/InvalidSubmissionsStream\n        &lt;/InvalidSubmissionURL&gt;\n    &lt;/Receivers&gt;\n&lt;/FraudDetection&gt;\n</code></pre> <pre><code>[open_banking.bi_server.fraud_detection]\nenable = false\n\n[open_banking.bi_server.fraud_detection.receivers]\nfraud_detection_url = \"http://localhost:8007/FraudDetectionApp/FraudDetectionStream\"\ninvalid_submission_url = \"http://localhost:8006/InvalidSubmissionsApp/InvalidSubmissionsStream\"\n</code></pre>      To enable MTLS token binding:     <pre><code>&lt;EnableMTLSTokenBinding&gt;true&lt;/EnableMTLSTokenBinding&gt;\n</code></pre>  Now configure the client certificate header as follows:      <pre><code>&lt;ClientAuthenticationHeader&gt;x-wso2-mutual-auth-cert&lt;/ClientAuthenticationHeader&gt;\n</code></pre> <pre><code>[open_banking.api_security]\nmtls_token_binding.enable = true\n</code></pre> <pre><code>[open_banking.cert_mgt]\nclient_auth_header = \"x-wso2-mutual-auth-cert\"\n</code></pre>      By default, the signing configuration is set to false. In order to change the value, configure as follows:     <pre><code>&lt;SigningConfiguration&gt;\n           &lt;!-- Enable Response Signing --&gt;\n           &lt;Enable&gt;true&lt;/Enable&gt;\n           &lt;OBIE&gt;\n               &lt;!--\n                   Trusted Anchor Configuration\n               --&gt;\n               &lt;TrustedAnchors&gt;\n                   &lt;!-- Domain name that is registered to and identifies the Trust Anchor that hosts the public counter-part of the key used for signing the response. Included in the claim http://openbanking.org.uk/tan --&gt;\n                   &lt;Signing&gt;openbanking.org.uk&lt;/Signing&gt;\n                   &lt;!--\n                  Trusted domain names that are registered to and identifies the Trust Anchor that hosts the public counter-part of the key used for request signing by the TPP. The value included in the claim http://openbanking.org.uk/tan of the TPP's JOSE header will be validated against the following list of domain names.\n                       Multiple values supported with `|` delimiter\n                       IE - trustanchor.org|trustanchor.org.uk\n                   --&gt;\n                   &lt;Validation&gt;openbanking.org.uk&lt;/Validation&gt;\n               &lt;/TrustedAnchors&gt;\n               &lt;!-- Organization Id of the ASPSP. This value is used as the http://openbanking.org.uk/iss claim during response signing --&gt;\n               &lt;OrganizationId&gt;ABC1234&lt;/OrganizationId&gt;\n           &lt;/OBIE&gt;\n           &lt;!-- Default Singing Algorithm is PS256, to support others uncomment line below --&gt;\n           &lt;!--&lt;Algorithm&gt;RS256&lt;/Algorithm&gt;--&gt;\n\n           &lt;!-- By default the UK specification mandates the Payment and Even Notification APIs to have request/response message signing. Hence, the following specified APIs will be mandated for message signing. --&gt;\n           &lt;MandatedAPIs&gt;\n               &lt;APIContext&gt;/open-banking/v3.0/event-notification/&lt;/APIContext&gt;\n               &lt;APIContext&gt;/open-banking/v3.0/pisp/&lt;/APIContext&gt;\n               &lt;APIContext&gt;/open-banking/v3.1/event-notification/&lt;/APIContext&gt;\n               &lt;APIContext&gt;/open-banking/v3.1/pisp/&lt;/APIContext&gt;\n           &lt;/MandatedAPIs&gt;\n\n&lt;!-- The following specified APIs will be associated with response signing. --&gt;\n           &lt;ResponseSignatureRequiredAPIs&gt;\n               &lt;APIContext&gt;/open-banking/v3.0/pisp/&lt;/APIContext&gt;\n               &lt;APIContext&gt;/open-banking/v3.1/pisp/&lt;/APIContext&gt;\n           &lt;/ResponseSignatureRequiredAPIs&gt;\n       &lt;/SigningConfiguration&gt;\n</code></pre> <pre><code>[open_banking.uk.signing_config]\n#Enable Response Signing\nenable = true\n\n#Domain name that is registered to and identifies the Trust Anchor that hosts the public counter-part of the key used for signing the response.\n#Included in the claim http://openbanking.org.uk/tan\nobie.trusted_anchors.signing = \"openbanking.org.uk\"\n\n#Trusted domain names that are registered to and identifies the Trust Anchor that hosts the public counter-part of the key used for request signing by the TPP.\n#The value included in the claim http://openbanking.org.uk/tan of the TPP's JOSE header will be validated against the following list of domain names.\n                     ##  Multiple values supported with `|` delimiter\n                     ##  IE - trustanchor.org|trustanchor.org.uk\nobie.trusted_anchors.validation = \"openbanking.org.uk\"\n\n#Organization Id of the ASPSP. This value is used as the http://openbanking.org.uk/iss claim during response signing\nobie.org_id = \"ABC1234\"\n</code></pre> <p>For more information on configuring the <code>deployment.toml</code>, see the following topics:</p> <ul> <li>Configuring WSO2 Open Banking for UK</li> <li>Configuring WSO2 Open Banking for Berlin</li> <li>Configuring WSO2 Open Banking for Australia</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/","title":"Migration resources for WSO2 Open Banking 1.5.0 to 2.0.0 - Upgrade the solution for Australia","text":"<p>This directory contains the migration documentation and resources for WSO2 Open Banking 1.5.0 to 2.0.0 - Australia.</p> <p>The migration resources required for WSO2 Open Banking 1.5 to 2.0 - Australia can be found here.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/","title":"Upgrade WSO2 Open Banking from 1.5.0 to 2.0.0 for Australia","text":"<p>This page explains the following:</p> <ul> <li>Databases and Synapse configurations</li> <li>Disable Registry versioning</li> <li>Migrating Keystores</li> <li>Migrating custom components</li> <li>Upgrading Open Banking Identity and Access Management module (Open Banking Key Manager)</li> <li>Upgrading Open Banking API Manager</li> <li>Upgrading Open Banking Business Intelligence</li> <li>Application Attribute Changes</li> <li>Republish the APIs</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#databases-and-synapse-configurations","title":"Databases and Synapse configurations","text":"<ul> <li> <p>Take a backup of the existing database used by WSO2 Open Banking 1.5.0. This backup is necessary in case the migration causes issues in the existing database.</p> </li> <li> <p>Take a backup of the existing synapse configurations in WSO2 Open Banking 1.5.0. The synapse configuration is available in the <code>&lt;WSO2_OB_APIM_HOME&gt;/repository/deployment/server/synapse-configs</code> directory.</p> </li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#disable-registry-versioning","title":"Disable Registry versioning","text":"<p>When you have enabled versioning for Registry properties and if they are updated frequently, it can lead to an unnecessary growth in the Registry related database tables. To avoid this, WSO2 Open Banking 2.0 disables versioning by default.</p> <p>If you enabled Registry versioning for your WSO2 Open Banking 1.5.0 setup, you need to disable it before upgrading the solution. The required steps are as follows:</p> <ol> <li> <p>Open the <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/conf/registry.xml</code> and <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/conf/registry.xml</code> files.</p> </li> <li> <p>Locate the following properties in both files:</p> </li> </ol> <pre><code>&lt;versioningProperties&gt;true&lt;/versioningProperties&gt;\n&lt;versioningComments&gt;true&lt;/versioningComments&gt;\n&lt;versioningTags&gt;true&lt;/versioningTags&gt;\n&lt;versioningRatings&gt;true&lt;/versioningRatings&gt;\n</code></pre> <ol> <li> <p>If the above configurations are true, run the relevant database script. Use the relevant versioning script provided by the WSO2 team.</p> <p>Note</p> <p>If the above versioning configurations are already set as false you should not run the database scripts.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#migrating-keystores","title":"Migrating Keystores","text":"<p>Copy the keystores (<code>.jks</code> files) from WSO2 Open Banking 1.5.0 to WSO2 Open Banking 2.0.0.</p> Copy From Copy To <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_BI_150_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_BI_200_HOME&gt;/repository/resources/security</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#migrating-custom-components","title":"Migrating custom components","text":"<p>Changed internal API context paths</p> <p>The context paths of the following internal APIs have changed. If you have used the following for any custom implementation, update them accordingly:</p> Context path in 1.5.0 Context path in 2.0.0 <code>/consent</code> <code>/api/openbanking/consent-mgt</code> <code>/cdsadminapi</code> <code>/api/openbanking/cds-admin-api</code> <code>/openbankingaustralia</code> <code>/api/openbanking/backend-cds</code> <code>/dynamicclientregistration</code> <code>/api/openbanking/dynamic-client-registration</code> <p>Renamed JARs and packages</p> <p>If you have used the following jar files/packages for any custom implementations, update them as follows:</p> Package name in 1.5.0 Package name in 2.0.0 <code>com.wso2.finance.periodical.updater</code> <code>com.wso2.finance.open.banking.periodical.updater</code> <code>com.wso2.finance.status.validater</code> <code>com.wso2.finance.open.banking.status.validater</code> <code>eidas-cert-validator</code> <code>com.wso2.finance.open.banking.eidas.cert.validator</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#wso2-open-banking-identity-and-access-management-module","title":"WSO2 Open Banking Identity and Access Management module","text":"<p>The WSO2 Key Manager is referred to as the WSO2 Open Banking Identity and Access Management module in WSO2 Open Banking 2.0.0. This module is based on WSO2 Identity Server 5.10.0, which includes major upgrades to the main component and WSO2 Carbon Kernel. Any customized OSGi bundle added to Identity Server needs to be recompiled with the new dependency versions relevant to Identity Server 5.10.0.</p> <p>To recompile the custom OSGi bundles:</p> <ol> <li> <p>Obtain the source codes of the custom OSGi component</p> </li> <li> <p>Update the dependency versions in the relevant POM files according to Identity Server 5.10.0</p> </li> <li> <p>Compile the project</p> </li> </ol> <p>Make sure to recompile the following and place them in the WSO2 Open Banking 2.0.0 solution:</p> Content Recompile Copy to Custom OSGI bundles(manually added files) <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/dropins</code> Custom JAR files (manually added files) <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/components/libs</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/libs</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#wso2-open-banking-api-management-module","title":"WSO2 Open Banking API Management module","text":"<p>You need to copy the custom OSGi bundles and custom JAR files (manually added by you to the solution) as follows:</p> Content Copy from Copy to Custom OSGi bundles (manually added files) <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/dropins</code> Custom JAR files (manually added files) <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/components/lib</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/lib</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#upgrading-open-banking-identity-and-access-management-module-open-banking-key-manager","title":"Upgrading Open Banking Identity and Access Management module (Open Banking Key Manager)","text":"<p>WSO2 Open Banking 2.0.0 refers to WSO2 Key Manager as the WSO2 Open Banking Identity and Access Management module. This section guides you on how to upgrade from Identity Key Manager 1.5.0 to Identity and Access Management 2.0.0.</p> <p>This section explains the following:</p> <ul> <li>Setting Up Database</li> <li>Configuring the <code>deployment.toml</code> file</li> <li>Migrating secondary user stores</li> <li>Migrating Databases</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#setting-up-database","title":"Setting Up Database","text":"<p>Copy the relevant JDBC driver to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/lib</code> directory.</p> <p>Note</p> <p>If you are using an Oracle database make sure the users have the CREATE PROCEDURE privilege before proceeding.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#configuring-the-deploymenttoml-file","title":"Configuring the <code>deployment.toml</code> file","text":"<p>WSO2 Open Banking 2.0.0 introduces a new configuration model where the users have all the product configurations in a single configuration file, namely <code>deployment.toml</code>.</p> <ol> <li> <p>Copy the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/resources/finance/scripts/wso2-obiam-conf/deployement/bg/deployment.toml</code> file to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/conf/</code> directory and replace the existing file.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/conf/deployment.toml</code> file and update the datasource configurations for the following databases:</p> </li> <li> <p>User Store</p> </li> <li>Registry database(s)</li> <li>API Manager database</li> <li> <p>Open Banking Database</p> </li> <li> <p>Datasource configurations in 1.5.0 maps with the 2.0.0 new configuration model as follows:</p> Key Manager 1.5.0 Identity and Access Management 2.0.0 <code>WSO2AM_DB</code> <code>apim_db</code> <code>WSO2CONFIG_DB</code> <code>config</code> <code>WSO2REG_DB</code> <code>shared_db</code> <code>WSO2UM_DB</code> <code>WSO2UM_DB</code> <code>WSO2_OPEN_BANKING_DB</code> <code>open_banking_database</code> </li> </ol> <p>Given below are sample configurations for each database type:</p> <p>MySQL</p> <pre><code>config.url = \"jdbc:mysql://localhost:3306/openbank_apimgtdb?autoReconnect=true&amp;useSSL=false\"\nconfig.username = \"root\"\nconfig.password = \"root\"\nconfig.driver = \"com.mysql.jdbc.Driver\"\n</code></pre> <p>MSSQL</p> <pre><code>config.url = \"jdbc:sqlserver://localhost:1433;databaseName=openbank_apimgtdb;encrypt=false\"\nconfig.username = \"sa\"\nconfig.password = \"Root\"\nconfig.driver = \"com.microsoft.sqlserver.jdbc.SQLServerDriver\"\n</code></pre> <p>Oracle</p> <pre><code>config.url = \"jdbc:oracle:thin:@localhost:1521:ORCLCDB\"\nconfig.username = \"C##bg_ob_apimgtdb\"\nconfig.password = \"wso2carbon\"\nconfig.driver = \"oracle.jdbc.driver.OracleDriver\"\n</code></pre> <ol> <li>The <code>deployment.toml</code> file contains placeholder, update them with the hostnames of the following servers:</li> </ol> Placeholder Server <code>IAM_HOSTNAME</code> Identity and Access Management <code>APIM_HOSTNAME</code> API Management <code>ANALYTICS_HOSTNAME</code> Open Banking Business Intelligence"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#migrating-secondary-user-stores","title":"Migrating secondary user stores","text":"<p>If you have created any secondary user stores for Open Banking 1.5.0, copy the content to the new setup as follows:</p> Content Copy from Copy to Secondary user stores <code>&lt;WSO2_OB_IAM_150_HOME&gt;/repository/deployment/server/userstores</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/deployment/server/userstores</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#migrating-databases","title":"Migrating Databases","text":"<ol> <li> <p>Get the migration client (<code>wso2is-migration-x.x.x.zip</code>) provided by the WSO2 team.</p> </li> <li> <p>Extract it into a local directory. The directory where the <code>wso2is-migration-x.x.x.zip</code> is extracted is referred to as <code>&lt;IS_MIGRATION_TOOL_HOME&gt;</code>.</p> </li> <li> <p>Copy the <code>&lt;IS_MIGRATION_TOOL_HOME&gt;/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file into the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/dropins</code> directory.</p> </li> <li> <p>Copy the <code>&lt;IS_MIGRATION_TOOL_HOME&gt;/migration-resources</code> directory to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;</code> root directory.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/migration-resources/migration-config.yaml</code> file:</p> </li> <li> <p>Make sure versions are as follows:</p> <pre><code>migrationEnable: \"true\"\ncurrentVersion: \"5.7.0\"\nmigrateVersion: \"5.10.0\"\n</code></pre> </li> <li> <p>Remove the following configurations under the version: \"5.8.0\" tag:</p> <pre><code>-\n    name: \"UMAPermissionTicketSchemaMigrator\"\n    order: 3\n    parameters:\n    location: \"step2\"\n    schema: \"uma\"\n</code></pre> </li> <li> <p>Remove the following configurations under the version: \"5.10.0\" tag:</p> <pre><code>-\n    name: \"MigrationValidator\"\n    order: 2\n-\n    name: \"SchemaMigrator\"\n    order: 5\n    parameters:\n    location: \"step2\"\n    schema: \"identity\"\n</code></pre> </li> <li> <p>Update the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/conf/deployment.toml</code> by configuring the previous user store.</p> </li> </ol> <pre><code>[user_store]\ntype = \"database\"\n#type = \"database_unique_id\"\n#class = \"org.wso2.carbon.user.core.jdbc.UniqueIDJDBCUserStoreManager\"\n</code></pre> <ol> <li>Start the WSO2 Open Banking Identity Access Management 2.0.0 server with the migration client. Use the commands given below:</li> </ol> <p>Linux/Unix or macOS</p> <pre><code>sh wso2server.sh -Dmigrate -Dcomponent=identity\n</code></pre> <p>Windows</p> <pre><code>wso2server.bat -Dmigrate -Dcomponent=identity\n</code></pre> <ol> <li> <p>Once the migration client execution is completed, stop the server.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/migration-resources</code> directory.</p> </li> <li> <p>Restart the Identity and Access Management server now.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#upgrading-open-banking-api-manager","title":"Upgrading Open Banking API Manager","text":"<p>This section guides you on how to upgrade WSO2 Open Banking API Management 1.5.0 to 2.0.0.</p> <p>This section contains the following:</p> <ul> <li>Setting Up Database</li> <li>Configuring the <code>deployment.toml</code> file</li> <li>Moving Synapse configurations</li> <li>Migrating Databases</li> <li>Migrating API Manager artifacts</li> <li>Reindexing Registry artifacts</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#setting-up-database_1","title":"Setting Up Database","text":"<p>Copy the relevant JDBC driver to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/lib</code> directory.</p> <p>Note</p> <p>If you are using an Oracle database make sure the users have the CREATE PROCEDURE privilege before proceeding.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#configuring-the-deploymenttoml-file_1","title":"Configuring the deployment.toml file","text":"<p>WSO2 Open Banking 2.0.0 introduces a new configuration model where the users have all the product configurations in a single configuration file, namely deployment.toml.</p> <ol> <li> <p>Copy the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/finance/scripts/wso2-obam-conf/deployement/bg/deployment.toml</code> file to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/conf/</code> directory and replace the existing one.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/conf/deployment.toml</code> file and update the datasource configurations for the following databases:</p> </li> <li> <p>User Store</p> </li> <li>Registry database(s)</li> <li>API Manager database</li> <li> <p>Open Banking Database</p> </li> <li> <p>Datasource configurations in 1.5.0 maps with the 2.0.0 new configuration model as follows:</p> </li> </ol> API Manager 1.5.0 API Manager 2.0.0 <code>WSO2AM_DB</code> <code>apim_db</code> <code>WSO2CONFIG_DB</code> <code>config</code> <code>WSO2REG_DB</code> <code>shared_db</code> <code>WSO2UM_DB</code> <code>WSO2UM_DB</code> <code>WSO2AM_STATS_DB</code> <code>WSO2AM_STATS_DB</code> <code>WSO2_OPEN_BANKING_DB</code> <code>open_banking_database</code> <p>Given below are sample configurations for each database type:</p> <p>MySQL</p> <pre><code>config.url = \"jdbc:mysql://localhost:3306/openbank_apimgtdb?autoReconnect=true&amp;useSSL=false\"\nconfig.username = \"root\"\nconfig.password = \"root\"\nconfig.driver = \"com.mysql.jdbc.Driver\"\n</code></pre> <p>MSSQL</p> <pre><code>config.url = \"jdbc:sqlserver://localhost:1433;databaseName=openbank_apimgtdb;encrypt=false\"\nconfig.username = \"sa\"\nconfig.password = \"Root\"\nconfig.driver = \"com.microsoft.sqlserver.jdbc.SQLServerDriver\"\n</code></pre> <p>Oracle</p> <pre><code>config.url = \"jdbc:oracle:thin:@localhost:1521:ORCLCDB\"\nconfig.username = \"C##bg_ob_apimgtdb\"\nconfig.password = \"wso2carbon\"\nconfig.driver = \"oracle.jdbc.driver.OracleDriver\"\n</code></pre> <ol> <li>The deployment.toml file contains placeholder, update them with the hostnames of the following servers:</li> </ol> Placeholder Server <code>IAM_HOSTNAME</code> Identity and Access Management <code>APIM_HOSTNAME</code> API Management <code>ANALYTICS_HOSTNAME</code> Open Banking Business Intelligence"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#moving-synapse-configurations","title":"Moving Synapse configurations","text":"<ol> <li> <p>Stop all WSO2 API Manager server instances that are running.</p> </li> <li> <p>Move the following content to WSO2 Open Banking 2.0.0:</p> </li> </ol> <p>Warning</p> <p>When replacing the Synapse configurations, do not replace the following, as they contain API Management module version 2.0.0. - <code>/api/_RevokeAPI_.xml</code> - <code>/sequences/_cors_request_handler_.xml</code> - <code>/sequences/main.xml</code></p> Content Copy from Copy to Synapse super tenant configurations <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/deployment/server/ synapse-configs/default</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/epository/deployment/server/synapse-configs/default</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#migrating-databases_1","title":"Migrating Databases","text":"<ol> <li> <p>To migrate data into WSO2 Open Banking API Manager 2.0.0, execute the relevant database script against the <code>WSO2AM_DB</code> database.</p> </li> <li> <p>Get the API Manager migration database scripts provided by the WSO2 team.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#migrating-api-manager-artifacts","title":"Migrating API Manager artifacts","text":"<ol> <li> <p>Migration resources:</p> </li> <li> <p>Get the API Manager migration resources (<code>migration-resources.zip</code>) provided by the WSO2 team.</p> </li> <li> <p>Extract the received <code>migration-resources.zip</code>.</p> </li> <li> <p>Copy the extracted <code>migration-resources</code> directory to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;</code> directory.</p> </li> <li> <p>Migration client:</p> </li> <li> <p>Get the API Manager migration client (<code>org.wso2.carbon.apimgt.migrate.client-3.1.0-3.jar</code>) provided by the WSO2 team.</p> </li> <li> <p>Copy the downloaded <code>org.wso2.carbon.apimgt.migrate.client-3.1.0-3.jar</code> to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/dropins</code> directory.</p> </li> <li> <p>Start the API Management server with the migration client. Use the commands below:</p> </li> </ol> <p>Linux/Unix or macOS</p> <pre><code>sh wso2server.sh -DmigrateFromVersion=2.6.0\n</code></pre> <p>Windows</p> <pre><code>wso2server.bat -DmigrateFromVersion=2.6.0\n</code></pre> <ol> <li> <p>Once the migration client execution is completed, stop the server.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/dropins/org.wso2.carbon.apimgt.migrate.client-3.1.0-3.jar</code> file.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/migration-resources</code> directory.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#reindexing-registry-artifacts","title":"Reindexing Registry artifacts","text":"<ol> <li> <p>Execute the given database scripts against the <code>SHARED_DB</code> database. Get the relevant registry indexing script provided by the WSO2 team.</p> </li> <li> <p>Add the following configurations to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/conf/deployment.toml</code> file.</p> </li> </ol> <pre><code>[indexing]\nre_indexing= 1\n</code></pre> <ol> <li> <p>Backup the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/solr</code> directory if it exists, then delete it.</p> </li> <li> <p>Start the API Management server.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#upgrading-open-banking-business-intelligence","title":"Upgrading Open Banking Business Intelligence","text":"<p>This section explains how to upgrade from Open Banking Business Intelligence 1.5.0 to 2.0.0.</p> <p>Warning</p> <p>These steps are only required if you have configured Open Banking Business Intelligence in your existing deployment.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#migrating-the-analytics-database","title":"Migrating the Analytics database","text":"<ol> <li> <p>Get the analytics migration script (<code>analytics_migration_scripts.zip</code>) and reporting stats script (<code>reporting_stats_scripts.zip</code>) provided by the WSO2 team.</p> </li> <li> <p>Execute them against the given databases:</p> </li> </ol> Database name Script to execute <code>APIM_ANALYTICS_DB</code> <code>analytics_migration_scripts.zip</code> <code>OB_REPORTING_DB</code> <code>reporting_stats_scripts.zip</code> <ol> <li> <p>After a WUM update for Open Banking Business Intelligence 1.5.0, the data types and field-names of certain database tables were changed. It is important to reflect these changes in your databases before the upgrading process.</p> </li> <li> <p>Get the relevant updating analytics database scripts provided by the WSO2 team.</p> </li> <li>Update the scripts by replacing the <code>&lt;APIM_ANALYTICS_DB&gt;</code> placeholder with the hostname of your database server.</li> <li>Execute the relevant script, according to your database type to perform these changes if they are not already available.</li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#migrating-configurations","title":"Migrating configurations","text":"<ol> <li> <p>Open the following configuration files and update them by configuring the databases that you have used in Open Banking Business Intelligence 1.5.0.</p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/conf/dashboard/deployment.yaml</code></p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/conf/worker/deployment.yaml</code></p> </li> <li> <p>Open the following siddhi files and replace the <code>&lt;ANALYTICS_HOSTNAME&gt;</code> placeholder with the hostname of your Open Banking Business Intelligence server.</p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/deployment/siddhi-files/TRAAccountValidationApp.siddhi</code></p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/deployment/siddhi-files/TRAPaymentValidationApp.siddhi</code></p> </li> <li> <p>Place the relevant JDBC driver as an OSGi bundle in the <code>&lt;WSO2_OB_BI_200_HOME&gt;/lib</code> director.</p> </li> </ol> <p>For Oracle or MSSQL database drivers:</p> <p>You need to include the database driver corresponding to the database for the WSO2 Open Banking Business Intelligence server to communicate with the database. The WSO2 Open Banking Business Intelligence is an OSGi-based product. Therefore, when you integrate third-party products such as Oracle and MS SQL with WSO2 OB BI, you need to check whether the libraries you need to add are OSGi based. If they are not, you need to convert them to OSGi bundles before adding them to the <code>&lt;WSO2_OB_BI_200_HOME&gt;/lib</code> directory.</p> <p>To convert the jar files to OSGi bundles, follow the steps below.</p> <ol> <li> <p>Download the non-OSGi jar for the required third party product, and save it in a preferred directory on your machine.</p> </li> <li> <p>Go to the <code>&lt;WSO2_OB_BI_200_HOME&gt;/bin</code> directory. Run the command given below to generate the converted file in the <code>&lt;WSO2_OB_BI_200_HOME&gt;/lib</code> directory.</p> <pre><code>./jartobundle.sh &lt;PATH_TO_NON-OSGi_JAR&gt; ../lib\n</code></pre> </li> </ol> <ol> <li>Go to the <code>&lt;WSO2_OB_BI_200_HOME&gt;/bin</code> directory and start the Worker and Dashboard profiles.</li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#application-attribute-changes","title":"Application Attribute Changes","text":"<p>To upgrade the application attribute data :</p> <ol> <li>Go to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/dbscripts/finance/apimgt/migration_1.5.0_to_2.0.0</code> directory. </li> <li>Execute the relevant database script against the <code>WSO2AM_DB</code> database. </li> <li>Restart the WSO2 API Management module.</li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-au/#republish-the-apis","title":"Republish the APIs","text":"<p>To use the APIs published in WSO2 Open Banking 1.5.0 setup, you need to redeploy these APIs to reflect the changes from the sequence files.</p> <p>Before you begin:</p> <ol> <li>Open the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/api_templates/velocity_template.xml</code> file.</li> <li>Update the <code>&lt;IAM_HOSTNAME&gt;</code> placeholder with the hostname of your Identity and Access Management server.</li> <li>Restart the API Management server.</li> </ol> <ol> <li> <p>Sign in to the WSO2 API Publisher at <code>https://&lt;WSO2_OB_APIM_200_HOST&gt;:9443/publisher</code>.</p> </li> <li> <p>Navigate to the API listing page, and select the API which you want to edit.</p> </li> <li> <p>Go to Runtime Configurations using the left menu panel.</p> </li> </ol> <p></p> <ol> <li> <p>Click the edit button under Request &gt; Message Mediation.</p> </li> <li> <p>Now, select the Custom Policy option.</p> </li> <li> <p>Upload the relevant in-sequence file from the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/finance/apis/berlin-group.org</code> directory.</p> </li> <li> <p>Scroll down and click SAVE.</p> </li> <li> <p>Go to Lifecycle using the left menu panel.</p> </li> </ol> <p></p> <ol> <li>Redeploy the API by clicking the Redeploy button.</li> </ol> <p></p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/","title":"Migration resources for WSO2 Open Banking 1.5.0 to 2.0.0 - Upgrade the solution for Berlin","text":"<p>This directory contains the migration documentation and resources for WSO2 Open Banking 1.5.0 to 2.0.0 - Berlin.</p> <p>The migration resources required for WSO2 Open Banking 1.5 to 2.0 - Berlin can be found here.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/","title":"Upgrade WSO2 Open Banking from 1.5.0 to 2.0.0 for Berlin","text":"<p>This page explains the following:</p> <ul> <li>Databases and Synapse configurations</li> <li>Disable Registry versioning</li> <li>Migrating Keystores</li> <li>Migrating custom components</li> <li>Upgrading Open Banking Identity and Access Management module (Open Banking Key Manager)</li> <li>Upgrading Open Banking API Manager</li> <li>Upgrading Open Banking Business Intelligence</li> <li>Application Attribute Changes</li> <li>Republish the APIs</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#databases-and-synapse-configurations","title":"Databases and Synapse configurations","text":"<ul> <li>Take a backup of the existing database used by WSO2 Open Banking 1.5.0. This backup is necessary in case the migration causes issues in the existing database.</li> <li>Take a backup of the existing synapse configurations in WSO2 Open Banking 1.5.0. The synapse configuration is available in the <code>&lt;WSO2_OB_APIM_HOME&gt;/repository/deployment/server/synapse-configs</code> directory.</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#disable-registry-versioning","title":"Disable Registry versioning","text":"<p>When you have enabled versioning for Registry properties and if they are updated frequently, it can lead to an unnecessary growth in the Registry related database tables. To avoid this, WSO2 Open Banking 2.0 disables versioning by default.</p> <p>If you enabled Registry versioning for your WSO2 Open Banking 1.5.0 setup, you need to disable it before upgrading the solution. The required steps are as follows:</p> <ol> <li> <p>Open the <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/conf/registry.xml</code> and <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/conf/registry.xml</code> files.</p> </li> <li> <p>Locate the following properties in both files:</p> </li> </ol> <pre><code>&lt;versioningProperties&gt;true&lt;/versioningProperties&gt;\n&lt;versioningComments&gt;true&lt;/versioningComments&gt;\n&lt;versioningTags&gt;true&lt;/versioningTags&gt;\n&lt;versioningRatings&gt;true&lt;/versioningRatings&gt;\n</code></pre> <ol> <li> <p>If the above configurations are true, use the relevant versioning script provided by the WSO2 team.</p> <p>Note</p> <p>If the above versioning configurations are already set as false you should not run the database scripts.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#migrating-keystores","title":"Migrating Keystores","text":"<p>Copy the keystores (<code>.jks</code> files) from WSO2 Open Banking 1.5.0 to WSO2 Open Banking 2.0.0.</p> Copy From Copy To <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_BI_150_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_BI_200_HOME&gt;/repository/resources/security</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#migrating-custom-components","title":"Migrating custom components","text":"<p>Changed internal API context paths</p> <p>The context paths of the following internal APIs have changed. If you have used the following for any custom implementation, update them accordingly:</p> Context path in 1.5.0 Context path in 2.0.0 <code>/consent</code> <code>/api/openbanking/consent-mgt</code> <code>/openbankingberlin</code> <code>/api/openbanking/backend-berlin</code> <p>Renamed JARs and packages</p> <p>If you have used the following jar files/packages for any custom implementations, update them as follows:</p> Package name in 1.5.0 Package name in 2.0.0 <code>com.wso2.finance.periodical.updater</code> <code>com.wso2.finance.open.banking.periodical.updater</code> <code>com.wso2.finance.status.validater</code> <code>com.wso2.finance.open.banking.status.validater</code> <code>eidas-cert-validator</code> <code>com.wso2.finance.open.banking.eidas.cert.validator</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#wso2-open-banking-identity-and-access-management-module","title":"WSO2 Open Banking Identity and Access Management module","text":"<p>The WSO2 Key Manager is referred to as the WSO2 Open Banking Identity and Access Management module in WSO2 Open Banking 2.0.0. This module is based on WSO2 Identity Server 5.10.0, which includes major upgrades to the main component and WSO2 Carbon Kernel. Any customized OSGi bundle added to Identity Server needs to be recompiled with the new dependency versions relevant to Identity Server 5.10.0.</p> <p>To recompile the custom OSGi bundles:</p> <ol> <li>Obtain the source codes of the custom OSGi component</li> <li>Update the dependency versions in the relevant POM files according to Identity Server 5.10.0</li> <li>Compile the project</li> </ol> <p>Make sure to recompile the following and place them in the WSO2 Open Banking 2.0.0 solution</p> Content Recompile Copy to Custom OSGI bundles(manually added files) <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/dropins</code> Custom JAR files(manually added files) <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/components/libs</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/libs</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#wso2-open-banking-api-management-module","title":"WSO2 Open Banking API Management module","text":"<p>You need to copy the custom OSGi bundles and custom JAR files (manually added by you to the solution) as follows:</p> Content Copy from Copy to Custom OSGi bundles (manually added files) <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/dropins</code> Custom JAR files(manually added files) <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/component/lib</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/lib</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#upgrading-open-banking-identity-and-access-management-module-open-banking-key-manager","title":"Upgrading Open Banking Identity and Access Management module (Open Banking Key Manager)","text":"<p>WSO2 Open Banking 2.0.0 refers to WSO2 Key Manager as the WSO2 Open Banking Identity and Access Management module. This section guides you on how to upgrade from Identity Key Manager 1.5.0 to Identity and Access Management 2.0.0.</p> <p>This section explains the following:</p> <ul> <li>Setting Up Database</li> <li>Configuring the <code>deployment.toml</code> file</li> <li>Migrating secondary user stores</li> <li>Migrating Databases</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#setting-up-database","title":"Setting Up Database","text":"<ol> <li>Copy the relevant JDBC driver to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/lib</code> directory.</li> </ol> <p>Tip</p> <p>If you are using an Oracle database make sure the users have the CREATE PROCEDURE privilege before proceeding.</p> <ol> <li>According to your database, execute the relevant database script against the mentioned databases:</li> </ol> Database Script location <code>openbank_openbankingdb</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/dbscripts/finance/berlin-group.org/migration-1.5.0_to_2</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#configuring-the-deploymenttoml-file","title":"Configuring the <code>deployment.toml</code> file","text":"<p>WSO2 Open Banking 2.0.0 introduces a new configuration model where the users have all the product configurations in a single configuration file, namely deployment.toml.</p> <ol> <li> <p>Copy the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/resources/finance/scripts/wso2-obiam-conf/deployement/bg/deployment.toml</code> file to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/conf/</code> directory and replace the existing file.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/conf/deployment.toml</code> file and update the datasource configurations for the following databases:</p> </li> <li> <p>User Store</p> </li> <li>Registry database(s)</li> <li>API Manager database</li> <li> <p>Open Banking Database</p> </li> <li> <p>Datasource configurations in 1.5.0 maps with the 2.0.0 new configuration model as follows:</p> </li> </ol> Key Manager 1.5.0 Identity and Access Management 2.0.0 <code>WSO2AM_DB</code> <code>apim_db</code> <code>WSO2CONFIG_DB</code> <code>config</code> <code>WSO2REG_DB</code> <code>shared_db</code> <code>WSO2UM_DB</code> <code>WSO2UM_DB</code> <code>WSO2_OPEN_BANKING_DB</code> <code>open_banking_database</code> <p>Given below are sample configurations for each database type:</p> <p>MySQL</p> <pre><code>config.url = \"jdbc:mysql://localhost:3306/openbank_apimgtdb?autoReconnect=true&amp;useSSL=false\"\nconfig.username = \"root\"\nconfig.password = \"root\"\nconfig.driver = \"com.mysql.jdbc.Driver\"\n</code></pre> <p>MSSQL</p> <pre><code>config.url = \"jdbc:sqlserver://localhost:1433;databaseName=openbank_apimgtdb;encrypt=false\"\nconfig.username = \"sa\"\nconfig.password = \"Root\"\nconfig.driver = \"com.microsoft.sqlserver.jdbc.SQLServerDriver\"   \n</code></pre> <p>Oracle</p> <pre><code>config.url = \"jdbc:oracle:thin:@localhost:1521:ORCLCDB\"\nconfig.username = \"C##bg_ob_apimgtdb\"\nconfig.password = \"wso2carbon\"\nconfig.driver = \"oracle.jdbc.driver.OracleDriver\"   \n</code></pre> <ol> <li> <p>The <code>deployment.toml</code> file contains placeholder, update them with the hostnames of the following servers:</p> Placeholder Server <code>IAM_HOSTNAME</code> Identity and Access Management <code>APIM_HOSTNAME</code> API Management <code>ANALYTICS_HOSTNAME</code> Open Banking Business Intelligence </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#migrating-secondary-user-stores","title":"Migrating secondary user stores","text":"<p>If you have created any secondary user stores for Open Banking 1.5.0, copy the content to the new setup as follows:</p> Content Copy from Copy to Secondary user stores <code>&lt;WSO2_OB_IAM_150_HOME&gt;/repository/deployment/server/userstores</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/deployment/server/userstores</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#migrating-databases","title":"Migrating Databases","text":"<ol> <li> <p>Get the migration client (<code>wso2is-migration-x.x.x.zip</code>) provided by the WSO2 team.</p> </li> <li> <p>Extract it into a local directory. The directory where the <code>wso2is-migration-x.x.x.zip</code> is extracted is referred to as <code>&lt;IS_MIGRATION_TOOL_HOME&gt;</code>.</p> </li> <li> <p>Copy the <code>&lt;IS_MIGRATION_TOOL_HOME&gt;/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file into the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/dropins</code> directory.</p> </li> <li> <p>Copy the <code>&lt;IS_MIGRATION_TOOL_HOME&gt;/migration-resources</code> directory to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;</code> root directory.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/migration-resources/migration-config.yaml</code> file:</p> </li> <li> <p>Make sure versions are as follows:</p> </li> </ol> <pre><code>migrationEnable: \"true\"\ncurrentVersion: \"5.7.0\"\nmigrateVersion: \"5.10.0\"\n</code></pre> <ol> <li>Remove the following configurations under the version: \"5.8.0\" tag:</li> </ol> <pre><code>-\n    name: \"UMAPermissionTicketSchemaMigrator\"\n    order: 3\n    parameters:\n    location: \"step2\"\n    schema: \"uma\"\n</code></pre> <ol> <li>Remove the following configurations under the version: \"5.10.0\" tag:</li> </ol> <pre><code>-\n    name: \"MigrationValidator\"\n    order: 2\n-\n    name: \"SchemaMigrator\"\n    order: 5\n    parameters:\n    location: \"step2\"\n    schema: \"identity\"\n</code></pre> <ol> <li>Update the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/conf/deployment.toml</code> by configuring the previous user store.</li> </ol> <pre><code>[user_store]\ntype = \"database\"\n#type = \"database_unique_id\"\n#class = \"org.wso2.carbon.user.core.jdbc.UniqueIDJDBCUserStoreManager\"\n</code></pre> <ol> <li>Start the WSO2 Open Banking Identity Access Management 2.0.0 server with the migration client. Use the commands given below:</li> </ol> <p>Linux/Unix or macOS</p> <pre><code>sh wso2server.sh -Dmigrate -Dcomponent=identity\n</code></pre> <p>Windows</p> <pre><code>wso2server.bat -Dmigrate -Dcomponent=identity\n</code></pre> <ol> <li> <p>Once the migration client execution is completed, stop the server.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/migration-resources</code> directory.</p> </li> <li> <p>Restart the Identity and Access Management server now.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#upgrading-open-banking-api-manager","title":"Upgrading Open Banking API Manager","text":"<p>This section guides you on how to upgrade WSO2 Open Banking API Management 1.5.0 to 2.0.0.</p> <p>This section explains the following:</p> <ul> <li>Setting Up Database</li> <li>Configuring the <code>deployment.toml</code> file</li> <li>Moving Synapse configurations</li> <li>Migrating Databases</li> <li>Migrating API Manager artifacts</li> <li>Reindexing Registry artifacts</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#setting-up-database_1","title":"Setting Up Database","text":"<p>Copy the relevant JDBC driver to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/lib</code> directory.</p> <p>Note</p> <p>If you are using an Oracle database make sure the users have the CREATE PROCEDURE privilege before proceeding.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#configuring-the-deploymenttoml-file_1","title":"Configuring the deployment.toml file","text":"<p>WSO2 Open Banking 2.0.0 introduces a new configuration model where the users have all the product configurations in a single configuration file, namely deployment.toml.</p> <ol> <li> <p>Copy the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/finance/scripts/wso2-obam-conf/deployement/bg/deployment.toml</code> file to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/conf/</code> directory and replace the existing one.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/conf/deployment.toml</code> file and update the datasource configurations for the following databases:</p> </li> <li> <p>User Store</p> </li> <li>Registry database(s)</li> <li>API Manager database</li> <li> <p>Open Banking Database</p> </li> <li> <p>Datasource configurations in 1.5.0 maps with the 2.0.0 new configuration model as follows:</p> API Manager 1.5.0 API Manager 2.0.0 <code>WSO2AM_DB</code> <code>apim_db</code> <code>WSO2CONFIG_DB</code> <code>config</code> <code>WSO2REG_DB</code> <code>shared_db</code> <code>WSO2UM_DB</code> <code>WSO2UM_DB</code> <code>WSO2AM_STATS_DB</code> <code>WSO2AM_STATS_DB</code> <code>WSO2_OPEN_BANKING_DB</code> <code>open_banking_database</code> </li> </ol> <p>Given below are sample configurations for each database type:</p> <p>MySQL</p> <pre><code>config.url = \"jdbc:mysql://localhost:3306/openbank_apimgtdb?autoReconnect=true&amp;useSSL=false\"\nconfig.username = \"root\"\nconfig.password = \"root\"\nconfig.driver = \"com.mysql.jdbc.Driver\"\n</code></pre> <p>MSSQL</p> <pre><code>config.url = \"jdbc:sqlserver://localhost:1433;databaseName=openbank_apimgtdb;encrypt=false\"\nconfig.username = \"sa\"\nconfig.password = \"Root\"\nconfig.driver = \"com.microsoft.sqlserver.jdbc.SQLServerDriver\"\n</code></pre> <p>Oracle</p> <pre><code>config.url = \"jdbc:oracle:thin:@localhost:1521:ORCLCDB\"\nconfig.username = \"C##bg_ob_apimgtdb\"\nconfig.password = \"wso2carbon\"\nconfig.driver = \"oracle.jdbc.driver.OracleDriver\"\n</code></pre> <ol> <li>The <code>deployment.toml</code> file contains placeholder, update them with the hostnames of the following servers:</li> </ol> Placeholder Server <code>IAM_HOSTNAME</code> Identity and Access Management <code>APIM_HOSTNAME</code> API Management <code>ANALYTICS_HOSTNAME</code> Open Banking Business Intelligence"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#moving-synapse-configurations","title":"Moving Synapse configurations","text":"<ol> <li> <p>Stop all WSO2 API Manager server instances that are running.</p> </li> <li> <p>Move the following content to WSO2 Open Banking 2.0.0:</p> </li> </ol> <p>Warning</p> <p>When replacing the Synapse configurations, do not replace the following, as they contain API Management module version 2.0.0. - <code>/api/_RevokeAPI_.xml</code> - <code>/sequences/_cors_request_handler_.xml</code> - <code>/sequences/main.xml</code></p> Content Copy from Copy to Synapse super tenant configurations <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/deployment/server/synapse-configs/default</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/deployment/server/synapse-configs/default</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#migrating-databases_1","title":"Migrating Databases","text":"<ol> <li> <p>To migrate data into WSO2 Open Banking API Manager 2.0.0, execute the relevant database script against the <code>WSO2AM_DB</code> database.</p> </li> <li> <p>Get the API Manager migration database scripts provided by the WSO2 team.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#migrating-api-manager-artifacts","title":"Migrating API Manager artifacts","text":"<ol> <li> <p>Migration resources:</p> </li> <li> <p>Get the API Manager migration resources (<code>migration-resources.zip</code>) provided by the WSO2 team.</p> </li> <li> <p>Extract the received <code>migration-resources.zip</code>.</p> </li> <li> <p>Copy the extracted <code>migration-resources</code> directory to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;</code> directory.</p> </li> <li> <p>Migration client:</p> </li> <li> <p>Get the API Manager migration client (<code>org.wso2.carbon.apimgt.migrate.client-3.1.0-3.jar</code>) provided by the WSO2 team.</p> </li> <li> <p>Copy the received <code>org.wso2.carbon.apimgt.migrate.client-3.1.0-3.jar</code> to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/dropins</code> directory.</p> </li> <li> <p>Start the API Management server with the migration client. Use the commands below:</p> </li> </ol> <p>Linux/Unix or macOS</p> <pre><code>sh wso2server.sh -DmigrateFromVersion=2.6.0\n</code></pre> <p>Windows</p> <pre><code>wso2server.bat -DmigrateFromVersion=2.6.0\n</code></pre> <ol> <li> <p>Once the migration client execution is completed, stop the server.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/dropins/org.wso2.carbon.apimgt.migrate.client-3.1.0-3.jar</code> file.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/migration-resources</code> directory.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#reindexing-registry-artifacts","title":"Reindexing Registry artifacts","text":"<ol> <li> <p>Execute the given database scripts against the <code>SHARED_DB</code> database.</p> </li> <li> <p>Get the relevant registry indexing script provided by the WSO2 team.</p> </li> <li> <p>Add the following configurations to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/conf/deployment.toml</code> file.</p> </li> </ol> <pre><code>[indexing]\nre_indexing= 1\n</code></pre> <ol> <li> <p>Backup the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/solr</code> directory if it exists, then delete it.</p> </li> <li> <p>Start the API Management server.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#upgrading-open-banking-business-intelligence","title":"Upgrading Open Banking Business Intelligence","text":"<p>This section explains how to upgrade from Open Banking Business Intelligence 1.5.0 to 2.0.0.</p> <p>Warning</p> <p>These steps are only required if you have configured Open Banking Business Intelligence in your existing deployment.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#migrating-the-analytics-database","title":"Migrating the Analytics database","text":"<ol> <li> <p>Get the relevant analytics migration script provided by the WSO2 team. Execute the downloaded database scripts against the <code>APIM_ANALYTICS_DB</code> database.</p> </li> <li> <p>After a WUM update for Open Banking Business Intelligence 1.5.0, the data types and field-names of certain database tables were changed. It is important to reflect these changes in your databases before the upgrading process.</p> </li> <li> <p>Get the relevant updating analytics database scripts provided by the WSO2 team.</p> </li> <li>Update the scripts by replacing the <code>&lt;APIM_ANALYTICS_DB&gt;</code> placeholder with the hostname of your database server.</li> <li>Execute the relevant script, according to your database type to perform these changes if they are not already available.</li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#migrating-configurations","title":"Migrating configurations","text":"<ol> <li> <p>Open the following configuration files and update them by configuring the databases that you have used in Open Banking Business Intelligence 1.5.0.</p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/conf/dashboard/deployment.yaml</code></p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/conf/worker/deployment.yaml</code></p> </li> <li> <p>Open the following siddhi files and replace the <code>&lt;ANALYTICS_HOSTNAME&gt;</code> placeholder with the hostname of your Open Banking Business Intelligence server.</p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/deployment/siddhi-files/TRAAccountValidationApp.siddhi</code></p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/deployment/siddhi-files/TRAPaymentValidationApp.siddhi</code></p> </li> <li> <p>Place the relevant JDBC driver as an OSGi bundle in the <code>&lt;WSO2_OB_BI_200_HOME&gt;/lib</code> directory.</p> </li> </ol> <p>For Oracle or MSSQL database drivers:</p> <p>You need to include the database driver corresponding to the database for the WSO2 Open Banking Business Intelligence server to communicate with the database. The WSO2 Open Banking Business Intelligence is an OSGi-based product. Therefore, when you integrate third-party products such as Oracle and MS SQL with WSO2 OB BI, you need to check whether the libraries you need to add are OSGi based. If they are not, you need to convert them to OSGi bundles before adding them to the <code>&lt;WSO2_OB_BI_200_HOME&gt;/lib</code> directory. To convert the jar files to OSGi bundles, follow the steps below.</p> <ol> <li> <p>Download the non-OSGi jar for the required third party product, and save it in a preferred directory in your machine.</p> </li> <li> <p>Go to the <code>&lt;WSO2_OB_BI_200_HOME&gt;/bin</code> directory. Run the command given below to generate the converted file in the <code>&lt;WSO2_OB_BI_200_HOME&gt;/lib</code> directory.</p> </li> </ol> <pre><code>./jartobundle.sh &lt;PATH_TO_NON-OSGi_JAR&gt; ../lib\n</code></pre> <ol> <li>Go to the <code>&lt;WSO2_OB_BI_200_HOME&gt;/bin</code> directory and start the Worker and Dashboard profiles.</li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#application-attribute-changes","title":"Application Attribute Changes","text":"<p>To upgrade the application attribute data :</p> <ol> <li>Go to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/dbscripts/finance/apimgt/migration_1.5.0_to_2.0.0</code> directory. </li> <li>Execute the relevant database script against the <code>WSO2AM_DB</code> database. </li> <li>Restart the WSO2 API Management module.</li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-berlin/#republish-the-apis","title":"Republish the APIs","text":"<p>To use the APIs published in WSO2 Open Banking 1.5.0 setup, you need to redeploy these APIs to reflect the changes from the sequence files.</p> <p>Before you begin:</p> <ol> <li>Open the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/api_templates/velocity_template.xml</code> file.</li> <li>Update the <code>&lt;IAM_HOSTNAME&gt;</code> placeholder with the hostname of your Identity and Access Management server.</li> <li>Restart the API Management server.</li> </ol> <ol> <li> <p>Sign in to the WSO2 API Publisher at <code>https://&lt;WSO2_OB_APIM_200_HOST&gt;:9443/publisher</code>.</p> </li> <li> <p>Navigate to the API listing page, and select the API which you want to edit.</p> </li> <li> <p>Go to Runtime Configurations using the left menu panel.</p> <p></p> </li> <li> <p>Click the edit button under Request &gt; Message Mediation.</p> </li> <li> <p>Now, select the Custom Policy option.</p> </li> <li> <p>Upload the relevant in-sequence file from the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/finance/apis/berlin-group.org</code> directory.</p> </li> <li> <p>Scroll down and click SAVE.</p> </li> <li> <p>Go to Lifecycle using the left menu panel.</p> <p></p> </li> <li> <p>Redeploy the API by clicking the Redeploy button.</p> <p></p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/","title":"Migration resources for WSO2 Open Banking 1.5.0 to 2.0.0 - Upgrade the solution for UK","text":"<p>Note</p> <p>This README documentation is for internal use only.</p> <p>This directory contains the migration documentation and resources for WSO2 Open Banking 1.5.0 to 2.0.0 - UK.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migration-documentation","title":"Migration Documentation","text":"<p>Listed below are the documentation required for WSO2 Open Banking 1.5.0 to 2.0.0 - UK:</p> <ul> <li>Upgrading WSO2 Open Banking from 1.5.0 to 2.0.0 - Introduction: upgrade-wso2-open-banking-1.5.0-to-2.0.0-introduction.md</li> <li>Map XML Configurations to TOML Configurations: map-xml-to-toml.md</li> <li>Upgrade WSO2 Open Banking from 1.5.0 to 2.0.0 for the UK: upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk.md</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migration-resources","title":"Migration Resources","text":"<ul> <li> <p>All the migration resources required for WSO2 Open Banking 1.5.0 to 2.0.0 - UK can be found here.</p> </li> <li> <p>Additionally, all the images used in the documentation can be found here.</p> </li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/","title":"Upgrade WSO2 Open Banking from 1.5.0 to 2.0.0 for the UK","text":"<p>Note</p> <p>Before you upgrade the solution from 1.5.0 to 2.0.0, it is mandatory to convert all your applications to Dynamic Client Registration v3.2. For more details, refer to Converting Applications into Dynamic Client Registration v3.2.</p> <p>This page explains the following:</p> <ul> <li>Databases and Synapse configurations</li> <li>Disable Registry versioning</li> <li>Migrating Keystores</li> <li>Migrating custom components</li> <li>Upgrading Open Banking Identity and Access Management module (Open Banking Key Manager)</li> <li>Upgrading Open Banking API Manager</li> <li>Upgrading Open Banking Business Intelligence</li> <li>Application Attribute Changes</li> <li>Republish the APIs</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#databases-and-synapse-configurations","title":"Databases and Synapse configurations","text":"<ul> <li> <p>Take a backup of the existing database used by WSO2 Open Banking 1.5.0. This backup is necessary in case the migration causes issues in the existing database.</p> </li> <li> <p>Take a backup of the existing synapse configurations in WSO2 Open Banking 1.5.0. The synapse configuration is available in the <code>&lt;WSO2_OB_APIM_HOME&gt;/repository/deployment/server/synapse-configs</code> directory.</p> </li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#disable-registry-versioning","title":"Disable Registry versioning","text":"<p>When you have enabled versioning for Registry properties and if they are updated frequently, it can lead to an unnecessary growth in the Registry related database tables. To avoid this, WSO2 Open Banking 2.0 disables versioning by default.</p> <p>If you enabled Registry versioning for your WSO2 Open Banking 1.5.0 setup, you need to disable it before upgrading the solution. The required steps are as follows:</p> <ol> <li> <p>Open the <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/conf/registry.xml</code> and <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/conf/registry.xml</code> files.</p> </li> <li> <p>Locate the following properties in both files:</p> </li> </ol> <pre><code>&lt;versioningProperties&gt;true&lt;/versioningProperties&gt;\n&lt;versioningComments&gt;true&lt;/versioningComments&gt;\n&lt;versioningTags&gt;true&lt;/versioningTags&gt;\n&lt;versioningRatings&gt;true&lt;/versioningRatings&gt;\n</code></pre> <ol> <li>If the above configurations are <code>true</code>,</li> </ol> <p>a. Get the relevant versioning script provided by the WSO2 team.</p> <p>b. According to your database type, run the relevant script against the following databases.</p> <pre><code>- `openbank_govdb`\n- `openbank_am_configdb`\n- `openbank_iskm_configdb`\n\n  &gt;**Note**\n  &gt;\n  &gt;If the above versioning configurations are already set as `false` you should not run the database scripts.\n</code></pre>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migrating-keystores","title":"Migrating Keystores","text":"<p>Copy the keystores (<code>.jks</code> files) from WSO2 Open Banking 1.5.0 to WSO2 Open Banking 2.0.0.</p> Copy From Copy To <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_BI_150_HOME&gt;/repository/resources/security</code> <code>&lt;WSO2_OB_BI_200_HOME&gt;/repository/resources/security</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migrating-custom-components","title":"Migrating custom components","text":"<p>Changed internal API context paths</p> <p>The context paths of the following internal APIs have changed. If you have used the following for any custom implementation, update them accordingly:</p> Context path in 1.5.0 Context path in 2.0.0 <code>/consent</code> <code>/api/openbanking/consent-mgt</code> <code>/dynamicclientregistration</code> <code>/api/openbanking/dynamic-client-registration</code> <code>/eventnotifications</code> <code>/api/openbanking/event-notifications</code> <code>/openbanking</code> <code>/api/openbanking/backend-uk</code> <p>Renamed JARs and packages</p> <p>If you have used the following jar files/ packages for any custom implementations, update them as follows:</p> Package name in 1.5.0 Package name in 2.0.0 <code>com.wso2.finance.periodical.updater</code> <code>com.wso2.finance.open.banking.periodical.updater</code> <code>com.wso2.finance.status.validater</code> <code>com.wso2.finance.open.banking.status.validater</code> <code>eidas-cert-validator</code> <code>com.wso2.finance.open.banking.eidas.cert.validator</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#wso2-open-banking-identity-and-access-management-module","title":"WSO2 Open Banking Identity and Access Management module","text":"<p>The WSO2 Key Manager is referred to as the WSO2 Open Banking Identity and Access Management module in WSO2 Open Banking 2.0.0. This module is based on WSO2 Identity Server 5.10.0, which includes major upgrades to the main component and WSO2 Carbon Kernel. Any customized OSGi bundle added to Identity Server needs to be recompiled with the new dependency versions relevant to Identity Server 5.10.0.</p> <p>To recompile the custom OSGi bundles:</p> <ol> <li>Obtain the source codes of the custom OSGi component</li> <li>Update the dependency versions in the relevant POM files according to Identity Server 5.10.0</li> <li>Compile the project</li> </ol> <p>Make sure to recompile the following and place them in the WSO2 Open Banking 2.0.0 solution:</p> Content Recompile Copy to Custom OSGI bundles (manually added files) <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/dropins</code> Custom JAR files (manually added files) <code>&lt;WSO2_OB_KM_150_HOME&gt;/repository/components/libs</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/libs</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#wso2-open-banking-api-management-module","title":"WSO2 Open Banking API Management module","text":"<p>You need to copy the custom OSGi bundles and custom JAR files (manually added by you to the solution) as follows:</p> Content Copy from Copy to Custom OSGI bundles(manually added files) <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/components/dropins</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/dropins</code> Custom JAR files (manually added files) <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/components/lib</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/lib</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#upgrading-open-banking-identity-and-access-management-module-open-banking-key-manager","title":"Upgrading Open Banking Identity and Access Management module (Open Banking Key Manager)","text":"<p>WSO2 Open Banking 2.0.0 refers to WSO2 Key Manager as the WSO2 Open Banking Identity and Access Management module. This section guides you on how to upgrade from Identity Key Manager 1.5.0 to Identity and Access Management 2.0.0.</p> <p>This section explains the following:</p> <ul> <li>Setting Up Database</li> <li>Configuring the <code>deployment.toml</code> file</li> <li>Migrating secondary user stores</li> <li>Migrating Databases</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#setting-up-database","title":"Setting Up Database","text":"<p>Copy the relevant JDBC driver to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/lib</code> directory.</p> <p>Note</p> <p>If you are using an Oracle database make sure the users have the CREATE PROCEDURE privilege before proceeding.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#configuring-the-deploymenttoml-file","title":"Configuring the <code>deployment.toml</code> file","text":"<p>WSO2 Open Banking 2.0.0 introduces a new configuration model where the users have all the product configurations in a single configuration file, namely <code>deployment.toml</code>.</p> <ol> <li> <p>Copy the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/resources/finance/scripts/wso2-obiam-conf/deployement/uk/deployment.toml</code> file to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/conf/</code> directory and replace the existing file.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/conf/deployment.toml</code> file and update the datasource configurations for the following databases:</p> </li> <li> <p>User Store</p> </li> <li>Registry database(s)</li> <li>API Manager database</li> <li> <p>Open Banking Database</p> </li> <li> <p>Datasource configurations in 1.5.0 maps with the 2.0.0 new configuration model as follows:</p> </li> </ol> Key Manager 1.5.0 Identity and Access Management 2.0.0 <code>WSO2AM_DB</code> <code>apim_db</code> <code>WSO2CONFIG_DB</code> <code>config</code> <code>WSO2REG_DB</code> <code>shared_db</code> <code>WSO2UM_DB</code> <code>WSO2UM_DB</code> <code>WSO2_OPEN_BANKING_DB</code> <code>open_banking_database</code> <p>Given below are sample configurations for each database type:</p> <p>MySQL</p> <pre><code>config.url = \"jdbc:mysql://localhost:3306/openbank_apimgtdb?autoReconnect=true&amp;useSSL=false\"\nconfig.username = \"root\"\nconfig.password = \"root\"\nconfig.driver = \"com.mysql.jdbc.Driver\"\n</code></pre> <p>MSSQL</p> <pre><code>config.url = \"jdbc:sqlserver://localhost:1433;databaseName=openbank_apimgtdb;encrypt=false\"\nconfig.username = \"sa\"\nconfig.password = \"Root\"\nconfig.driver = \"com.microsoft.sqlserver.jdbc.SQLServerDriver\"\n</code></pre> <p>Oracle</p> <pre><code>config.url = \"jdbc:oracle:thin:@localhost:1521:ORCLCDB\"\nconfig.username = \"C##uk_ob_apimgtdb\"\nconfig.password = \"wso2carbon\"\nconfig.driver = \"oracle.jdbc.driver.OracleDriver\"\n</code></pre> <ol> <li>The <code>deployment.toml</code> file contains placeholder, update them with the hostnames of the following servers:</li> </ol> Placeholder Server <code>IAM_HOSTNAME</code> Identity and Access Management <code>APIM_HOSTNAME</code> API Management <code>ANALYTICS_HOSTNAME</code> Open Banking Business Intelligence"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migrating-secondary-user-stores","title":"Migrating secondary user stores","text":"<p>If you have created any secondary user stores for Open Banking 1.5.0, copy the content to the new setup as follows:</p> Content Copy from Copy to Secondary user stores <code>&lt;WSO2_OB_IAM_150_HOME&gt;/repository/deployment/server/userstores</code> <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/deployment/server/userstores</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migrating-databases","title":"Migrating Databases","text":"<ol> <li> <p>Get the migration client (<code>wso2is-migration-x.x.x.zip</code>) provided by the WSO2 team.</p> </li> <li> <p>Extract it into a local directory. The directory where the <code>wso2is-migration-x.x.x.zip</code> is extracted is referred to as `. <li> <p>Copy the <code>&lt;IS_MIGRATION_TOOL_HOME&gt;/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file into the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/dropins</code> directory.</p> </li> <li> <p>Copy the <code>&lt;IS_MIGRATION_TOOL_HOME&gt;/migration-resources</code> directory to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;</code> root directory.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/migration-resources/migration-config.yaml</code> file:</p> </li> <li> <p>Make sure versions are as follows:</p> </li> <pre><code>migrationEnable: \"true\"\ncurrentVersion: \"5.7.0\"\nmigrateVersion: \"5.10.0\"\n</code></pre> <ol> <li>Remove the following configurations under the version: \"5.8.0\" tag:</li> </ol> <pre><code>-\n    name: \"UMAPermissionTicketSchemaMigrator\"\n    order: 3\n    parameters:\n    location: \"step2\"\n    schema: \"uma\"\n</code></pre> <ol> <li>Remove the following configurations under the version: \"5.10.0\" tag:</li> </ol> <pre><code>-\n    name: \"MigrationValidator\"\n    order: 2\n-\n    name: \"SchemaMigrator\"\n    order: 5\n    parameters:\n    location: \"step2\"\n    schema: \"identity\"\n</code></pre> <ol> <li>Update the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/conf/deployment.toml</code> by configuring the previous user store.</li> </ol> <pre><code>[user_store]\ntype = \"database\"\n#type = \"database_unique_id\"\n#class = \"org.wso2.carbon.user.core.jdbc.UniqueIDJDBCUserStoreManager\"\n</code></pre> <ol> <li>Start the WSO2 Open Banking Identity Access Management 2.0.0 server with the migration client.</li> </ol> <p>Use the commands given below:</p> <p>Linux/Unix or macOS</p> <pre><code>sh wso2server.sh -Dmigrate -Dcomponent=identity\n</code></pre> <p>Windows</p> <pre><code>wso2server.bat -Dmigrate -Dcomponent=identity\n</code></pre> <ol> <li> <p>Once the migration client execution is completed, stop the server.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/repository/components/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/migration-resources</code> directory.</p> </li> <li> <p>Restart the Identity and Access Management server now.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#upgrading-open-banking-api-manager","title":"Upgrading Open Banking API Manager","text":"<p>This section guides you on how to upgrade WSO2 Open Banking API Management 1.5.0 to 2.0.0.</p> <p>This section explains the following:</p> <ul> <li>Setting Up Database</li> <li>Configuring the deployment.toml file</li> <li>Moving Synapse configurations</li> <li>Migrating Databases</li> <li>Migrating API Manager artifacts</li> <li>Reindexing Registry artifacts</li> </ul>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#setting-up-database_1","title":"Setting Up Database","text":"<p>Copy the relevant JDBC driver to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/lib</code> directory.</p> <p>Note</p> <p>If you are using an Oracle database make sure the users have the CREATE PROCEDURE privilege before proceeding.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#configuring-the-deploymenttoml-file_1","title":"Configuring the <code>deployment.toml</code> file","text":"<p>WSO2 Open Banking 2.0.0 introduces a new configuration model where the users have all the product configurations in a single configuration file, namely deployment.toml.</p> <ol> <li> <p>Copy the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/finance/scripts/wso2-obam-conf/deployement/uk/deployment.toml</code> file to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/conf/</code> directory and replace the existing one.</p> </li> <li> <p>Open the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/conf/deployment.toml</code> file and update the datasource configurations for the following databases:</p> </li> <li> <p>User Store</p> </li> <li>Registry database(s)</li> <li>API Manager database</li> <li> <p>Open Banking Database</p> </li> <li> <p>Datasource configurations in 1.5.0 maps with the 2.0.0 new configuration model as follows:</p> </li> </ol> API Manager 1.5.0 API Manager 2.0.0 <code>WSO2AM_DB</code> <code>apim_db</code> <code>WSO2CONFIG_DB</code> <code>config</code> <code>WSO2REG_DB</code> <code>shared_db</code> <code>WSO2UM_DB</code> <code>WSO2UM_DB</code> <code>WSO2AM_STATS_DB</code> <code>WSO2AM_STATS_DB</code> <code>WSO2_OPEN_BANKING_DB</code> <code>open_banking_database</code> <p>Given below are sample configurations for each database type:</p> <p>MySQL</p> <pre><code>config.url = \"jdbc:mysql://localhost:3306/openbank_apimgtdb?autoReconnect=true&amp;useSSL=false\"\nconfig.username = \"root\"\nconfig.password = \"root\"\nconfig.driver = \"com.mysql.jdbc.Driver\"\n</code></pre> <p>MSSQL</p> <pre><code>config.url = \"jdbc:sqlserver://localhost:1433;databaseName=openbank_apimgtdb;encrypt=false\"\nconfig.username = \"sa\"\nconfig.password = \"Root\"\nconfig.driver = \"com.microsoft.sqlserver.jdbc.SQLServerDriver\"\n</code></pre> <p>Oracle</p> <pre><code>config.url = \"jdbc:oracle:thin:@localhost:1521:ORCLCDB\"\nconfig.username = \"C##uk_ob_apimgtdb\"\nconfig.password = \"wso2carbon\"\nconfig.driver = \"oracle.jdbc.driver.OracleDriver\"\n</code></pre> <ol> <li>The <code>deployment.toml</code> file contains placeholder, update them with the hostnames of the following servers:</li> </ol> Placeholder Server <code>IAM_HOSTNAME</code> Identity and Access Management <code>APIM_HOSTNAME</code> API Management <code>ANALYTICS_HOSTNAME</code> Open Banking Business Intelligence"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#moving-synapse-configurations","title":"Moving Synapse configurations","text":"<ol> <li> <p>Stop all WSO2 API Manager server instances that are running.</p> </li> <li> <p>Move the following content to WSO2 Open Banking 2.0.0:</p> </li> </ol> <p>Warning</p> <p>When replacing the Synapse configurations, do not replace the following, as they contain API Management module version 2.0.0. - <code>/api/_RevokeAPI_.xml</code> - <code>/sequences/_cors_request_handler_.xml</code> - <code>/sequences/main.xml</code></p> Content Copy from Copy to Synapse super tenant configurations <code>&lt;WSO2_OB_APIM_150_HOME&gt;/repository/deployment/server/ synapse-configs/default</code> <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/deployment/server/synapse-configs/default</code>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migrating-databases_1","title":"Migrating Databases","text":"<ol> <li> <p>To migrate data into WSO2 Open Banking API Manager 2.0.0, execute the relevant database script against the <code>WSO2AM_DB</code> database.</p> </li> <li> <p>Get the API Manager migration database scripts provided by the WSO2 team.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migrating-api-manager-artifacts","title":"Migrating API Manager artifacts","text":"<ol> <li> <p>Migration resources:</p> </li> <li> <p>Get the API Manager migration resources (<code>migration-resources.zip</code>) provided by the WSO2 team.</p> </li> <li> <p>Extract the downloaded <code>migration-resources.zip</code>.</p> </li> <li> <p>Copy the extracted <code>migration-resources</code> directory to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;</code> directory.</p> </li> <li> <p>Migration client:</p> </li> <li> <p>Get the API Manager migration client (<code>org.wso2.carbon.apimgt.migrate.client-3.1.0-6.jar</code>) provided by the WSO2 team.</p> </li> <li> <p>Copy the provided <code>org.wso2.carbon.apimgt.migrate.client-3.1.0-6.jar</code> to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/dropins</code> directory.</p> </li> <li> <p>Start the API Management server with the migration client. Use the commands below:</p> </li> </ol> <p>Linux/Unix or macOS</p> <pre><code>sh wso2server.sh -DmigrateFromVersion=2.6.0\n</code></pre> <p>Windows</p> <pre><code>wso2server.bat -DmigrateFromVersion=2.6.0\n</code></pre> <ol> <li> <p>Once the migration client execution is completed, stop the server.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/components/dropins/org.wso2.carbon.apimgt.migrate.client-3.1.0-6.jar</code> file.</p> </li> <li> <p>Remove the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/migration-resources</code> directory.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#reindexing-registry-artifacts","title":"Reindexing Registry artifacts","text":"<p>Note</p> <p>Make sure to run the migration client before reindexing registry artifacts.</p> <ol> <li> <p>Get the relevant registry indexing script provided by the WSO2 team.</p> </li> <li> <p>According to your database type, run the relevant script against the following databases.</p> </li> <li> <p><code>openbank_govdb</code></p> </li> <li><code>openbank_am_configdb</code></li> <li> <p><code>openbank_iskm_configdb</code></p> </li> <li> <p>Add the following configurations to the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/conf/deployment.toml</code> file.</p> </li> </ol> <pre><code>[indexing]\nre_indexing= 1\n</code></pre> <ol> <li> <p>Backup the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/solr</code> directory if it exists, then delete it.</p> </li> <li> <p>Start the API Management server.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#upgrading-open-banking-business-intelligence","title":"Upgrading Open Banking Business Intelligence","text":"<p>This section explains how to upgrade from Open Banking Business Intelligence 1.5.0 to 2.0.0.</p> <p>Warning</p> <p>These steps are only required if you have configured Open Banking Business Intelligence in your existing deployment.</p>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migrating-the-analytics-database","title":"Migrating the Analytics database","text":"<ol> <li> <p>Get the relevant analytics migration script provided by the WSO2 team.</p> </li> <li> <p>Execute the downloaded database scripts against the <code>APIM_ANALYTICS_DB</code> database.</p> </li> <li> <p>After a WUM update for Open Banking Business Intelligence 1.5.0, the data types and field-names of certain database tables were changed. It is important to reflect these changes in your databases before the upgrading process.</p> </li> <li> <p>Get the relevant updating analytics database scripts provided by the WSO2 team.</p> </li> <li>Update the scripts by replacing the <code>&lt;APIM_ANALYTICS_DB&gt;</code> placeholder with the hostname of your database server.</li> <li>Execute the relevant script, according to your database type to perform these changes if they are not already available.</li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#migrating-configurations","title":"Migrating configurations","text":"<ol> <li> <p>Open the following configuration files and update them by configuring the databases that you have used in Open Banking Business Intelligence 1.5.0.</p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/conf/dashboard/deployment.yaml</code></p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/conf/worker/deployment.yaml</code></p> </li> <li> <p>Open the following siddhi files and replace the <code>&lt;ANALYTICS_HOSTNAME&gt;</code> placeholder with the hostname of your Open Banking Business Intelligence server.</p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/deployment/siddhi-files/TRAAccountValidationApp.siddhi</code></p> </li> <li> <p><code>&lt;WSO2_OB_BI_200_HOME&gt;/deployment/siddhi-files/TRAPaymentValidationApp.siddhi</code></p> </li> <li> <p>Place the relevant JDBC driver as an OSGi bundle in the <code>&lt;WSO2_OB_BI_200_HOME&gt;/lib</code> director.</p> </li> </ol> <p>For Oracle or MSSQL database drivers:</p> <p>You need to include the database driver corresponding to the database for the WSO2 Open Banking Business Intelligence server to communicate with the database. The WSO2 Open Banking Business Intelligence is an OSGi-based product. Therefore, when you integrate third-party products such as Oracle and MS SQL with WSO2 OB BI, you need to check whether the libraries you need to add are OSGi based. If they are not, you need to convert them to OSGi bundles before adding them to the <code>&lt;WSO2_OB_BI_200_HOME&gt;/lib</code> directory. To convert the jar files to OSGi bundles, follow the steps below.</p> <ol> <li> <p>Download the non-OSGi jar for the required third party product, and save it in a preferred directory on your machine.</p> </li> <li> <p>Go to the <code>&lt;WSO2_OB_BI_200_HOME&gt;/bin</code> directory. Run the command given below to generate the converted file in the <code>&lt;WSO2_OB_BI_200_HOME&gt;/lib</code> directory.</p> </li> </ol> <pre><code>./jartobundle.sh &lt;PATH_TO_NON-OSGi_JAR&gt; ../lib\n</code></pre> <ol> <li>Go to the <code>&lt;WSO2_OB_BI_200_HOME&gt;/bin</code> directory and start the Worker and Dashboard profiles.</li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#application-attribute-changes","title":"Application Attribute Changes","text":"<p>To upgrade the application attribute data:</p> <ol> <li>Go to the <code>&lt;WSO2_OB_IAM_200_HOME&gt;/dbscripts/finance/apimgt/migration_1.5.0_to_2.0.0</code> directory. </li> <li>Execute the relevant database script against the <code>WSO2AM_DB</code> database. </li> <li>Restart the WSO2 API Management module.</li> </ol>"},{"location":"open-banking/migration-docs/ob-1.5.0-to-2.0.0/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/upgrade-wso2-open-banking-1.5.0-to-2.0.0-for-uk/#republish-the-apis","title":"Republish the APIs","text":"<p>To use the APIs published in WSO2 Open Banking 1.5.0 setup, you need to redeploy these APIs to reflect the changes from the sequence files.</p> <p>Before you begin:</p> <ul> <li>Open the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/api_templates/velocity_template.xml</code> file.</li> <li>Update the <code>&lt;IAM_HOSTNAME&gt;</code> placeholder with the hostname of your Identity and Access Management server.</li> <li>Restart the API Management server.</li> </ul> <ol> <li> <p>Sign in to the WSO2 API Publisher at <code>https://&lt;WSO2_OB_APIM_200_HOST&gt;:9443/publisher</code>.</p> </li> <li> <p>Navigate to the API listing page, and select the API which you want to edit.</p> </li> <li> <p>Go to Runtime Configurations using the left menu panel.</p> <p></p> </li> <li> <p>Click the edit button under Request &gt; Message Mediation.</p> </li> <li> <p>Now, select the Custom Policy option.</p> </li> <li> <p>Upload the relevant in-sequence file from the <code>&lt;WSO2_OB_APIM_200_HOME&gt;/repository/resources/finance/apis/openbanking.org.uk</code> directory.</p> </li> <li> <p>Scroll down and click SAVE.</p> </li> <li> <p>Go to Lifecycle using the left menu panel.</p> <p></p> </li> <li> <p>Redeploy the API by clicking the Redeploy button.</p> <p></p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/","title":"Migration resources for WSO2 Open Banking 2.0.0 to 3.0.0 - Berlin Toolkit 1.0.0","text":"<p>This directory contains the migration documentation and resources for WSO2 Open Banking 2.0.0 to 3.0.0 - Berlin Toolkit 1.0.0.</p> <p>The migration resources required for WSO2 Open Banking 2.0.0 to 3.0.0 - Berlin Toolkit 1.0.0 can be found here.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/modifications-after-migration/","title":"Modifications After Migration","text":"<p>This page explains the modifications that need to be performed after the upgrade/migration process.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/modifications-after-migration/#open-banking-internal-scopes","title":"Open Banking Internal Scopes","text":"<p>Configure open banking internal scopes as follows:</p> <ol> <li>Open the <code>&lt;IS_HOME&gt;/repository/conf/deployment.toml</code> file.</li> <li>Update the allowed scopes according the sample below:</li> </ol> <pre><code>[oauth]\nallowed_scopes = [\"consent.*\", \"OB_.*\"]\n</code></pre>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/modifications-after-migration/#two-factor-authentication","title":"Two-Factor Authentication","text":"<p>If the migrated Service Provider is configured to use two-factor authentication:</p> <ol> <li>Update the <code>&lt;IS_HOME&gt;/repository/conf/common.auth.script.js</code> file with the following steps:</li> </ol> <p><pre><code>var psuChannel = 'Online Banking';\n\nvar onLoginRequest = function(context) {\n    publishAuthData(context, \"AuthenticationAttempted\", {'psuChannel': psuChannel});\n    executeStep(1, {\n        onSuccess: function (context) {\n            Log.info(\"Authentication Successful\");\n            publishAuthData(context, \"AuthenticationSuccessful\", {'psuChannel': psuChannel});\n            executeStep(2, {\n                onSuccess: function (context) {\n                    Log.info(\"Authentication Successful\");\n                    publishAuthData(context, \"AuthenticationSuccessful\", {'psuChannel': psuChannel});\n                },\n                onFail: function (context) {\n                    Log.info(\"Authentication Failed\");\n                    publishAuthData(context, \"AuthenticationFailed\", {'psuChannel': psuChannel});\n                }\n            });\n        },\n        onFail: function (context) {\n            Log.info(\"Authentication Failed\");\n            publishAuthData(context, \"AuthenticationFailed\", {'psuChannel': psuChannel});\n        }\n    });\n};\n</code></pre> 2. Update the common auth script of the existing service provider.</p> <ol> <li>Go to the Identity Server Management Console <code>https://&lt;IS_HOST&gt;:9446/carbon</code> and log in as the admin user. </li> <li>Go to Service Providers &gt; List.</li> <li>Edit the relevant Service Provider. </li> <li>Go to Local &amp; Outbound Authentication Configuration &gt; Advanced Configuration. </li> <li> <p>Replace the existing adaptive authentication script under the Script Based Adaptive Authentication section with the following:</p> <p><pre><code>var psuChannel = 'Online Banking';\n\nvar onLoginRequest = function(context) {\n    publishAuthData(context, \"AuthenticationAttempted\", {'psuChannel': psuChannel});\n    executeStep(1, {\n        onSuccess: function (context) {\n            Log.info(\"Authentication Successful\");\n            publishAuthData(context, \"AuthenticationSuccessful\", {'psuChannel': psuChannel});\n            executeStep(2, {\n                onSuccess: function (context) {\n                    Log.info(\"Authentication Successful\");\n                    publishAuthData(context, \"AuthenticationSuccessful\", {'psuChannel': psuChannel});\n                },\n                onFail: function (context) {\n                    Log.info(\"Authentication Failed\");\n                    publishAuthData(context, \"AuthenticationFailed\", {'psuChannel': psuChannel});\n                }\n            });\n        },\n        onFail: function (context) {\n            Log.info(\"Authentication Failed\");\n            publishAuthData(context, \"AuthenticationFailed\", {'psuChannel': psuChannel});\n        }\n    });\n}; \n</code></pre>    6. Click Update.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/open-banking-data-migration/","title":"Open Banking Data Migration","text":"<p>Before you begin:</p> <p>Back up all the databases before performing the migration.</p> <ol> <li>To create the required database tables:<ul> <li>Run the relevant SQL script in the <code>&lt;IS_HOME&gt;/dbscripts/open-banking/consent</code> directory against   the <code>openbank_openbankingdb</code> database.</li> </ul> </li> <li>Get the WSO2 Open Banking Migration Client Tool v1.0.0 (<code>wso2-openbanking-migration-1.0.0.zip</code>) provided by the WSO2 team.</li> <li>Copy the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources</code> directory to <code>&lt;IS_HOME&gt;</code>.</li> <li>Copy the <code>wso2-openbanking-migration-1.0.0/dropins/com.wso2.openbanking.migration-1.0.0.jar</code> file to <code>&lt;IS_HOME&gt;/repository/components/dropins</code>.</li> <li>Open the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/migration-config.yaml</code> file and    set the <code>migrationEnable</code> property to <code>true</code>.</li> <li> <p>Start the Identity Server with the following command:</p> <pre><code>   sh wso2server.sh -DobMigrationSpec=BG\n</code></pre> </li> <li> <p>Stop the server.</p> <p>Warning</p> <p>If a failure occurred during the migration process, delete all the migrated data from the tables that      were generated during migration.</p> </li> <li> <p>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/com.wso2.openbanking.migration-1.0.0.jar</code> file.</p> </li> <li>Remove the <code>&lt;IS_HOME&gt;/openbanking-migration-resources</code> directory.</li> <li>Start the Identity Server and API Manager servers.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-api-manager-320/","title":"Upgrading to WSO2 API Manager 3.2.0","text":"<p>WSO2 API Manager 3.1.0 is a base product of WSO2 Open Banking 2.0. This section instructs you on how to upgrade the API Manager to 3.2.0, which is a prerequisite for upgrading to API Manager 4.0.</p> <ol> <li> <p>Get the Upgrading WSO2 IS as Key Manager documentation provided by the WSO2 team.</p> </li> <li> <p>Upgrade IS as Key Manager 5.10.0 for API Manager 3.2.0 by following the provided documentation.</p> </li> <li> <p>Get the Upgrading API Manager from 3.1.0 to 3.2.0 documentation provided by the WSO2 team.</p> </li> <li> <p>Upgrade API Manager from 3.1.0 to 3.2.0 by following the provided documentation.</p> <p>Note</p> <p>In the above documentation, under Step 1 - Migrate the API Manager configurations,     skip steps 6,7,8, and 9 as we are only trying to migrate the databases at this level.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-api-manager-400/","title":"Upgrading to WSO2 API Manager 4.0.0","text":"<p>Before you begin:</p> <p>Make sure you have upgraded your API Manager to 3.2.0 according to the Upgrading to WSO2 API Manager 3.2.0 (<code>upgrading-wso2-api-manager-320.md</code>) documentation.</p> <ol> <li>Download and install the WSO2 API Manager 4.0.0 distribution from here. </li> <li>Extract the downloaded archive file. This document refers to the root folder of the extracted file as <code>&lt;APIM_HOME&gt;</code>.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-api-manager-400/#set-up-open-banking-accelerator-and-berlin-toolkit-for-api-manager","title":"Set up Open Banking Accelerator and Berlin Toolkit for API Manager","text":"<ol> <li>Download the <code>wso2-obam-accelerator-3.0.0.zip</code> file and extract it to the <code>&lt;APIM_HOME&gt;</code> directory. </li> <li>Download the latest updates for <code>wso2-obam-accelerator-3.0.0</code>. For more information, see Getting WSO2 Updates.</li> <li> <p>Go to the <code>&lt;APIM_HOME&gt;/&lt;APIM_ACCELERATOR_HOME&gt;/bin</code> directory and run the merge.sh script.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Download the <code>wso2-obam-toolkit-berlin-1.0.0.zip</code> file and extract it to the <code>&lt;APIM_HOME&gt;</code> directory. </p> </li> <li>Download the latest updates for <code>wso2-obam-toolkit-berlin-1.0.0</code>. For more information, see Getting WSO2 Updates.</li> <li> <p>Go to the <code>&lt;APIM_HOME&gt;/&lt;APIM_TOOLKIT_HOME&gt;/bin</code> directory and run the merge.sh script.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Replace the existing <code>deployment.toml</code> file in the API Manager as follows:</p> <ul> <li>Go to the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources</code> directory.</li> <li>Rename <code>wso2am-4.0.0-deployment-berlin.toml</code> to <code>deployment.toml</code>.</li> <li>Copy the <code>deployment.toml</code> file to the <code>&lt;APIM_HOME&gt;/repository/conf</code> directory and replace the existing file.</li> </ul> </li> <li> <p>Open the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related       properties accordingly. </p> <ul> <li>When configuring database related properties, point to your existing Open Banking 2.0 databases.</li> </ul> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-api-manager-400/#upgrading-to-wso2-api-manager-400_1","title":"Upgrading to WSO2 API Manager 4.0.0","text":"<p>Before you begin:</p> <p>Once the Identity Server 5.11.0 is configured as the Resident Key Manager, start the Identity Server 5.11.0.</p> <ol> <li> <p>Start the WSO2 API Manager 4.0.0 server and create a Custom Key Manager by following the    Configuring IS as Key Manager documentation.</p> </li> <li> <p>Do not copy any other Key Manager specific configurations from the previous API Manager version to the latest  one that points to the Identity Server.</p> </li> <li> <p>Get the Upgrading API Manager from 3.2.0 to 4.0.0 documentation provided by the WSO2 team.</p> </li> <li> <p>Upgrade your API Manager from 3.2.0 to 4.0.0 by following the provided documentation.</p> </li> </ol> <p>Note</p> <p>When following the above-mentioned documentation:</p> <ol> <li> <p>You can skip the steps 1,2, and 3 under Step 1 - Migrate the API Manager configurations.</p> </li> <li> <p>Modify the following configurations in the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file before starting the migration.</p> </li> </ol> <pre><code>[[apim.gateway.environment]]\nname = \"Production and Sandbox\"\n[apim.sync_runtime_artifacts.gateway]\ngateway_labels =[\"Production and Sandbox\", \"Default\"]\n</code></pre> <ol> <li>In Step 2 - Upgrade API Manager to 4.0.0, skip the steps 3 and 5.</li> </ol> <ol> <li>Start the API Manager server.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-api-manager-400/#replace-custom-mediation-policies","title":"Replace Custom Mediation Policies","text":"<p>This section explains how to replace the Custom Mediation Policy of each API with the latest Mediation Policy.</p> <ol> <li>Go to the API Publisher at <code>https://&lt;APIM_HOST&gt;:9443/publisher</code>.</li> <li>Select the respective API.</li> <li>Go to API Configurations &gt; Runtime.</li> <li>Click the Edit button under Request &gt; Message Mediation and remove the existing Custom Mediation Policy.</li> <li>Upload the relevant insequence file from the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources/apis</code> directory  and click Select.</li> <li>Scroll down and click SAVE.</li> <li>Go to Deployments using the left menu pane.</li> <li>Click Deploy New Version.</li> <li>Select the API Gateway type and Deploy.</li> <li>Repeat these steps for all the APIs. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-api-manager-400/#enable-schema-validation","title":"Enable Schema Validation","text":"<p>This section explains how to enable Schema Validation for APIs.</p> <ol> <li>Go to the API Publisher at <code>https://&lt;APIM_HOST&gt;:9443/publisher</code>.</li> <li>Select the respective API.</li> <li>Go to API Configurations &gt; Runtime.</li> <li>Enable Schema Validation.</li> <li>Scroll down and click SAVE.</li> <li>Go to Deployments using the left menu pane.</li> <li>Click Deploy New Version.</li> <li>Select the API Gateway type and Deploy.</li> <li>Repeat these steps for all the APIs. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-api-manager-400/#update-workflow-extensions","title":"Update Workflow-Extensions","text":"<ol> <li>Go to the Management Console <code>https://&lt;APIM_HOST&gt;:9443/carbon</code> and log in as the admin user. </li> <li>Select Resources &gt; Browse in the left pane.  </li> <li>Locate the <code>/_system/governance/apimgt/applicationdata/workflow-extensions.xml</code> file. </li> <li>Get the <code>workflow.txt</code> provided by the WSO2 team.</li> <li>Click Edit as text and replace the content with the content you received. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-api-manager-400/#update-api-life-cycle","title":"Update API Life Cycle","text":"<ol> <li>Go to the Management Console <code>https://&lt;APIM_HOST&gt;:9443/carbon</code> and log in as the admin user. </li> <li>Select Extensions &gt; Lifecycles.  </li> <li>Click the View/Edit button for APILifeCycle. </li> <li>Get the <code>lifecycle.txt</code> provided by the WSO2 team.</li> <li>Replace the Lifecycle Source with the content you received.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-api-manager-400/#update-identity-provider-entity-id","title":"Update Identity Provider Entity ID","text":"<ol> <li>Go to Identity Server Management Console <code>https://&lt;IS_HOST&gt;:9446/carbon</code> and log in as the admin user.</li> <li>Select Identity Providers &gt; Resident. </li> <li>Go to Inbound Authentication Configuration &gt; OAuth2/OpenID Connect Configuration.</li> <li> <p>Update the Identity Provider Entity ID to the following:</p> <pre><code>https://&lt;IS_HOST&gt;:9446/oauth2/token\n</code></pre> <p></p> </li> <li> <p>Click Update.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-identity-server/","title":"Upgrading to WSO2 Identity Sever 5.11.0","text":""},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-identity-server/#set-up-is-5110-as-key-manager-for-api-manager-400","title":"Set up IS 5.11.0 as Key Manager for API Manager 4.0.0","text":"<ol> <li>Download and install the WSO2 Identity Server 5.11.0 distribution from here.</li> <li>Extract the downloaded archive file. This document refers to the root folder of the extracted file as <code>&lt;IS_HOME&gt;</code>.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-identity-server/#set-up-open-banking-accelerator-and-berlin-toolkit-for-identity-sever","title":"Set up Open Banking Accelerator and Berlin Toolkit for Identity Sever","text":"<ol> <li>Download the <code>wso2-obiam-accelerator-3.0.0.zip</code> file and extract it to the <code>&lt;IS_HOME&gt;</code> directory.</li> <li>Download the latest updates for <code>wso2-obiam-accelerator-3.0.0</code>. For more information, see Getting WSO2 Updates.</li> <li> <p>Go to the <code>&lt;IS_HOME&gt;/&lt;IS_ACCELERATOR_HOME&gt;/bin</code> directory and run the merge.sh script.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Download the <code>wso2-obiam-toolkit-berlin-1.0.0.zip</code> file and extract it to the <code>&lt;IS_HOME&gt;</code> directory.</p> </li> <li>Download the latest updates for <code>wso2-obiam-toolkit-berlin-1.0.0</code>. For more information, see Getting WSO2 Updates.</li> <li> <p>Go to the <code>&lt;IS_HOME&gt;/&lt;IS_TOOLKIT_HOME&gt;/bin</code> directory and run the merge.sh script.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>To configure the Identity Server with the API Manager, download WSO2 IS Connector.</p> </li> <li> <p>Copy the following files to the given directory paths:</p> File to copy Location to <code>wso2is-extensions-1.2.10/dropins/wso2is.key.manager.core-1.2.10.jar</code> <code>&lt;IS_HOME&gt;/repository/components/dropins</code> <code>wso2is-extensions-1.2.10/dropins/wso2is.notification.event.handlers-1.2.10.jar</code> <code>&lt;IS_HOME&gt;/repository/components/dropins</code> <code>wso2is-extensions-1.2.10/webapps/keymanager-operations.war</code> <code>&lt;IS_HOME&gt;/repository/deployment/server/webapps</code> </li> <li> <p>Replace the existing <code>deployment.toml</code> file in the Identity Server as follows:</p> <ul> <li>Go to the <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/repository/resources</code> directory.</li> <li>Rename <code>wso2is-5.11.0-deployment-berlin.toml</code> to <code>deployment.toml</code>.</li> <li>Copy the <code>deployment.toml</code> file to the <code>&lt;IS_HOME&gt;/repository/conf</code> directory to replace the existing file.</li> </ul> </li> <li> <p>Open the <code>&lt;IS_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related     properties accordingly.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-identity-server/#migrate-to-wso2-identity-sever-5110","title":"Migrate to WSO2 Identity Sever 5.11.0","text":"<ol> <li> <p>Get the Upgrading WSO2 IS as Key Manager to 5.11.0 documentation provided by the WSO2 team.</p> </li> <li> <p>Follow Step B - Migrate IS from 5.10.0 to 5.11.0 and upgrade your WSO2 Identity Server.</p> </li> <li> <p>Get the WSO2 Identity Server Migrating to 5.11.0 documentation provided by the WSO2 team.</p> </li> <li> <p>Follow the provided documentation to upgrade your current IS as KM 5.10.0 distribution to IS 5.11.0.</p> <p>Note</p> <p>In the above documentation, under Steps to migrate to 5.11.0,</p> <ol> <li>Skip steps 1,2, and 4.</li> <li>Do not copy the API Manager - Key Manager specific configurations from          <code>&lt;OLD_IS_KM_HOME&gt;/repository/conf/api-manager.xml</code> of the previous IS as KM version to IS 5.11.0.</li> <li>Follow the step 10, only if you have enabled Symmetric Key Encryption in the previous IS as KM setup.          If not, skip step 10.</li> <li>Before executing the IS migration client according to Step 11, remove the following entries from          <code>migration-config.yaml</code> in the migration-resources directory:</li> </ol> <pre><code>- version: \"5.10.0\"\nmigratorConfigs:\n-\nname: \"MigrationValidator\"\norder: 2\n-\nname: \"SchemaMigrator\"\norder: 5\nparameters:\nlocation: \"step2\"\nschema: \"identity\"\n-\nname: \"TenantPortalMigrator\"\norder: 11\n</code></pre> <p>Warning</p> <p>Based on the number of records in the identity tables, the identity component migration will take a considerable time.     Do not stop the server during the migration process. Wait until the migration process finishes completely and the server gets started.</p> </li> <li> <p>After successfully completing the migration, stop the server and remove the following directories and files.</p> <ul> <li>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file.</li> <li>Remove the <code>&lt;IS_HOME&gt;/migration-resources</code> directory.</li> </ul> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/berlin-toolkit-1.0.0/upgrading-wso2-open-banking-200-to-300/","title":"Upgrading WSO2 Open Banking from 2.0.0 to 3.0.0","text":"<p>This section guides on how to upgrade your WSO2 Open Banking 2.0.0 setup to WSO2 Open Banking 3.0.0 (Accelerator Model). </p> <p>Note</p> <p>WSO2 Open Banking 2.0.0 is based on the WSO2 API Manager 3.1.0 and WSO2 Identity Server 5.10.0 products.</p> <p>Tip</p> <p>In your Open Banking 2.0.0 database, verify the column size of the following:</p> Database Table Column Data type Size <code>openbank_apimgtdb</code> <code>SP_METADATA</code> <code>VALUE</code> <code>VARCHAR</code> 4096 <ul> <li> <p>If the column size is less than 4096, execute the following command against the <code>SP_METADATA</code> table:</p> <pre><code>ALTER TABLE SP_METADATA MODIFY VALUE VARCHAR(4096); \n</code></pre> </li> </ul> <p>The diagram below explains the flow of upgrading the WSO2 Open Banking solution:</p> <p></p> <p>Follow the topics below in the given order:</p> <ol> <li>Upgrading to WSO2 API Manager 3.2.0 (<code>upgrading-wso2-api-manager-320.md</code>)</li> <li>Upgrading to WSO2 Identity Sever 5.11.0 (<code>upgrading-wso2-identity-server.md</code>)</li> <li>Upgrading API Manager 3.2.0 to 4.0.0 (<code>upgrading-wso2-api-manager-400.md</code>)</li> <li>Migrating Open Banking Data (<code>open-banking-data-migration.md</code>)</li> <li>Configuring After Migration (<code>modifications-after-migration.md</code>)</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/","title":"Migration resources for WSO2 Open Banking 2.0.0 to 3.0.0 - CDS Toolkit 1.0.0","text":"<p>Note</p> <p>This README documentation is for internal use only.</p> <p>This directory contains the migration documentation and resources for WSO2 Open Banking 2.0.0 to 3.0.0 - CDS Toolkit 1.0.0.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/#migration-documentation","title":"Migration Documentation","text":"<ul> <li> <p>The documentation for WSO2 Open Banking 2.0.0 to 3.0.0 - CDS Toolkit 1.0.0 can be accessed here.</p> </li> <li> <p>The reference documentation mentioned in the WSO2 Open Banking 2.0.0 to 3.0.0 - CDS Toolkit 1.0.0 documentation can be accessed via the following links:</p> </li> </ul> Base Product Documentation File Name with GIT Location Upgrading WSO2 IS as Key Manager to 6.0.0 <code>Upgrade IS KM 5.10.0 to IS 6.0.0 for APIM 3.1.0 to 4.2.0.md</code> Migrating to 6.1.0 <code>migrate-to-610.md</code> Upgrading API Manager from 3.1.0 to 4.2.0 <code>upgrading-from-310-to-420.md</code>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/#migration-resources","title":"Migration Resources","text":"Migration Resource File Name with GIT Location Identity component migration resource <code>wso2is-migration-1.1.163.zip</code> APIM 4.2.0 DB Scripts <code>db-scripts/upgrading-from-310-to-420/</code> Latest APIM migration tool <code>wso2am-migration-4.2.0.54.zip</code> Latest OB migration tool <code>wso2-openbanking-migration-1.0.2.zip</code> <code>org.wso2.carbon.identity.oauth.uma.server.feature/resources/dbscripts/' folder | [</code>org.wso2.carbon.identity.oauth.uma.server.feature/resources/dbscripts/`](https://github.com/wso2-extensions/identity-oauth-uma/tree/master/features/org.wso2.carbon.identity.oauth.uma.server.feature/resources/dbscripts) <ul> <li>Additionally, all the images used in the documentation can be found here.</li> </ul>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/","title":"Upgrading WSO2 Open Banking from 2.0.0 to 3.0.0","text":"<p>This documentation guides you on how to upgrade your WSO2 Open Banking 2.0.0 for the AU setup to WSO2 Open Banking 3.0.0 (Accelerator Model) CDS Toolkit 1.0.0 with WSO2 API Manager 4.2.0 and WSO2 Identity Server 6.1.0 as the base packs.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#overview","title":"Overview","text":"<p>WSO2 Open Banking solution runs on top of WSO2 Identity Server and WSO2 API Manager which are referred to as base products.</p> <p>Given below is the product compatibility matrix for the WSO2 Open Banking solution. This matrix outlines the compatibility between the versions of WSO2 Open Banking solutions involved in this migration and the latest version of the base products they support.</p> WSO2 Open Banking Version Supported WSO2 Identity Server Version Supported WSO2 API Manager Version 2.0.0 5.10.0 3.1.0 3.0.0 6.1.0 (Latest) 4.2.0 (Latest)"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#prerequisites","title":"Prerequisites","text":"<p>We assume that you already have an existing WSO2 Open Banking 2.0.0 solution for the AU with some sample data populated in the databases. This setup will be referred to as the pre-migration setup in this documentation.</p> <p>Important:</p> <ul> <li> <p>In order to upgrade your existing Open Banking solution to the latest version, you need to upgrade the base products (WSO2 Identity Server and WSO2 API Manager) to the latest supported version as well.</p> </li> <li> <p>In addition to the base product migration, you need to configure WSO2 Identity Server as Key Manager. The Key Manager handles all clients, security, and access token-related operations. So you need to configure WSO2 Identity Server as Key Manager in each WSO2 API Manager migration.</p> </li> </ul> <p>The following link explains the flow of upgrading the WSO2 Open Banking solution:</p> <p></p> <p>Given below are the steps you need to follow to upgrade your WSO2 Open Banking 2.0.0 for the AU setup to WSO2 Open Banking 3.0.0 - CDS Toolkit 1.0.0:</p> <ol> <li>Prepare for Migration</li> <li>Upgrade IS as KM 5.10.0 to IS as KM 6.1.0</li> <li>Upgrade WSO2 API Manager 3.1.0 to WSO2 API Manager 4.2.0</li> <li>Migrate Open Banking Data</li> <li>Migrate Reporting Data (Optional)</li> <li>Post-Migration Configurations</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#1-prepare-for-migration","title":"1. Prepare for Migration","text":"<p>In the following section, you will be setting up Open Banking Accelerator and CDS Toolkit for Identity Server and API Manager.</p> <ol> <li> <p>Download WSO2 Identity Server 6.1.0 from here and extract the folder. This extracted folder will be referred to as <code>&lt;IS_HOME&gt;</code> in this document.</p> </li> <li> <p>Download WSO2 API Manager 4.2.0 from here and extract the folder. This extracted folder will be referred to as <code>&lt;APIM_HOME&gt;</code> in this document.</p> </li> <li> <p>Get WSO2 Open Banking Accelerator 3.0.0 provided by the WSO2 team.</p> </li> <li> <p>Extract the WSO2 Open Banking Accelerator zip files. Get the following accelerators and extract them.</p> <ul> <li><code>wso2-obiam-accelerator-3.0.0</code></li> <li><code>wso2-obam-accelerator-3.0.0</code></li> </ul> </li> <li> <p>Get WSO2 Open Banking CDS Toolkit 1.0.0 provided by the WSO2 team. Get the following toolkits and extract them.</p> <ul> <li><code>wso2-obiam-toolkit-cds-1.0.0</code></li> <li><code>wso2-obam-toolkit-cds-1.0.0</code></li> </ul> </li> <li> <p>This document uses the following placeholders to refer to the following products:</p> </li> </ol> Product Placeholder WSO2 Identity Server 6.1.0 <code>&lt;IS_HOME&gt;</code> WSO2 API Manager 4.2.0 <code>&lt;APIM_HOME&gt;</code> WSO2 Open Banking Identity Server Accelerator 3.0.0 <code>&lt;OB_IS_ACCELERATOR_HOME&gt;</code> WSO2 Open Banking API Manager Accelerator 3.0.0 <code>&lt;OB_APIM_ACCELERATOR_HOME&gt;</code> WSO2 Open Banking Identity Server CDS Toolkit 1.0.0 <code>&lt;OB_IS_TOOLKIT_HOME&gt;</code> WSO2 Open Banking API Manager CDS Toolkit 1.0.0 <code>&lt;OB_APIM_TOOLKIT_HOME&gt;</code> <ol> <li> <p>Follow the Getting WSO2 Updates documentation and update the base products, accelerators, and toolkits using relevant scripts.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_ACCELERATOR_HOME&gt;/bin</code> and <code>&lt;IS_HOME&gt;/&lt;OB_IS_ACCELERATOR_HOME&gt;/bin</code> respectively to copy the Open Banking artifacts into the base product packs.</p> </li> </ol> <pre><code>./merge.sh\n</code></pre> <ol> <li>Run the <code>merge.sh</code> script in <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/bin</code> and <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/bin</code> respectively:</li> </ol> <pre><code>./merge.sh\n</code></pre> <ol> <li> <p>Add the relevant modifications to the <code>wso2is-6.0.0-deployment-cds.toml</code> file in the <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/repository/resources</code> directory.</p> </li> <li> <p>Rename <code>wso2is-6.0.0-deployment-cds.toml</code> to <code>deployment.toml</code>.</p> </li> <li> <p>Copy the <code>deployment.toml</code> file to the <code>&lt;IS_HOME&gt;/repository/conf</code> directory to replace the existing file.</p> </li> <li> <p>Open the <code>&lt;IS_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related     properties accordingly.</p> <ul> <li>When configuring database related properties, ensure that the datasource are pointing to the existing databases.</li> </ul> </li> <li> <p>Add the relevant modifications to the <code>wso2am-4.2.0-deployment-cds.toml</code> file in the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources</code> directory.</p> </li> <li> <p>Rename <code>wso2am-4.2.0-deployment-cds.toml</code> to <code>deployment.toml</code>.</p> </li> <li> <p>Copy the <code>deployment.toml</code> file to the <code>&lt;APIM_HOME&gt;/repository/conf</code> directory to replace the existing file.</p> </li> <li> <p>Open the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related     properties accordingly.</p> <ul> <li>When configuring database related properties, ensure that the datasource are pointing to the existing databases.</li> </ul> </li> <li> <p>Add the following configurations needed for Identity Server 6.1.0 and API Manager 4.2.0.</p> <ol> <li> <p>Add the following configuration in Identity Server 6.1.0 <code>deployment.toml</code> file.</p> <pre><code>[application_mgt]\nenable_role_validation = true\n</code></pre> </li> <li> <p>Add the following configuration in the <code>deployment.toml</code> file of API Manager 4.2.0 after the configurations done under <code>[open_banking.dcr]</code>. Note that the version must be specified as <code>v3</code> for API Manager 4.2.0.</p> <pre><code>[open_banking.dcr.apim_rest_endpoints]\napp_creation = \"api/am/devportal/v3/applications\"\nkey_generation = \"api/am/devportal/v3/applications/application-id/map-keys\"\napi_retrieve = \"api/am/devportal/v3/apis\"\napi_subscribe = \"api/am/devportal/v3/subscriptions/multiple\"\nretrieve_subscribe=\"api/am/devportal/v3/subscriptions\u201d\n</code></pre> </li> </ol> </li> <li> <p>Now all the Open Banking related artifacts and configurations are included in the base packs.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#2-migrating-wso2-is-as-key-manager-from-identity-server-5100-to-610","title":"2. Migrating WSO2 IS as Key Manager from Identity Server 5.10.0 to 6.1.0","text":"<ol> <li> <p>Get the Upgrading WSO2 IS as Key Manager to 6.0.0 documentation provided by the WSO2 team. This will instruct you to upgrade your IS as Key Manager 5.10.0 to IS 6.1.0. Take note of the essential points provided below while following the instructions in the documentation.</p> <p>Important</p> <p>Please note that the information contained in the above-mentioned documentation is also applicable for WSO2 Identity Server 6.1.0.</p> </li> <li> <p>Follow Step A: Upgrade IS as Key Manager 5.10.0 to IS 6.0.0 in the above-mentioned documentation. Follow all the steps and make sure to perform the necessary steps mentioned below:</p> <p>Note</p> <p>Refer to the Migrating to 6.1.0 documentation when following the step 5 under Step 1: Migrate the IS as KM configurations.</p> </li> <li> <p>When following Step 2: Migrate the IS as KM Resources, download the WSO2 IS Connector for API Manager 4.2.0 from here. Extract the folder (<code>wso2is-extensions-1.6.8.zip</code>) and get the relevant JAR files and WAR file. </p> </li> <li> <p>When following Step 3: Migrate the IS as KM Components, use the <code>wso2is-migration-1.1.163.zip</code> folder as the identity component migration resource.</p> </li> <li> <p>Following the Step A: Upgrade IS as Key Manager 5.10.0 to IS 6.0.0 in the above-mentioned documentation with the above instructions, concludes the WSO2 IS as Key Manager from Identity Server 5.10.0 to 6.1.0 migration.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#3-migrating-wso2-api-manager-from-310-to-420","title":"3. Migrating WSO2 API Manager from 3.1.0 to 4.2.0","text":"<ol> <li> <p>Get the Upgrading API Manager from 3.1.0 to 4.2.0 documentation provided by the WSO2 team. This will instruct you to upgrade your API-M environment from 3.1.0 to 4.2.0. Take note of the essential points provided below while following the instructions in the documentation.</p> </li> <li> <p>When following Step 1: Migrate the API Manager Configurations, use the DB scripts (<code>db-scripts/upgrading-from-310-to-420</code>) provided by the WSO2 team.</p> </li> <li> <p>Skip the guidelines under Step 3: Migrate the Identity Components as you have already done this in Step 3 of Step A: Upgrade IS as Key Manager 5.10.0 to IS 6.0.0.</p> </li> <li> <p>When following Step 4: Migrate the API Manager Components, use the provided API Manager Migration resources (<code>wso2am-migration-4.2.0.54.zip</code>).</p> </li> <li> <p>Before starting the API Manager 4.2.0 server for the first time in Step 6 under Step 6: Restart the WSO2 API Manager 4.2.0 Server, make sure you have already started WSO2 Identity Server 6.1.0.</p> </li> <li> <p>Following the above-mentioned documentation with the above instructions, concludes the WSO2 API Manager migration.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#4-migrating-open-banking-data","title":"4. Migrating Open Banking Data","text":"<p>In this step, you will transfer your Open Banking data from your existing Open Banking 2.0.0 platform to the new WSO2 Open Banking 3.0.0 platform. This process includes moving important information such as customer accounts, transactions, and permissions.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#prerequisites_1","title":"Prerequisites","text":"<p>Make sure the following:</p> <ul> <li> <p>In your Open Banking 2.0.0 database, check the column size of the following:</p> Database Table Column Data type Size <code>openbank_apimgtdb</code> <code>SP_METADATA</code> <code>VALUE</code> <code>VARCHAR</code> 4096 <ul> <li> <p>If the column size is less than 4096, execute the following command against the <code>SP_METADATA</code> table:</p> <pre><code>ALTER TABLE SP_METADATA MODIFY VALUE VARCHAR(4096);\n</code></pre> </li> </ul> </li> </ul> <p>Note: </p> <p>Please read the following section before proceeding with the migration:</p> <ul> <li> <p>The <code>SPMigrator</code> migrates the Dynamic Client Registration related data.</p> <pre><code> ```\n - \n   name: \"SPMigrator\"\n   spec: \"AU\"\n   order: 3\n   parameters:\n     schema: \"ob\"\n ```\n</code></pre> </li> <li> <p>The default <code>common-auth-script.js</code> (the adaptive authentication script of service provider applications) that was provided in Open Banking 2.0.0 is not supported in Open Banking 3.0.0. Therefore, the migration tool is configured to automatically update the <code>common-auth-script</code> file of all service provider apps to the format which is supported in Open Banking 3.0.0.</p> <ul> <li>This default script supported in Open Banking 3.0.0 is available in the <code>common-auth-script.js</code> file placed at the <code>openbanking-migration-resources/common-auth-scripts/AU</code> directory.</li> <li>Make sure to change the content of the file appropriately if you have used a customized adaptive authentication script for all the service provider applications in your Open Banking 2.0.0 setup and that logic will not be supported directly in Open Banking 3.0.0.</li> <li>If you can assure that the customized adaptive authentication logic used in Open Banking 2.0.0 is supported in Open Banking 3.0.0 without any modifications, you can skip this step during the migration by setting the <code>commonAuthScriptUpdateEnable</code> parameter under the relevant spec version of the <code>SPMigrator</code> to <code>false</code> in <code>migration-config.yaml</code>. Otherwise, it should be <code>true</code>.       <code>-      name: \"SPMigrator\"      spec: \"AU\"      order: 3      parameters:      schema: \"ob\"      commonAuthScriptUpdateEnable: \"false\"</code></li> <li>If you have configured different adaptive authentication logics for service provider applications, the migration-tool does not support the automated update.</li> <li>In this case also, the <code>commonAuthScriptUpdateEnable</code> parameter under the relevant spec version of the SPMigrator should be set to false in <code>migration-config.yaml</code> before starting the OB-migration process as shown above.</li> </ul> <p>Note:</p> <ul> <li>If any update is required, the adaptive authentication logic of each service provider should be updated manually based on your customizations via the carbon console once the entire migration process is concluded.</li> </ul> </li> <li> <p>If Business Nominated Representative feature was enabled in OB2, Uncomment and enable the following migrator,</p> </li> </ul> <p><pre><code>    name: \"BNRMigrator\"\n    spec: \"AU\"\n    order: 1\n    parameters:\n    schema: \"ob\"\n</code></pre> - If Disclosure Options Management feature was enabled in OB2, Uncomment and enable the following migrator,</p> <p><pre><code>    name: \"DOMSMigrator\"\n    spec: \"AU\"\n    order: 1\n    parameters:\n    schema: \"ob\"\n</code></pre> - If Secondary User feature was enabled in OB2, Uncomment and enable the following migrator.</p> <pre><code>    name: \"SecondaryUsersMigrator\"\n    spec: \"AU\"\n    order: 1\n    parameters:\n    schema: \"ob\"\n    ceasing_secondary_user_sharing_enabled: \"false\u201d\n</code></pre> <p>Note:</p> <ul> <li>If the <code>Ceasing Secondary User Sharing</code> feature was enabled in the OB2, make the <code>ceasing_secondary_user_sharing_enabled</code> field to <code>true</code>. Otherwise, need to set it to <code>false</code>.</li> </ul> <p><pre><code>- To migrate consent history data, enable the \"consent_history_enabled\" parameter.\n</code></pre>     name: \"ConsentMigrator\"     spec: \"AU\"     order: 1     parameters:     schema: \"ob\"     token_expiry_time: \"84600\"     expired_custom_status: \"Expired\"     consent_history_enabled: \"true\" ```</p> <p>Before you begin:</p> <p>Back up all the databases before performing the migration.</p> <ol> <li> <p>To create the required database tables:</p> <ul> <li>Run the relevant SQL script in the <code>&lt;IS_HOME&gt;/dbscripts/open-banking/consent</code> directory against the <code>openbank_openbankingdb</code> database.</li> <li>Create <code>OB_ACCOUNT_METADATA</code> table by running the SQL script in the <code>&lt;IS_HOME&gt;/dbscripts/open-banking/account-metadata</code> directory against the <code>openbank_openbankingdb</code> database. </li> <li>Create <code>OB_CONSENT_HISTORY</code> table by running the SQL script in the <code>&lt;IS_HOME&gt;/dbscripts/open-banking/consent-history</code> directory against the <code>openbank_openbankingdb</code> database.</li> </ul> </li> <li> <p>Open the <code>&lt;AM_HOME&gt;/repository/conf/deployment.toml</code> file and set the following config to false before executing the OB migration tool.     <pre><code>   [open_banking_cds.metrics.aggregation_job]\n    enabled = false\n</code></pre></p> </li> <li> <p>Get the WSO2 Open Banking Migration Client Tool v1.0.2 (<code>wso2-openbanking-migration-1.0.2.zip</code>) provided by the WSO2 team.</p> </li> <li> <p>Copy the <code>wso2-openbanking-migration-1.0.2/openbanking-migration-resources</code> directory to <code>&lt;IS_HOME&gt;</code>.</p> </li> <li> <p>Copy the <code>wso2-openbanking-migration-1.0.2/dropins/com.wso2.openbanking.migration-1.0.2.jar</code> file to <code>&lt;IS_HOME&gt;/repository/components/dropins</code>.</p> </li> <li> <p>Open the <code>wso2-openbanking-migration-1.0.2/openbanking-migration-resources/migration-config.yaml</code> file and set the <code>migrationEnable</code> property to <code>true</code>.</p> </li> <li> <p>Start the Identity Server with the following command:</p> <pre><code>   sh wso2server.sh -DobMigrationSpec=AU\n</code></pre> </li> <li> <p>Stop the server.</p> </li> </ol> <p>Warning</p> <p>If a failure occurred during the migration process, delete all the migrated data from the tables that    were generated during migration.</p> <ol> <li> <p>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/com.wso2.openbanking.migration-1.0.2.jar</code> file.</p> </li> <li> <p>Remove the <code>&lt;IS_HOME&gt;/openbanking-migration-resources</code> directory.</p> </li> <li> <p>Open the <code>&lt;AM_HOME&gt;/repository/conf/deployment.toml</code> file and set the following config to true before executing the OB migration tool.    <pre><code>   [open_banking_cds.metrics.aggregation_job]\n    enabled = true\n</code></pre></p> </li> <li> <p>Start the Identity Server and API Manager servers.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#5-migrating-reporting-data","title":"5. Migrating Reporting Data","text":"<p>In this step, you will transfer data from your existing reporting system to the new WSO2 Open Banking platform. This will involve moving data related to reports, dashboards, and visualizations.</p> <p>Note:</p> <p>Follow this step only if you are using WSO2 Open Banking Business Intelligence with your existing WSO2 Open Banking 2.0.0 setup.</p> <ol> <li>Stop the WSO2 Open Banking Business Intelligence 2.0.0 server if it is running.</li> <li>Download and install the WSO2 Streaming Integrator 4.2.0 distribution from here.</li> <li>Backup your <code>openbank_ob_reporting_statsdb</code> and <code>openbank_ob_reporting_summarizeddb</code> databases of your WSO2 Open Banking Business Intelligence 2.0.0 setup.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#set-up-open-banking-accelerator-and-cds-toolkit-for-streaming-integrator","title":"Set up Open Banking Accelerator and CDS Toolkit for Streaming Integrator","text":"<p>Set up WSO2 Open Banking Business Intelligence Accelerator and WSO2 Open Banking Business Intelligence CDS Toolkit as follows:</p> <p>Note</p> <ul> <li><code>&lt;SI_HOME&gt;</code> refers to the root directory of WSO2 Streaming Integrator.</li> <li><code>&lt;OB_BI_ACCELERATOR_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence Accelerator.</li> <li><code>&lt;OB_BI_TOOLKIT_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence CDS Toolkit.</li> </ul> <ol> <li> <p>Copy and extract the <code>wso2-obbi-accelerator-3.0.0.zip</code> accelerator file in the root directory of WSO2 Streaming    Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/bin</code>:</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Copy and extract the <code>wso2-obbi-toolkit-cds-1.0.0.zip</code> toolkit file in the root directory of WSO2 Streaming    Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_TOOLKIT_HOME&gt;/bin</code>.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Replace the existing <code>deployment.yaml</code> file in the Streaming Integrator as follows:</p> <ul> <li>Go to the <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/repository/resources</code> directory.</li> <li>Rename <code>wso2si-4.2.0-deployment.yaml</code> to <code>deployment.yaml</code>.</li> <li>Copy the <code>deployment.yaml</code> file to the <code>&lt;SI_HOME&gt;/conf/server</code> directory to replace the existing file.</li> </ul> </li> <li> <p>Open the <code>&lt;SI_HOME&gt;/conf/server/deployment.toml</code> file, and configure the hostnames and databases related    properties accordingly.</p> <ul> <li>When configuring database-related properties, point to your existing Open Banking 2.0 databases.</li> </ul> </li> <li> <p>Exchange the public certificates between servers.</p> </li> </ol> <p>Follow the steps given below:</p> <p>a. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and export the public certificate of the Streaming    Integrator:</p> <p><code>shell     &gt;   keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeySI.pem     &gt;</code></p> <p>b. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and import the public certificate of the    Streaming Integrator to the truststore of the Identity Server:</p> <p><code>shell     &gt;   keytool -import -alias wso2 -file publickeySI.pem -keystore client-truststore.jks -storepass wso2carbon     &gt;</code></p> <p>c. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and export the public certificate of the    Identity Server:</p> <p><code>shell     &gt;    keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeyIAM.pem     &gt;</code></p> <p>d. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and import the public certificate of the Identity    Server to the truststore of the Streaming Integrator:</p> <p><code>shell     &gt;    keytool -import -alias wso2 -file publickeyIAM.pem -keystore client-truststore.jks -storepass wso2carbon     &gt;</code></p> <p>e. Go to the <code>&lt;APIM_HOME&gt;/repository/resources/security</code> directory and repeat step b,c, and d.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#upgrade-to-wso2-streaming-integrator-420","title":"Upgrade to WSO2 Streaming Integrator 4.2.0","text":"<p>To migrate the reporting data and tables from the Open Banking 2.0 setup to 3.0.</p> <ol> <li> <p>Go to the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/reporting-migration-scripts/au</code> directory.</p> </li> <li> <p>Open the <code>configure.properties</code> file and configure the following.</p> <ul> <li>Databases-related properties and database names</li> <li>Access token encryption configurations</li> </ul> </li> </ol> <p>Tip</p> <p>Your existing access token encryption configurations are available in    the <code>&lt;WSO2_OB2_IAM_HOME&gt;/repository/conf/finance/open-banking.xml</code> file,    under the <code>&lt;BIServer&gt; &lt;Reporting&gt; &lt;TokenEncryption&gt;</code> tags.</p> <ol> <li> <p>Run the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/reporting-migration-scripts/au/migrate.sh</code>    script.</p> <pre><code>./migrate.sh\n</code></pre> </li> </ol> <p>Only for Oracle Databases:</p> <p>Execute the <code>openbanking-migration-resources/reporting-migration-scripts/au/reporting-oracle-2.0.0_to_3.0.0_runtime.sql</code>    script in against your <code>openbank_ob_reporting_statsdb</code> database.</p> <p>Tip</p> <p>You may drop the following tables of <code>OB_REPORTING_DB</code> as they are not required for Open Banking 3.0:</p> <pre><code>- `AUTHENTICATION_RAW_DATA`\n- `CDS_SESSION_RAW_DATA`\n- `ACCESS_TOKEN_RAW_DATA`\n- `APP_REG_RAW_DATA`\n</code></pre> <ol> <li>Start the Streaming Integrator and try out publishing data.    For more information, see Try Out Data Publishing.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#6-post-migration-scripts","title":"6. Post-Migration Scripts","text":"<p>This section includes the database scripts that need to be performed after the upgrade/migration process.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#update-sp-metadata","title":"Update SP Metadata","text":"<ol> <li> <p>Stop the servers if running.</p> </li> <li> <p>Locate the <code>sp_metadata_migration_mysql.sql</code> script found here </p> </li> <li> <p>Run the script against the migrated <code>openbank_apimgtdb</code> database.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-cds-toolkit-1.0.0/#7-post-migration-configurations","title":"7. Post-Migration Configurations","text":"<p>This section explains the modifications that need to be performed after the upgrade/migration process.</p> <ol> <li> <p>Stop the servers if running.</p> </li> <li> <p>Remove <code>com.wso2.openbanking.migration-1.0.2.jar</code> from the <code>IS_HOME&gt;/repository/components/dropins</code> folder.</p> </li> <li> <p>Remove <code>openbanking-migration-resources</code> folder from the <code>&lt;IS_HOME&gt;/repository/components/dropins</code> folder.</p> </li> </ol> <p>Note:</p> <p>Make sure to perform the following changes before starting with the Open Banking flows: 1. Redeploy the APIs with the relevant insequence files supported in WSO2 Open Banking 3.0.0 CDS Toolkit 1.0.0.   - <code>Dynamic Client Registration API</code>     - Update the insequence file and the Production/Sandbox Endpoints of DCR API with cds toolkit's DCR insequence file and endpoint by referring to the steps in dynamic-client-registration-flow   - <code>Administration API</code>     - Update the insequence file and the Production/Sandbox Endpoints of Admin API with cds toolkit's CDSAdminAPI insequence file and endpoint by referring to the steps in admin-api   - <code>Account and Transaction flow</code>     - Update the API Definition of the ConsumerDataStandards API with cds toolkit's CDSBanking swagger file in //repository/resources/apis/consumerdatastandards.org.au/CDSBanking/1.25.0/consumer-data-standards-banking-1.25.0.yaml directory.     - Update the insequence file and the Production/Sandbox Endpoints of CDSBanking with cds toolkit's CDSBanking insequence file and endpoint by referring to the steps in account-and-transaction-flow   - <code>CDR Arrangement Revocation API</code>     - Remove the current insequence file in CDR Arrangement Revocation API.     - Use the left menu panel and go to API Configurations &gt; Endpoints.     - Add <code>HTTP/REST Endpoint</code> and set URL as <code>https://&lt;IS_HOST&gt;:9446/api/openbanking/cds-arrangement-revocation/arrangements</code> by referring to the steps in arrangement-revocation-api-flow <ul> <li>Follow the Quick Start Guide - Tryout Flow of the CDS Toolkit 1.0.0 documentation for a sample tryout flow of the Account and Transaction API.</li> <li>Navigate to the Tryout section in the CDS Toolkit 1.0.0 documentation for more information on API flows.</li> </ul> <ol> <li> <p>Sign in to the Identity Server Management Console.</p> </li> <li> <p>Navigate to Identity Providers \u2192 Resident \u2192 Inbound Authentication Configuration \u2192 OAuth2/OpenID Connect Configuration \u2192 Identity Provider Entity ID.</p> </li> <li> <p>Change the Identity Provider Entity ID value from <code>https://localhost:8243/token</code> to <code>https://localhost:9446/oauth2/token</code>.</p> </li> <li> <p>If the <code>urn:ietf:params:oauth:grant-type:uma-ticket</code> grant type was used in the Open Banking 2 setup, follow the below instructions to configure User Managed Access with WSO2 Identity Server:</p> <p>WSO2 Identity Server (WSO2 IS) supports the UMA 2.0 protocol, which allows a resource owner to easily share resources with other requesting parties. To use UMA with WSO2 Identity Server, first you need to configure the authenticator with WSO2 Identity Server.</p> <p>You can either download the UMA artifacts or build the authenticator from the source code by following the steps given below. 1. Download the UMA connector and other required artifacts from the WSO2 store. 2. Add the following <code>.jar</code> files to the <code>&lt;IS_HOME&gt;/repository/components/dropins</code> directory.</p> <p><code>org.wso2.carbon.identity.oauth.uma.common-x.x.x.jar   org.wso2.carbon.identity.oauth.uma.grant-x.x.x.jar   org.wso2.carbon.identity.oauth.uma.permission.service-x.x.x.jar   org.wso2.carbon.identity.oauth.uma.resource.service-x.x.x.jar   org.wso2.carbon.identity.oauth.uma.xacml.extension-x.x.x.jar</code> 3. Add the following <code>.war</code> files to the <code>&lt;IS_HOME&gt;/repository/deployment/server/webapps</code> directory.  <code>api#identity#oauth2#uma#resourceregistration#v_.war    api#identity#oauth2#uma#permission#v_.war</code> 4. Get the <code>org.wso2.carbon.identity.oauth.uma.server.feature/resources/dbscripts/</code> folder provided by the WSO2 team. 5. Run the corresponding db script from the above-mentioned folder.  6. Start/ Restart WSO2 Identity Server. 7. Stop WSO2 Identity Server if it is already running. 8. Add the below configuration to the <code>&lt;IS-Home&gt;/repository/conf/deployment.toml</code> file.  ```toml  [[oauth.custom_grant_type]]  name = \"urn:ietf:params:oauth:grant-type:uma-ticket\"  grant_handler = \"org.wso2.carbon.identity.oauth.uma.grant.UMA2GrantHandler\"  grant_validator = \"org.wso2.carbon.identity.oauth.uma.grant.GrantValidator\"</p> <p>[[resource.access_control]]  context = \"(.)/api/identity/oauth2/uma/resourceregistration/v1.0/(.)\"  secure = \"true\"  http_method = \"all\"</p> <p>[[resource.access_control]]  context = \"(.)/api/identity/oauth2/uma/permission/v1.0/(.)\"  secure = \"true\"  http_method = \"all\"    ``` 8. Start/ Restart WSO2 Identity Server.</p> </li> <li> <p>If the throttling policy configured, update the siddhi query and context according to the query provided in    wso2ob-apim-toolkit-cds-1.0.0.53-SNAPSHOT/repository/resources/throttling-policies folder.</p> </li> <li> <p>Follow the Step 2: Configure IS as Key Manager to configure IS as Key Manager.</p> </li> </ol> <p>Note:</p> <p>Make sure to update the AM_APPLICATION_KEY_MAPPING table after creating the Key Manager.  : 1. Retrieve UUID of the Key Manager. For that go to the Key Manager overview and locate the alphanumeric string at the end of the URL.</p> <p><code>https://&lt;AM_HOST&gt;:9443/admin/settings/key-managers/&lt;UUID&gt;</code> 2. Update Key Manager UUID in AM_APPLICATION_KEY_MAPPING table.</p> <p><code>UPDATE AM_APPLICATION_KEY_MAPPING SET KEY_MANAGER  = '&lt;UUID&gt;' WHERE APPLICATION_ID IN (SELECT APPLICATION_ID FROM AM_APPLICATION WHERE ORGANIZATION=\"&lt;tenantdomain&gt;\");</code></p> <ol> <li> <p>Restart the WSO2 Identity Server.</p> </li> <li> <p>Restart the WSO2 API Manager Server.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/","title":"Migration resources for WSO2 Open Banking 2.0.0 to 3.0.0 - CDS Toolkit 1.0.0","text":"<p>This directory contains the migration documentation and resources for WSO2 Open Banking 2.0.0 to 3.0.0 - CDS Toolkit 1.0.0.</p> <p>The migration resources required for WSO2 Open Banking 2.0.0 to 3.0.0 - CDS Toolkit 1.0.0 can be found here.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/modifications-after-migration/","title":"Modifications After Migration","text":"<p>This page explains the modifications that need to be performed after the upgrade/migration process.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/modifications-after-migration/#open-banking-internal-scopes","title":"Open Banking Internal Scopes","text":"<p>Configure open banking internal scopes as follows:</p> <ol> <li> <p>Open the <code>&lt;IS_HOME&gt;/repository/conf/deployment.toml</code> file.</p> </li> <li> <p>Make sure the allowed scopes list contain the following: </p> <pre><code>[oauth]\nallowed_scopes = [\"OB_.*\", \"profile\"]\n</code></pre> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/open-banking-data-migration/","title":"Open Banking Data Migration","text":"<p>Before you begin:</p> <p>Back up all the databases before performing the migration.</p> <ol> <li>To create the required database tables:<ul> <li>Run the relevant SQL script in the <code>&lt;IS_HOME&gt;/dbscripts/open-banking/consent</code> directory against   the <code>openbank_openbankingdb</code> database.</li> <li>If you have enabled the Consent Amendment History feature in your OB 2.0 setup, run the relevant SQL script in the    <code>&lt;IS_HOME&gt;/dbscripts/open-banking/consent-history</code> directory against the <code>openbank_openbankingdb</code> database.</li> </ul> </li> <li>Get the WSO2 Open Banking Migration Client Tool v1.0.0 (<code>wso2-openbanking-migration-1.0.0.zip</code>) provided by the WSO2 team.</li> <li>Copy the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources</code> directory to <code>&lt;IS_HOME&gt;</code>.</li> <li>Copy the <code>wso2-openbanking-migration-1.0.0/dropins/com.wso2.openbanking.migration-1.0.0.jar</code> file to <code>&lt;IS_HOME&gt;/repository/components/dropins</code>.</li> <li> <p>Open the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/migration-config.yaml</code> file and    set the <code>migrationEnable</code> property to <code>true</code>.</p> <p>If you have enabled the Consent Amendment History feature in your OB 2.0 setup:</p> <p>Enable migrating the Consent History data in <code>migration-config.yaml</code> as follows:</p> <ul> <li>Locate the <code>ConsentMigrator</code> tag for <code>spec: \"AU\"</code> </li> <li>Set <code>consent_history_enabled</code> to <code>true</code></li> </ul> <pre><code>      -\n        name: \"ConsentMigrator\"\n        spec: \"AU\"\n        order: 1\n        parameters:\n          schema: \"ob\"\n          token_expiry_time: \"84600\"\n          expired_custom_status: \"Expired\"\n          consent_history_enabled: \"true\"\n</code></pre> </li> <li> <p>Start the Identity Server with the following command:</p> <pre><code>   sh wso2server.sh -DobMigrationSpec=AU\n</code></pre> </li> <li> <p>Stop the server.</p> <p>Warning</p> <p>If a failure occurred during the migration process, delete all the migrated data from the tables that      were generated during migration.</p> </li> <li> <p>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/com.wso2.openbanking.migration-1.0.0.jar</code> file.</p> </li> <li>Remove the <code>&lt;IS_HOME&gt;/openbanking-migration-resources</code> directory.</li> <li>Start the Identity Server and API Manager servers.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/reporting-data-migration/","title":"Reporting Data Migration","text":""},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/reporting-data-migration/#prerequisite","title":"Prerequisite","text":"<ol> <li>Stop the WSO2 Open Banking Business Intelligence 2.0.0 server if it is running.</li> <li>Download and install the WSO2 Streaming Integrator 4.0.0 distribution from here.</li> <li>Backup your <code>openbank_ob_reporting_statsdb</code> and <code>openbank_ob_reporting_summarizeddb</code> databases of your WSO2 Open Banking Business Intelligence 2.0.0 setup. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/reporting-data-migration/#set-up-open-banking-accelerator-and-cds-toolkit-for-streaming-integrator","title":"Set up Open Banking Accelerator and CDS Toolkit for Streaming Integrator","text":"<p>Set up WSO2 Open Banking Business Intelligence Accelerator and WSO2 Open Banking Business Intelligence CDS Toolkit  as follows:</p> <p>Note</p> <ul> <li><code>&lt;SI_HOME&gt;</code> refers to the root directory of WSO2 Streaming Integrator.</li> <li><code>&lt;OB_BI_ACCELERATOR_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence Accelerator.</li> <li><code>&lt;OB_BI_TOOLKIT_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence CDS Toolkit.</li> </ul> <ol> <li> <p>Copy and extract the <code>wso2-obbi-accelerator-3.0.0.zip</code> accelerator file in the root directory of WSO2 Streaming     Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/bin</code>:</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Copy and extract the <code>wso2-obbi-toolkit-cds-1.0.0.zip</code> toolkit file in the root directory of WSO2 Streaming     Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_TOOLKIT_HOME&gt;/bin</code>. </p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Replace the existing <code>deployment.yaml</code> file in the Streaming Integrator as follows:</p> <ul> <li>Go to the <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/repository/resources</code> directory.</li> <li>Rename <code>wso2si-4.0.0-deployment.yaml</code> to <code>deployment.yaml</code>.</li> <li>Copy the <code>deployment.yaml</code> file to the <code>&lt;SI_HOME&gt;/conf/server</code> directory to replace the existing file.</li> </ul> </li> <li> <p>Open the <code>&lt;SI_HOME&gt;/conf/server/deployment.toml</code> file, and configure the hostnames and databases related    properties accordingly.     </p> <ul> <li>When configuring database-related properties, point to your existing Open Banking 2.0 databases.</li> </ul> </li> <li> <p>Exchange the public certificates between servers. </p> <p>Follow the steps given below:</p> <p>a. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and export the public certificate of the Streaming         Integrator:</p> <pre><code>keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeySI.pem\n</code></pre> <p>b. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and import the public certificate of the         Streaming Integrator to the truststore of the Identity Server:</p> <pre><code>keytool -import -alias wso2 -file publickeySI.pem -keystore client-truststore.jks -storepass wso2carbon\n</code></pre> <p>c. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and export the public certificate of the         Identity Server:</p> <pre><code>keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeyIAM.pem\n</code></pre> <p>d. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and import the public certificate of the Identity         Server to the truststore of the Streaming Integrator:</p> <pre><code>keytool -import -alias wso2 -file publickeyIAM.pem -keystore client-truststore.jks -storepass wso2carbon\n</code></pre> <p>e. Go to the <code>&lt;APIM_HOME&gt;/repository/resources/security</code> directory and repeat step b,c, and d.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/reporting-data-migration/#upgrade-to-wso2-streaming-integrator-400","title":"Upgrade to WSO2 Streaming Integrator 4.0.0","text":"<p>To migrate the reporting data and tables from the Open Banking 2.0 setup to 3.0.</p> <ol> <li> <p>Go to the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/reporting-migration-scripts/au</code> directory.</p> </li> <li> <p>Open the <code>configure.properties</code> file and configure the following.</p> <ul> <li>Databases-related properties and database names</li> <li>Access token encryption configurations</li> </ul> <p>Tip</p> <p>Your existing access token encryption configurations are available in      the <code>&lt;WSO2_OB2_IAM_HOME&gt;/repository/conf/finance/open-banking.xml</code> file,     under the <code>&lt;BIServer&gt; &lt;Reporting&gt; &lt;TokenEncryption&gt;</code> tags.</p> </li> <li> <p>Run the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/reporting-migration-scripts/au/migrate.sh</code>    script.</p> <pre><code>./migrate.sh\n</code></pre> <p>Only for Oracle Databases:</p> <p>Execute the <code>openbanking-migration-resources/reporting-migration-scripts/au/reporting-oracle-2.0.0_to_3.0.0_runtime.sql</code>      script in against your <code>openbank_ob_reporting_statsdb</code> database.</p> <p>Tip</p> <p>You may drop the following tables of <code>OB_REPORTING_DB</code> as they are not required for Open Banking 3.0:</p> <pre><code>- `AUTHENTICATION_RAW_DATA`\n- `CDS_SESSION_RAW_DATA`\n- `ACCESS_TOKEN_RAW_DATA`\n- `APP_REG_RAW_DATA`\n</code></pre> </li> <li> <p>Start the Streaming Integrator and try out publishing data.     For more information, see Try Out Data Publishing.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-320/","title":"Upgrading to WSO2 API Manager 3.2.0","text":"<p>WSO2 API Manager 3.1.0 is a base product of WSO2 Open Banking 2.0. This section instructs you on how to upgrade the API Manager to 3.2.0, which is a prerequisite for upgrading to API Manager 4.0.</p> <ol> <li> <p>Get the Upgrading WSO2 IS as Key Manager documentation provided by the WSO2 team.</p> </li> <li> <p>Upgrade IS as Key Manager 5.10.0 for API Manager 3.2.0 by following the provided documentation.</p> </li> <li> <p>Get the Upgrading API Manager from 3.1.0 to 3.2.0 documentation provided by the WSO2 team.</p> </li> <li> <p>Upgrade API Manager from 3.1.0 to 3.2.0 by following the provided documentation.</p> <p>Note</p> <p>In the above documentation, under Step 1 - Migrate the API Manager configurations, skip steps 6,7,8, and 9 as we are only trying to migrate the databases at this level.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-400/","title":"Upgrading to WSO2 API Manager 4.0.0","text":"<p>Before you begin:</p> <p>Make sure you have upgraded your API Manager to 3.2.0 according to the Upgrading to WSO2 API Manager 3.2.0 (<code>upgrading-wso2-api-manager-320.md</code>) documentation.</p> <ol> <li>Download and install the WSO2 API Manager 4.0.0 distribution from here. </li> <li>Extract the downloaded archive file. This document refers to the root folder of the extracted file as <code>&lt;APIM_HOME&gt;</code>.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-400/#set-up-open-banking-accelerator-and-cds-toolkit-for-api-manager","title":"Set up Open Banking Accelerator and CDS Toolkit for API Manager","text":"<ol> <li>Download the <code>wso2-obam-accelerator-3.0.0.zip</code> file and extract it to the <code>&lt;APIM_HOME&gt;</code> directory. </li> <li>Download the latest updates for <code>wso2-obam-accelerator-3.0.0</code>. For more information, see Getting WSO2 Updates.</li> <li> <p>Go to the <code>&lt;APIM_HOME&gt;/&lt;APIM_ACCELERATOR_HOME&gt;/bin</code> directory and run the merge.sh script.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Download the <code>wso2-obam-toolkit-cds-1.0.0.zip</code> file and extract it to the <code>&lt;APIM_HOME&gt;</code> directory. </p> </li> <li>Download the latest updates for <code>wso2-obam-toolkit-cds-1.0.0</code>. For more information, see Getting WSO2 Updates.</li> <li> <p>Go to the <code>&lt;APIM_HOME&gt;/&lt;APIM_TOOLKIT_HOME&gt;/bin</code> directory and run the merge.sh script.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Replace the existing <code>deployment.toml</code> file in the API Manager as follows:</p> <ul> <li>Go to the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources</code> directory.</li> <li>Rename <code>wso2am-4.0.0-deployment-cds.toml</code> to <code>deployment.toml</code>.</li> <li>Copy the <code>deployment.toml</code> file to the <code>&lt;APIM_HOME&gt;/repository/conf</code> directory and replace the existing file.</li> </ul> </li> <li> <p>Open the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related       properties accordingly. </p> <ul> <li>When configuring database related properties, point to your existing Open Banking 2.0 databases.</li> </ul> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-400/#upgrading-to-wso2-api-manager-400_1","title":"Upgrading to WSO2 API Manager 4.0.0","text":"<p>Before you begin:</p> <p>Once the Identity Server 5.11.0 is configured as the Resident Key Manager, start the Identity Server 5.11.0.</p> <ol> <li> <p>Start the WSO2 API Manager 4.0.0 server and create a Custom Key Manager by following the    Configuring IS as Key Manager documentation.</p> </li> <li> <p>Do not copy any other Key Manager specific configurations from the previous API Manager version to the latest  one that points to the Identity Server.</p> </li> <li> <p>Get the Upgrading API Manager from 3.2.0 to 4.0.0 documentation provided by the WSO2 team.</p> </li> <li> <p>Upgrade your API Manager from 3.2.0 to 4.0.0 by following the provided documentation.</p> <p>Note</p> <p>When following the above mentioned documentation:</p> <ol> <li> <p>You can skip the steps 1,2, and 3 under Step 1 - Migrate the API Manager configurations.</p> </li> <li> <p>Modify the following configurations in the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file before starting the migration.</p> <pre><code>[[apim.gateway.environment]]\nname = \"Production and Sandbox\"\n[apim.sync_runtime_artifacts.gateway]\ngateway_labels =[\"Production and Sandbox\", \"Default\"]\n</code></pre> </li> <li> <p>In Step 2 - Upgrade API Manager to 4.0.0, skip the steps 3 and 5.</p> </li> </ol> </li> <li> <p>Start the API Manager server.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-400/#update-api-endpoints-custom-mediation-policies","title":"Update API Endpoints Custom Mediation Policies","text":"<p>This section explains how to update the API Endpoint of each API.</p> <ol> <li>Go to the API Publisher at <code>https://&lt;APIM_HOST&gt;:9443/publisher</code>.</li> <li>Select the respective API.</li> <li>Go to API Configurations &gt; Endpoints.</li> <li>Update the endpoints according to the  Summarized information for configuring APIs section. For more information, refer to the deployment steps of each API. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-400/#replace-custom-mediation-policies","title":"Replace Custom Mediation Policies","text":"<p>This section explains how to replace the Custom Mediation Policy of each API with the latest Mediation Policy.</p> <ol> <li>Go to the API Publisher at <code>https://&lt;APIM_HOST&gt;:9443/publisher</code>.</li> <li>Select the respective API.</li> <li>Go to API Configurations &gt; Runtime.</li> <li>Click the Edit button under Request &gt; Message Mediation and remove the existing Custom Mediation Policy.</li> <li>Upload the relevant insequence file from the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources/apis</code> directory  and click Select.</li> <li>Scroll down and click SAVE.</li> <li>Go to Deployments using the left menu pane.</li> <li>Click Deploy New Version.</li> <li>Select the API Gateway type and Deploy.</li> <li>Repeat these steps for all APIs. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-400/#enable-schema-validation","title":"Enable Schema Validation","text":"<p>This section explains how to enable Schema Validation for APIs.</p> <ol> <li>Go to the API Publisher at <code>https://&lt;APIM_HOST&gt;:9443/publisher</code>.</li> <li>Select the respective API.</li> <li>Go to API Configurations &gt; Runtime.</li> <li>Enable Schema Validation.</li> <li>Scroll down and click SAVE.</li> <li>Go to Deployments using the left menu pane.</li> <li>Click Deploy New Version.</li> <li>Select the API Gateway type and Deploy.</li> <li>Repeat these steps for all APIs except for the Dynamic Client Registration(DCR) API. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-400/#update-workflow-extensions","title":"Update Workflow-Extensions","text":"<ol> <li>Go to the Management Console <code>https://&lt;APIM_HOST&gt;:9443/carbon</code> and log in as the admin user. </li> <li>Select Resources &gt; Browse in the left pane.  </li> <li>Locate the <code>/_system/governance/apimgt/applicationdata/workflow-extensions.xml</code> file. </li> <li>Get the <code>workflow.txt</code> provided by the WSO2 team.</li> <li>Click Edit as text and replace the content with the content you received. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-400/#update-api-life-cycle","title":"Update API Life Cycle","text":"<ol> <li>Go to the Management Console <code>https://&lt;APIM_HOST&gt;:9443/carbon</code> and log in as the admin user. </li> <li>Select Extensions &gt; Lifecycles.  </li> <li>Click the View/Edit button for APILifeCycle. </li> <li>Get the <code>lifecycle.txt</code> provided by the WSO2 team.</li> <li>Replace the Lifecycle Source with the content you received.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-api-manager-400/#update-identity-provider-entity-id","title":"Update Identity Provider Entity ID","text":"<ol> <li>Go to Identity Server Management Console <code>https://&lt;IS_HOST&gt;:9446/carbon</code> and log in as the admin user.</li> <li>Select Identity Providers &gt; Resident. </li> <li>Go to Inbound Authentication Configuration &gt; OAuth2/OpenID Connect Configuration.</li> <li> <p>Update the Identity Provider Entity ID to the following:      <pre><code>https://&lt;IS_HOST&gt;:9446/oauth2/token\n</code></pre></p> <p></p> </li> <li> <p>Click Update.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-identity-server/","title":"Upgrading to WSO2 Identity Sever 5.11.0","text":""},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-identity-server/#set-up-is-5110-as-key-manager-for-api-manager-400","title":"Set up IS 5.11.0 as Key Manager for API Manager 4.0.0","text":"<ol> <li>Download and install the WSO2 Identity Server 5.11.0 distribution from here.</li> <li>Extract the downloaded archive file. This document refers to the root folder of the extracted file as <code>&lt;IS_HOME&gt;</code>.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-identity-server/#set-up-open-banking-accelerator-and-cds-toolkit-for-identity-sever","title":"Set up Open Banking Accelerator and CDS Toolkit for Identity Sever","text":"<ol> <li>Download the <code>wso2-obiam-accelerator-3.0.0.zip</code> file and extract it to the <code>&lt;IS_HOME&gt;</code> directory.</li> <li>Download the latest updates for <code>wso2-obiam-accelerator-3.0.0</code>. For more information, see Getting WSO2 Updates.</li> <li> <p>Go to the <code>&lt;IS_HOME&gt;/&lt;IS_ACCELERATOR_HOME&gt;/bin</code> directory and run the merge.sh script.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Download the <code>wso2-obiam-toolkit-cds-1.0.0.zip</code> file and extract it to the <code>&lt;IS_HOME&gt;</code> directory.</p> </li> <li>Download the latest updates for <code>wso2-obiam-toolkit-cds-1.0.0</code>. For more information, see Getting WSO2 Updates.</li> <li> <p>Go to the <code>&lt;IS_HOME&gt;/&lt;IS_TOOLKIT_HOME&gt;/bin</code> directory and run the merge.sh script.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>To configure the Identity Server with the API Manager, download WSO2 IS Connector.</p> </li> <li> <p>Copy the following files to the given directory paths:</p> File to copy Location to <code>wso2is-extensions-1.2.10/dropins/wso2is.key.manager.core-1.2.10.jar</code> <code>&lt;IS_HOME&gt;/repository/components/dropins</code> <code>wso2is-extensions-1.2.10/dropins/wso2is.notification.event.handlers-1.2.10.jar</code> <code>&lt;IS_HOME&gt;/repository/components/dropins</code> <code>wso2is-extensions-1.2.10/webapps/keymanager-operations.war</code> <code>&lt;IS_HOME&gt;/repository/deployment/server/webapps</code> </li> <li> <p>Replace the existing <code>deployment.toml</code> file in the Identity Server as follows:</p> <ul> <li>Go to the <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/repository/resources</code> directory.</li> <li>Rename <code>wso2is-5.11.0-deployment-cds.toml</code> to <code>deployment.toml</code>.</li> <li>Copy the <code>deployment.toml</code> file to the <code>&lt;IS_HOME&gt;/repository/conf</code> directory to replace the existing file.</li> </ul> </li> <li> <p>Open the <code>&lt;IS_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related     properties accordingly.</p> <ul> <li>When configuring database related properties, point to your existing Open Banking 2.0 databases.</li> </ul> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-identity-server/#migrate-to-wso2-identity-sever-5110","title":"Migrate to WSO2 Identity Sever 5.11.0","text":"<ol> <li> <p>Get the Upgrading WSO2 IS as Key Manager to 5.11.0 documentation provided by the WSO2 team.</p> </li> <li> <p>Follow Step B - Migrate IS from 5.10.0 to 5.11.0 and upgrade your WSO2 Identity Server.</p> </li> <li> <p>Get the WSO2 Identity Server Migrating to 5.11.0 documentation provided by the WSO2 team.</p> </li> <li> <p>Follow Migrating to 5.11.0 to upgrade your current IS as KM 5.10.0 distribution to IS 5.11.0.</p> <p>Note</p> <p>In the above documentation, under Steps to migrate to 5.11.0,</p> <ol> <li>Skip steps 1,2, and 4.</li> <li>Do not copy the API Manager - Key Manager specific configurations from          <code>&lt;OLD_IS_KM_HOME&gt;/repository/conf/api-manager.xml</code> of the previous IS as KM version to IS 5.11.0.</li> <li>Follow the step 10, only if you have enabled Symmetric Key Encryption in the previous IS as KM setup.          If not, skip step 10.</li> <li> <p>Before executing the IS migration client according to Step 11, remove the following entries from          <code>migration-config.yaml</code> in the migration-resources directory:</p> <pre><code>- version: \"5.10.0\"\nmigratorConfigs:\n-\nname: \"MigrationValidator\"\norder: 2\n-\nname: \"SchemaMigrator\"\norder: 5\nparameters:\nlocation: \"step2\"\nschema: \"identity\"\n-\nname: \"TenantPortalMigrator\"\norder: 11\n</code></pre> </li> </ol> <p>Warning</p> <p>Based on the number of records in the identity tables, the identity component migration will take a considerable time.      Do not stop the server during the migration process. Wait until the migration process finishes completely and the server gets started.</p> </li> <li> <p>After successfully completing the migration, stop the server and remove the following directories and files.</p> <ul> <li>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file.</li> <li>Remove the <code>&lt;IS_HOME&gt;/migration-resources</code> directory.</li> </ul> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/cds-toolkit-1.0.0/old-content-backup/upgrading-wso2-open-banking-200-to-300/","title":"Upgrading WSO2 Open Banking from 2.0.0 to 3.0.0","text":"<p>This section guides on how to upgrade your WSO2 Open Banking 2.0.0 setup to WSO2 Open Banking 3.0.0 (Accelerator Model). </p> <p>Note</p> <p>WSO2 Open Banking 2.0.0 is based on the WSO2 API Manager 3.1.0 and WSO2 Identity Server 5.10.0 products.</p> <p>Tip</p> <ul> <li>The DCR applications created in Open Banking 2.0.0 should not contain a SoftwareId/IssuerName that includes an      underscore \"_\".         - If you have such DCR applications, before the migration process, rename the Service Provider Name           of each DCR application's Service Provider application by logging into <code>https://&lt;IS_HOST&gt;:9446/carbon</code>.</li> <li>The Migration Client ONLY supports Open Banking 2.0.0 environments where the CDS - Secondary User feature      is not enabled.         - If you have already enabled data sharing for Secondary Users, you must await a future           release of the Migration Client.</li> <li> <p>In your Open Banking 2.0.0 database, check the column size of the following:</p> Database Table Column Data type Size <code>openbank_apimgtdb</code> <code>SP_METADATA</code> <code>VALUE</code> <code>VARCHAR</code> 4096 <ul> <li>If the column size is less than 4096, execute the following command against the <code>SP_METADATA</code> table:<pre><code>``` \nALTER TABLE SP_METADATA MODIFY VALUE VARCHAR(4096); \n```\n</code></pre> </li> </ul> </li> </ul> <p>The diagram below explains the flow of upgrading the WSO2 Open Banking solution:</p> <p></p> <p>Follow the topics below in the given order:</p> <ol> <li>Upgrading to WSO2 API Manager 3.2.0 (<code>upgrading-wso2-api-manager-320.md</code>)</li> <li>Upgrading to WSO2 Identity Sever 5.11.0 (<code>upgrading-wso2-identity-server.md</code>)</li> <li>Upgrading API Manager 3.2.0 to 4.0.0 (<code>upgrading-wso2-api-manager-400.md</code>)</li> <li>Migrating Open Banking Data (<code>open-banking-data-migration.md</code>)</li> <li>Migrating Reporting Data (<code>reporting-data-migration.md</code>)</li> <li>Configuring After Migration (<code>modifications-after-migration.md</code>)</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/","title":"Migration resources for WSO2 Open Banking 2.0.0 to 3.0.0 - UK Toolkit 1.0.0","text":"<p>Note</p> <p>This README documentation is for internal use only.</p> <p>This directory contains the migration documentation and resources for WSO2 Open Banking 2.0.0 to 3.0.0 - UK Toolkit 1.0.0.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/#migration-documentation","title":"Migration Documentation","text":"<ul> <li> <p>The documentation for WSO2 Open Banking 2.0.0 to 3.0.0 - UK Toolkit 1.0.0 can be accessed here.</p> </li> <li> <p>The reference documentation mentioned in the WSO2 Open Banking 2.0.0 to 3.0.0 - UK Toolkit 1.0.0 documentation can be accessed via the following links:</p> </li> </ul> Base Product Documentation File Name with GIT Location Upgrading WSO2 IS as Key Manager to 6.0.0 <code>Upgrade IS KM 5.10.0 to IS 6.0.0 for APIM 3.1.0 to 4.2.0.md</code> Migrating to 6.1.0 <code>migrate-to-610.md</code> Upgrading API Manager from 3.1.0 to 4.2.0 <code>upgrading-from-310-to-420.md</code>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/#migration-resources","title":"Migration Resources","text":"Migration Resource File Name with GIT Location Identity component migration resource <code>wso2is-migration-1.1.163.zip</code> APIM 4.2.0 DB Scripts <code>db-scripts/upgrading-from-310-to-420/</code> Latest APIM migration tool <code>wso2am-migration-4.2.0.54.zip</code> Latest OB migration tool <code>wso2-openbanking-migration-1.0.1.zip</code> <code>org.wso2.carbon.identity.oauth.uma.server.feature/resources/dbscripts/' folder | [</code>org.wso2.carbon.identity.oauth.uma.server.feature/resources/dbscripts/`](https://github.com/wso2-extensions/identity-oauth-uma/tree/master/features/org.wso2.carbon.identity.oauth.uma.server.feature/resources/dbscripts) <ul> <li>Additionally, all the images used in the documentation can be found here.</li> </ul>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/","title":"Upgrading WSO2 Open Banking from 2.0.0 to 3.0.0","text":"<p>This documentation guides you on how to upgrade your WSO2 Open Banking 2.0.0 for the UK setup to WSO2 Open Banking 3.0.0 (Accelerator Model) UK Toolkit 1.0.0 with WSO2 API Manager 4.2.0 and WSO2 Identity Server 6.1.0 as the base packs.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#overview","title":"Overview","text":"<p>WSO2 Open Banking solution runs on top of WSO2 Identity Server and WSO2 API Manager which are referred to as base products.</p> <p>Given below is the product compatibility matrix for the WSO2 Open Banking solution. This matrix outlines the compatibility between the versions of WSO2 Open Banking solutions involved in this migration and the latest version of the base products they support.</p> WSO2 Open Banking Version Supported WSO2 Identity Server Version Supported WSO2 API Manager Version 2.0.0 5.10.0 3.1.0 3.0.0 6.1.0 (Latest) 4.2.0 (Latest)"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#prerequisites","title":"Prerequisites","text":"<p>We assume that you already have an existing WSO2 Open Banking 2.0.0 solution for the UK with some sample data populated in the databases. This setup will be referred to as the pre-migration setup in this documentation.</p> <p>Important:</p> <ul> <li> <p>In order to upgrade your existing Open Banking solution to the latest version, you need to upgrade the base products (WSO2 Identity Server and WSO2 API Manager) to the latest supported version as well.</p> </li> <li> <p>In addition to the base product migration, you need to configure WSO2 Identity Server as Key Manager. The Key Manager handles all clients, security, and access token-related operations. So you need to configure WSO2 Identity Server as Key Manager in each WSO2 API Manager migration.</p> </li> </ul> <p>The following diagram explains the flow of upgrading the WSO2 Open Banking solution:</p> <p></p> <p>Given below are the steps you need to follow to upgrade your WSO2 Open Banking 2.0.0 for the UK setup to WSO2 Open Banking 3.0.0 - UK Toolkit 1.0.0:</p> <ol> <li>Prepare for Migration</li> <li>Upgrade IS as KM 5.10.0 to IS as KM 6.1.0</li> <li>Upgrade WSO2 API Manager 3.1.0 to WSO2 API Manager 4.2.0</li> <li>Migrate Open Banking Data</li> <li>Migrate Reporting Data (Optional)</li> <li>Post-Migration Configurations</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#1-prepare-for-migration","title":"1. Prepare for Migration","text":"<p>In the following section, you will be setting up Open Banking Accelerator and UK Toolkit for Identity Server and API Manager.</p> <ol> <li> <p>Download WSO2 Identity Server 6.1.0 from here and extract the folder. This extracted folder will be referred to as <code>&lt;IS_HOME&gt;</code> in this document.</p> </li> <li> <p>Download WSO2 API Manager 4.2.0 from here and extract the folder. This extracted folder will be referred to as <code>&lt;APIM_HOME&gt;</code> in this document.</p> </li> <li> <p>Get WSO2 Open Banking Accelerator 3.0.0 provided by the WSO2 team.</p> </li> <li> <p>Extract the WSO2 Open Banking Accelerator zip files. Get the following accelerators and extract them.</p> <ul> <li><code>wso2-obiam-accelerator-3.0.0</code></li> <li><code>wso2-obam-accelerator-3.0.0</code></li> </ul> </li> <li> <p>Get WSO2 Open Banking UK Toolkit 1.0.0 provided by the WSO2 team. Get the following toolkits and extract them.</p> <ul> <li><code>wso2-obiam-toolkit-uk-1.0.0</code></li> <li><code>wso2-obam-toolkit-uk-1.0.0</code></li> </ul> </li> <li> <p>This document uses the following placeholders to refer to the following products:</p> Product Placeholder WSO2 Identity Server 6.1.0 <code>&lt;IS_HOME&gt;</code> WSO2 API Manager 4.2.0 <code>&lt;APIM_HOME&gt;</code> WSO2 Open Banking Identity Server Accelerator 3.0.0 <code>&lt;OB_IS_ACCELERATOR_HOME&gt;</code> WSO2 Open Banking API Manager Accelerator 3.0.0 <code>&lt;OB_APIM_ACCELERATOR_HOME&gt;</code> WSO2 Open Banking Identity Server UK Toolkit 1.0.0 <code>&lt;OB_IS_TOOLKIT_HOME&gt;</code> WSO2 Open Banking API Manager UK Toolkit 1.0.0 <code>&lt;OB_APIM_TOOLKIT_HOME&gt;</code> </li> <li> <p>Follow the Getting WSO2 Updates documentation and update the base products, accelerators, and toolkits using relevant scripts.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_ACCELERATOR_HOME&gt;/bin</code> and <code>&lt;IS_HOME&gt;/&lt;OB_IS_ACCELERATOR_HOME&gt;/bin</code> respectively to copy the Open Banking artifacts into the base product packs.</p> </li> </ol> <pre><code>./merge.sh\n</code></pre> <ol> <li>Run the <code>merge.sh</code> script in <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/bin</code> and <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/bin</code> respectively:</li> </ol> <pre><code>./merge.sh\n</code></pre> <ol> <li> <p>Add the relevant modifications to the <code>wso2is-5.11.0-deployment-uk.toml</code> file in the <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/repository/resources</code> directory.</p> </li> <li> <p>Rename <code>wso2is-5.11.0-deployment-uk.toml</code> to <code>deployment.toml</code>.</p> </li> <li> <p>Copy the <code>deployment.toml</code> file to the <code>&lt;IS_HOME&gt;/repository/conf</code> directory to replace the existing file.</p> </li> <li> <p>Open the <code>&lt;IS_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related     properties accordingly.</p> <ul> <li>When configuring database related properties, ensure that the datasources are pointing to the existing databases.</li> </ul> </li> <li> <p>Add the relevant modifications to the <code>wso2am-4.0.0-deployment-uk.toml</code> file in the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources</code> directory.</p> </li> <li> <p>Rename <code>wso2am-4.0.0-deployment-uk.toml</code> to <code>deployment.toml</code>.</p> </li> <li> <p>Copy the <code>deployment.toml</code> file to the <code>&lt;APIM_HOME&gt;/repository/conf</code> directory to replace the existing file.</p> </li> <li> <p>Open the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related     properties accordingly.</p> <ul> <li>When configuring database related properties, ensure that the datasources are pointing to the existing databases.</li> </ul> </li> <li> <p>Add the following configurations needed for Identity Server 6.1.0 and API Manager 4.2.0.</p> <ol> <li> <p>Add the following configuration in Identity Server 6.1.0 <code>deployment.toml</code> file.</p> <pre><code>[application_mgt]\nenable_role_validation = true\n</code></pre> </li> <li> <p>Add the following configuration in the <code>deployment.toml</code> file of API Manager 4.2.0 after the configurations done under <code>[open_banking.dcr]</code>. Note that the version must be specified as <code>v3</code> for API Manager 4.2.0.</p> <pre><code>[open_banking.dcr.apim_rest_endpoints]\napp_creation = \"api/am/devportal/v3/applications\"\nkey_generation = \"api/am/devportal/v3/applications/application-id/map-keys\"\napi_retrieve = \"api/am/devportal/v3/apis\"\napi_subscribe = \"api/am/devportal/v3/subscriptions/multiple\"\nretrieve_subscribe=\"api/am/devportal/v3/subscriptions\u201d\n</code></pre> </li> </ol> </li> <li> <p>Now all the Open Banking related artifacts and configurations are included in the base packs.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#2-migrating-wso2-is-as-key-manager-from-identity-server-5100-to-610","title":"2. Migrating WSO2 IS as Key Manager from Identity Server 5.10.0 to 6.1.0","text":"<ol> <li> <p>Get the Upgrading WSO2 IS as Key Manager to 6.0.0 documentation provided by the WSO2 team. This will instruct you to upgrade your IS as Key Manager 5.10.0 to IS 6.1.0. Take note of the essential points provided below while following the instructions in the documentation.</p> <p>Important</p> <p>Please note that the information contained in the above-mentioned documentation is also applicable for WSO2 Identity Server 6.1.0.</p> </li> <li> <p>Follow Step A: Upgrade IS as Key Manager 5.10.0 to IS 6.0.0 in the above-mentioned documentation. Follow all the steps and make sure to perform the necessary steps mentioned below:</p> <p>Note</p> <p>Refer to the Migrating to 6.1.0 documentation when following the step 5 under Step 1: Migrate the IS as KM configurations.</p> </li> <li> <p>When following Step 2: Migrate the IS as KM Resources, download the WSO2 IS Connector for API Manager 4.2.0 from here. Extract the folder (<code>wso2is-extensions-1.6.8.zip</code>) and get the relevant JAR files and WAR file. </p> </li> <li> <p>When following Step 3: Migrate the IS as KM Components, use the <code>wso2is-migration-1.1.163.zip</code> folder as the identity component migration resource.</p> </li> <li> <p>Following the Step A: Upgrade IS as Key Manager 5.10.0 to IS 6.0.0 in the above-mentioned documentation with the above instructions, concludes the WSO2 IS as Key Manager from Identity Server 5.10.0 to 6.1.0 migration.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#3-migrating-wso2-api-manager-from-310-to-420","title":"3. Migrating WSO2 API Manager from 3.1.0 to 4.2.0","text":"<ol> <li> <p>Get the Upgrading API Manager from 3.1.0 to 4.2.0 documentation provided by the WSO2 team. This will instruct you to upgrade your API-M environment from 3.1.0 to 4.2.0. Take note of the essential points provided below while following the instructions in the documentation.</p> </li> <li> <p>When following Step 1: Migrate the API Manager Configurations, use the DB scripts (<code>db-scripts/upgrading-from-310-to-420</code>) provided by the WSO2 team.</p> </li> <li> <p>Skip the guidelines under Step 3: Migrate the Identity Components as you have already done this in Step 3 of Step A: Upgrade IS as Key Manager 5.10.0 to IS 6.0.0.</p> </li> <li> <p>When following Step 4: Migrate the API Manager Components, use the provided API Manager Migration resources (<code>wso2am-migration-4.2.0.54.zip</code>).</p> </li> <li> <p>Before starting the API Manager 4.2.0 server for the first time in Step 6 under Step 6: Restart the WSO2 API Manager 4.2.0 Server, make sure you have already started WSO2 Identity Server 6.1.0.</p> </li> <li> <p>Following the above-mentioned documentation with the above instructions, concludes the WSO2 API Manager migration.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#4-migrating-open-banking-data","title":"4. Migrating Open Banking Data","text":"<p>In this step, you will transfer your Open Banking data from your existing Open Banking 2.0.0 platform to the new WSO2 Open Banking 3.0.0 platform. This process includes moving important information such as customer accounts, transactions, and permissions.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#prerequisites_1","title":"Prerequisites","text":"<p>Make sure the following:</p> <ul> <li> <p>In your Open Banking 2.0.0 database, check the column size of the following:</p> Database Table Column Data type Size <code>openbank_apimgtdb</code> <code>SP_METADATA</code> <code>VALUE</code> <code>VARCHAR</code> 4096 <ul> <li> <p>If the column size is less than 4096, execute the following command against the <code>SP_METADATA</code> table:</p> <pre><code>ALTER TABLE SP_METADATA MODIFY VALUE VARCHAR(4096);\n</code></pre> </li> </ul> </li> </ul> <p>Note: </p> <p>Please read the following section before proceeding with the migration:</p> <ul> <li>The <code>SPMigrator</code> migrates the Dynamic Client Registration related data.</li> <li> <p>If the regulatory applications are registered through the signup flow.</p> <ul> <li>Please skip this migrator by removing the following configuration in <code>migration-config.yaml</code>.      <pre><code>- \n  name: \"SPMigrator\"\n  spec: \"UK\"\n  order: 3\n  parameters:\n    schema: \"ob\"\n</code></pre></li> </ul> </li> <li> <p>The default <code>common-auth-script.js</code> (the adaptive authentication script of service provider applications) that was provided in Open Banking 2.0.0 is not supported in Open Banking 3.0.0. Therefore, the migration tool is configured to automatically update the <code>common-auth-script</code> file of all service provider apps to the format which is supported in Open Banking 3.0.0.</p> <ul> <li>This default script supported in Open Banking 3.0.0 is available in the <code>common-auth-script.js</code> file placed at the <code>openbanking-migration-resources/common-auth-scripts/UK</code> directory.</li> <li>Make sure to change the content of the file appropriately if you have used a customized adaptive authentication script for all the service provider applications in your Open Banking 2.0.0 setup and that logic will not be supported directly in Open Banking 3.0.0.</li> <li>If you can assure that the customized adaptive authentication logic used in Open Banking 2.0.0 is supported in Open Banking 3.0.0 without any modifications, you can skip this step during the migration by setting the <code>commonAuthScriptUpdateEnable</code> parameter under the relevant spec version of the <code>SPMigrator</code> to <code>false</code> in <code>migration-config.yaml</code>. Otherwise, it should be <code>true</code>.       <code>-      name: \"SPMigrator\"      spec: \"UK\"      order: 3      parameters:      schema: \"ob\"      commonAuthScriptUpdateEnable: \"false\"</code></li> <li>If you have configured different adaptive authentication logics for service provider applications, the migration-tool does not support the automated update.</li> <li>In this case also, the <code>commonAuthScriptUpdateEnable</code> parameter under the relevant spec version of the SPMigrator should be set to false in <code>migration-config.yaml</code> before starting the OB-migration process as shown above.</li> </ul> <p>Note:</p> <ul> <li>If any update is required, the adaptive authentication logic of each service provider should be updated manually based on your customizations via the carbon console once the entire migration process is concluded. </li> </ul> </li> </ul> <p>Before you begin:</p> <p>Back up all the databases before performing the migration.</p> <ol> <li> <p>To create the required database tables:</p> <ul> <li>Run the relevant SQL script in the <code>&lt;IS_HOME&gt;/dbscripts/open-banking/consent</code> directory against the <code>openbank_openbankingdb</code> database.</li> </ul> </li> <li> <p>Get the WSO2 Open Banking Migration Client Tool v1.0.0 (<code>wso2-openbanking-migration-1.0.1.zip</code>) provided by the WSO2 team.</p> </li> <li> <p>Copy the <code>wso2-openbanking-migration-1.0.1/openbanking-migration-resources</code> directory to <code>&lt;IS_HOME&gt;</code>.</p> </li> <li> <p>Copy the <code>wso2-openbanking-migration-1.0.1/dropins/com.wso2.openbanking.migration-1.0.1.jar</code> file to <code>&lt;IS_HOME&gt;/repository/components/dropins</code>.</p> </li> <li> <p>Open the <code>wso2-openbanking-migration-1.0.1/openbanking-migration-resources/migration-config.yaml</code> file and set the <code>migrationEnable</code> property to <code>true</code>.</p> </li> <li> <p>Start the Identity Server with the following command:</p> <pre><code>   sh wso2server.sh -DobMigrationSpec=UK\n</code></pre> </li> <li> <p>Stop the server.</p> </li> </ol> <p>Warning</p> <p>If a failure occurred during the migration process, delete all the migrated data from the tables that    were generated during migration.</p> <ol> <li> <p>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/com.wso2.openbanking.migration-1.0.0.jar</code> file.</p> </li> <li> <p>Remove the <code>&lt;IS_HOME&gt;/openbanking-migration-resources</code> directory.</p> </li> <li> <p>Start the Identity Server and API Manager servers.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#5-migrating-reporting-data","title":"5. Migrating Reporting Data","text":"<p>In this step, you will transfer data from your existing reporting system to the new WSO2 Open Banking platform. This will involve moving data related to reports, dashboards, and visualizations.</p> <p>Note:</p> <p>Follow this step only if you are using WSO2 Open Banking Business Intelligence with your existing WSO2 Open Banking 2.0.0 setup.</p> <p>Before you begin:</p> <p>Make sure you are running Data Reporting v3.1.5 in your WSO2 Open Banking Business Intelligence 2.0.0 setup.    If not, follow the Upgrading Data Reporting from v3.1.2 to v3.1.5 documentation and upgrade.</p> <ol> <li>Stop the WSO2 Open Banking Business Intelligence 2.0.0 server if it is running.</li> <li>Download and install the WSO2 Streaming Integrator 4.0.0 distribution from here.</li> <li>Backup your <code>openbank_ob_reporting_statsdb</code> and <code>openbank_ob_reporting_summarizeddb</code> databases of your WSO2 Open Banking Business Intelligence 2.0.0 setup.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#set-up-open-banking-accelerator-and-uk-toolkit-for-streaming-integrator","title":"Set up Open Banking Accelerator and UK Toolkit for Streaming Integrator","text":"<p>Set up WSO2 Open Banking Business Intelligence Accelerator and WSO2 Open Banking Business Intelligence UK Toolkit as follows:</p> <p>Note</p> <ul> <li><code>&lt;SI_HOME&gt;</code> refers to the root directory of WSO2 Streaming Integrator.</li> <li><code>&lt;OB_BI_ACCELERATOR_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence Accelerator.</li> <li><code>&lt;OB_BI_TOOLKIT_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence UK Toolkit.</li> </ul> <ol> <li> <p>Copy and extract the <code>wso2-obbi-accelerator-3.0.0.zip</code> accelerator file in the root directory of WSO2 Streaming    Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/bin</code>:</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Copy and extract the <code>wso2-obbi-toolkit-uk-1.0.0.zip</code> toolkit file in the root directory of WSO2 Streaming    Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_TOOLKIT_HOME&gt;/bin</code>.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Replace the existing <code>deployment.yaml</code> file in the Streaming Integrator as follows:</p> <ul> <li>Go to the <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/repository/resources</code> directory.</li> <li>Rename <code>wso2si-4.0.0-deployment.yaml</code> to <code>deployment.yaml</code>.</li> <li>Copy the <code>deployment.yaml</code> file to the <code>&lt;SI_HOME&gt;/conf/server</code> directory to replace the existing file.</li> </ul> </li> <li> <p>Open the <code>&lt;SI_HOME&gt;/conf/server/deployment.toml</code> file, and configure the hostnames and databases related    properties accordingly.</p> <ul> <li>When configuring database related properties, point to your existing Open Banking 2.0 databases.</li> </ul> </li> <li> <p>Exchange the public certificates between servers.</p> </li> </ol> <p>Follow the steps given below:</p> <p>a. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and export the public certificate of the Streaming    Integrator:</p> <pre><code>keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeySI.pem\n</code></pre> <p>b. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and import the public certificate of the    Streaming Integrator to the truststore of the Identity Server:</p> <pre><code>keytool -import -alias wso2 -file publickeySI.pem -keystore client-truststore.jks -storepass wso2carbon\n</code></pre> <p>c. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and export the public certificate of the    Identity Server:</p> <pre><code>keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeyIAM.pem\n</code></pre> <p>d. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and import the public certificate of the Identity    Server to the truststore of the Streaming Integrator:</p> <pre><code>keytool -import -alias wso2 -file publickeyIAM.pem -keystore client-truststore.jks -storepass wso2carbon\n</code></pre> <p>e. Go to the <code>&lt;APIM_HOME&gt;/repository/resources/security</code> directory and repeat step b,c, and d.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#upgrade-to-wso2-streaming-integrator-400","title":"Upgrade to WSO2 Streaming Integrator 4.0.0","text":"<ol> <li> <p>To migrate the reporting data and tables from the Open Banking 2.0 setup to 3.0.</p> <ul> <li>Go to the   <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/reporting-migration-scripts/uk</code>   directory.</li> <li>Select the relevant SQL script and execute it against your <code>openbank_ob_reporting_statsdb</code> database.</li> </ul> </li> <li> <p>Start the Streaming Integrator server. For more information, see Try Out Data Publishing.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0/#6-post-migration-configurations","title":"6. Post-Migration Configurations","text":"<p>This section explains the modifications that need to be performed after the upgrade/migration process.</p> <ol> <li> <p>Stop the servers if running.</p> </li> <li> <p>Remove <code>com.wso2.openbanking.migration-1.0.0.jar</code> from the <code>IS_HOME&gt;/repository/components/dropins</code> folder.</p> </li> <li> <p>Remove <code>openbanking-migration-resources</code> folder from the <code>&lt;IS_HOME&gt;/repository/components/dropins</code> folder.</p> </li> </ol> <p>Note:</p> <p>Make sure to perform the following changes before starting with the Open Banking flows:    1. Redeploy the APIs with the relevant insequence files supported in WSO2 Open Banking 3.0.0 UK Toolkit 1.0.0.    2. Ensure the Production/Sandbox Endpoints of the published APIs are precise.</p> <ul> <li>Follow the Quick Start Guide - Tryout Flow of the UK Toolkit 1.0.0 documentation for a sample tryout flow of the Account and Transaction API.</li> <li>Navigate to the Tryout section in the UK Toolkit 1.0.0 documentation for more information on API flows.</li> </ul> <ol> <li> <p>Sign in to the Identity Server Management Console.</p> </li> <li> <p>Navigate to Identity Providers \u2192 Resident \u2192 Inbound Authentication Configuration \u2192 OAuth2/OpenID Connect Configuration \u2192 Identity Provider Entity ID.</p> </li> <li> <p>Change the Identity Provider Entity ID value from <code>https://localhost:8243/token</code> to <code>https://localhost:9446/oauth2/token</code>.</p> </li> <li> <p>If the <code>urn:ietf:params:oauth:grant-type:uma-ticket</code> grant type was used in the Open Banking 2 setup, follow the below instructions to configure User Managed Access with WSO2 Identity Server:</p> <p>WSO2 Identity Server (WSO2 IS) supports the UMA 2.0 protocol, which allows a resource owner to easily share resources with other requesting parties. To use UMA with WSO2 Identity Server, first you need to configure the authenticator with WSO2 Identity Server.</p> <p>You can either download the UMA artifacts or build the authenticator from the source code by following the steps given below. 1. Download the UMA connector and other required artifacts from the WSO2 store. 2. Add the following <code>.jar</code> files to the <code>&lt;IS_HOME&gt;/repository/components/dropins</code> directory.</p> <p><code>org.wso2.carbon.identity.oauth.uma.common-x.x.x.jar   org.wso2.carbon.identity.oauth.uma.grant-x.x.x.jar   org.wso2.carbon.identity.oauth.uma.permission.service-x.x.x.jar   org.wso2.carbon.identity.oauth.uma.resource.service-x.x.x.jar   org.wso2.carbon.identity.oauth.uma.xacml.extension-x.x.x.jar</code> 3. Add the following <code>.war</code> files to the <code>&lt;IS_HOME&gt;/repository/deployment/server/webapps</code> directory.  <code>api#identity#oauth2#uma#resourceregistration#v_.war    api#identity#oauth2#uma#permission#v_.war</code> 4. Get the <code>org.wso2.carbon.identity.oauth.uma.server.feature/resources/dbscripts/</code> folder provided by the WSO2 team. 5. Run the corresponding db script from the above-mentioned folder.  6. Start/ Restart WSO2 Identity Server. 7. Stop WSO2 Identity Server if it is already running. 8. Add the below configuration to the <code>&lt;IS-Home&gt;/repository/conf/deployment.toml</code> file.  ```toml  [[oauth.custom_grant_type]]  name = \"urn:ietf:params:oauth:grant-type:uma-ticket\"  grant_handler = \"org.wso2.carbon.identity.oauth.uma.grant.UMA2GrantHandler\"  grant_validator = \"org.wso2.carbon.identity.oauth.uma.grant.GrantValidator\"</p> <p>[[resource.access_control]]  context = \"(.)/api/identity/oauth2/uma/resourceregistration/v1.0/(.)\"  secure = \"true\"  http_method = \"all\"</p> <p>[[resource.access_control]]  context = \"(.)/api/identity/oauth2/uma/permission/v1.0/(.)\"  secure = \"true\"  http_method = \"all\"    ``` 8. Start/ Restart WSO2 Identity Server.</p> </li> <li> <p>Restart the WSO2 Identity Server.</p> </li> <li> <p>Restart the WSO2 API Manager Server.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/README-v1/","title":"Migration resources for WSO2 Open Banking 2.0.0 to 3.0.0 - UK Toolkit 1.0.0","text":"<p>Note</p> <p>This README documentation is for internal use only.</p> <p>This directory contains the migration documentation and resources for WSO2 Open Banking 2.0.0 to 3.0.0 - UK Toolkit 1.0.0.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/README-v1/#migration-documentation","title":"Migration Documentation","text":"<ul> <li> <p>The documentation for WSO2 Open Banking 2.0.0 to 3.0.0 - UK Toolkit 1.0.0 can be accessed here.</p> </li> <li> <p>The reference documentation mentioned in the WSO2 Open Banking 2.0.0 to 3.0.0 - UK Toolkit 1.0.0 documentation can be accessed via the following links:</p> Base Product Documentation File Name with GIT Location Upgrading WSO2 IS as Key Manager 5.10.0 for API Manager 3.2.0 <code>Upgrade IS as Key Manager 5.10.0 to IS 5.10.0 for APIM 3.1.0 to 3.2.0.md</code> Upgrading WSO2 API Manager from 3.1.0 to 3.2.0 <code>upgrading-from-310-to-320.md</code> Upgrading WSO2 IS as Key Manager to 5.11.0 <code>Upgrade IS as Key Manager 5.10.0 to IS 5.11.0 for APIM 3.2.0 to 4.0.0.md</code> Upgrading WSO2 Identity Server to 5.11.0 <code>migrating-to-5110.md</code> Upgrading WSO2 API Manager from 3.2.0 to 4.0.0 <code>upgrading-from-320-to-400.md</code> Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0 <code>Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0.md</code> Migrating to 6.1.0 <code>migrate-to-610.md</code> Upgrading API Manager from 4.0.0 to 4.2.0 <code>upgrading-from-400-to-420.md</code> </li> <li> <p>The reference documentation for the base product documents mentioned in the above table can be accessed via the following links:</p> Reference Documentation in the Base Product Documentation File Name with GIT Location Upgrading API-M from 3.1.0 to 3.2.0 <code>upgrading-from-310-to-320.md</code> Upgrading WSO2 IS as the Key Manager to 5.10.0 document <code>Upgrade IS as Key Manager 5.10.0 to IS 5.10.0 for APIM 3.1.0 to 3.2.0.md</code> upgrade WSO2 IS as the Key Manager to 5.11.0 <code>Upgrade IS as Key Manager 5.10.0 to IS 5.11.0 for APIM 3.2.0 to 4.0.0.md</code> </li> </ul>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/README-v1/#migration-resources","title":"Migration Resources","text":"<ul> <li> <p>The migration resources required for WSO2 Open Banking 2.0.0 to 3.0.0 - UK Toolkit 1.0.0 can be accessed via the following links:</p> <ul> <li>Attachments</li> <li><code>wso2is-extensions-1.6.8.zip</code></li> <li><code>wso2is-migration-1.1.163.zip</code></li> <li><code>db-scripts/upgrading-from-400-to-420</code></li> <li><code>wso2am-migration-4.2.0.54.zip</code></li> </ul> </li> <li> <p>Additionally, all the images used in the documentation can be found here.</p> </li> </ul>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/modifications-after-migration/","title":"Modifications After Migration","text":"<p>This page explains the modifications that need to be performed after the upgrade/migration process.</p> <ol> <li> <p>Stop the servers if running.</p> </li> <li> <p>Remove <code>com.wso2.openbanking.migration-1.0.0.jar</code> from the <code>IS_HOME&gt;/repository/components/dropins</code> folder.</p> </li> <li> <p>Remove <code>openbanking-migration-resources</code> folder from the <code>&lt;IS_HOME&gt;/repository/components/dropins</code> folder.</p> <p>Note:</p> <p>Make sure to perform the following changes before starting with the Open Banking flows:    1. Redeploy the APIs with the relevant insequence files supported in WSO2 Open Banking 3.0.0 UK Toolkit 1.0.0.    2. Ensure the Production/Sandbox Endpoints of the published APIs are precise.</p> <ul> <li>Follow the Quick Start Guide - Tryout Flow of the UK Toolkit 1.0.0 documentation for a sample tryout flow of the Account and Transaction API.</li> <li>Navigate to the Tryout section in the UK Toolkit 1.0.0 documentation for more information on API flows.</li> </ul> </li> <li> <p>Restart the WSO2 Identity Server.</p> </li> <li> <p>Restart the WSO2 API Manager Server. </p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/open-banking-data-migration/","title":"Open Banking Data Migration","text":"<p>Before you begin:</p> <p>Back up all the databases before performing the migration.</p> <ol> <li>To create the required database tables:<ul> <li>Run the relevant SQL script in the <code>&lt;IS_HOME&gt;/dbscripts/open-banking/consent</code> directory against   the <code>openbank_openbankingdb</code> database.</li> </ul> </li> <li>Get the WSO2 Open Banking Migration Client Tool v1.0.0 (<code>wso2-openbanking-migration-1.0.0.zip</code>) provided by the WSO2 team.</li> <li>Copy the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources</code> directory to <code>&lt;IS_HOME&gt;</code>.</li> <li>Copy the <code>wso2-openbanking-migration-1.0.0/dropins/com.wso2.openbanking.migration-1.0.0.jar</code> file to <code>&lt;IS_HOME&gt;/repository/components/dropins</code>.</li> <li>Open the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/migration-config.yaml</code> file and    set the <code>migrationEnable</code> property to <code>true</code>.</li> <li> <p>Start the Identity Server with the following command:</p> <pre><code>   sh wso2server.sh -DobMigrationSpec=UK\n</code></pre> </li> <li> <p>Stop the server.</p> <p>Warning</p> <p>If a failure occurred during the migration process, delete all the migrated data from the tables that      were generated during migration.</p> </li> <li> <p>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/com.wso2.openbanking.migration-1.0.0.jar</code> file.</p> </li> <li>Remove the <code>&lt;IS_HOME&gt;/openbanking-migration-resources</code> directory.</li> <li>Start the Identity Server and API Manager servers.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/reporting-data-migration/","title":"Reporting Data Migration","text":"<p>Before you begin:</p> <p>Make sure you are running Data Reporting v3.1.5 in your WSO2 Open Banking Business Intelligence 2.0.0 setup.     If not, follow the Upgrading Data Reporting from v3.1.2 to v3.1.5      documentation and upgrade.</p> <ol> <li>Stop the WSO2 Open Banking Business Intelligence 2.0.0 server if it is running.</li> <li>Download and install the WSO2 Streaming Integrator 4.0.0 distribution from here.</li> <li>Backup your <code>openbank_ob_reporting_statsdb</code> and <code>openbank_ob_reporting_summarizeddb</code> databases of your WSO2 Open Banking Business Intelligence 2.0.0 setup. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/reporting-data-migration/#set-up-open-banking-accelerator-and-uk-toolkit-for-streaming-integrator","title":"Set up Open Banking Accelerator and UK Toolkit for Streaming Integrator","text":"<p>Set up WSO2 Open Banking Business Intelligence Accelerator and WSO2 Open Banking Business Intelligence UK Toolkit  as follows:</p> <p>Note</p> <ul> <li><code>&lt;SI_HOME&gt;</code> refers to the root directory of WSO2 Streaming Integrator.</li> <li><code>&lt;OB_BI_ACCELERATOR_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence Accelerator.</li> <li><code>&lt;OB_BI_TOOLKIT_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence UK Toolkit.</li> </ul> <ol> <li> <p>Copy and extract the <code>wso2-obbi-accelerator-3.0.0.zip</code> accelerator file in the root directory of WSO2 Streaming     Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/bin</code>:</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Copy and extract the <code>wso2-obbi-toolkit-uk-1.0.0.zip</code> toolkit file in the root directory of WSO2 Streaming     Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_TOOLKIT_HOME&gt;/bin</code>. </p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Replace the existing <code>deployment.yaml</code> file in the Streaming Integrator as follows:</p> <ul> <li>Go to the <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/repository/resources</code> directory.</li> <li>Rename <code>wso2si-4.0.0-deployment.yaml</code> to <code>deployment.yaml</code>.</li> <li>Copy the <code>deployment.yaml</code> file to the <code>&lt;SI_HOME&gt;/conf/server</code> directory to replace the existing file.</li> </ul> </li> <li> <p>Open the <code>&lt;SI_HOME&gt;/conf/server/deployment.toml</code> file, and configure the hostnames and databases related    properties accordingly.     </p> <ul> <li>When configuring database related properties, point to your existing Open Banking 2.0 databases.</li> </ul> </li> <li> <p>Exchange the public certificates between servers. </p> <p>Follow the steps given below:</p> <p>a. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and export the public certificate of the Streaming         Integrator:</p> <pre><code>keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeySI.pem\n</code></pre> <p>b. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and import the public certificate of the         Streaming Integrator to the truststore of the Identity Server:</p> <pre><code>keytool -import -alias wso2 -file publickeySI.pem -keystore client-truststore.jks -storepass wso2carbon\n</code></pre> <p>c. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and export the public certificate of the         Identity Server:</p> <pre><code>keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeyIAM.pem\n</code></pre> <p>d. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and import the public certificate of the Identity         Server to the truststore of the Streaming Integrator:</p> <pre><code>keytool -import -alias wso2 -file publickeyIAM.pem -keystore client-truststore.jks -storepass wso2carbon\n</code></pre> <p>e. Go to the <code>&lt;APIM_HOME&gt;/repository/resources/security</code> directory and repeat step b,c, and d.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/reporting-data-migration/#upgrade-to-wso2-streaming-integrator-400","title":"Upgrade to WSO2 Streaming Integrator 4.0.0","text":"<ol> <li> <p>To migrate the reporting data and tables from the Open Banking 2.0 setup to 3.0.</p> <ul> <li>Go to the    <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/reporting-migration-scripts/uk</code>    directory.</li> <li>Select the relevant SQL script and execute it against your <code>openbank_ob_reporting_statsdb</code> database.</li> </ul> </li> <li> <p>Start the Streaming Integrator server. For more information, see Try Out Data Publishing.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-api-manager-4.0.0-to-4.2.0-and-identity-server-5.11.0-to-6.1.0/","title":"Upgrade WSO2 API Manager from 4.0.0 to 4.2.0 and WSO2 Identity Server from 5.11.0 to 6.1.0","text":""},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-api-manager-4.0.0-to-4.2.0-and-identity-server-5.11.0-to-6.1.0/#prepare-for-migration","title":"Prepare for Migration","text":"<ol> <li> <p>Download WSO2 Identity Server 6.1.0 from here and extract the folder. The extracted folder will be referred to as <code>&lt;IS_HOME&gt;</code> in this document.</p> </li> <li> <p>Download WSO2 API Manager 4.2.0 from here and extract the folder. The extracted folder will be referred to as <code>&lt;APIM_HOME&gt;</code> in this document.</p> </li> <li> <p>Get WSO2 Open Banking Accelerator 3.0.0 provided by the WSO2 team.</p> </li> <li> <p>Extract the WSO2 Open Banking Accelerator zip files. Get the following accelerators and extract them.</p> <ul> <li><code>wso2-obiam-accelerator-3.0.0</code></li> <li><code>wso2-obam-accelerator-3.0.0</code></li> </ul> </li> <li> <p>Get WSO2 Open Banking UK Toolkit 1.0.0 provided by the WSO2 team. Get the following toolkits and extract them.</p> <ul> <li><code>wso2-obiam-toolkit-uk-1.0.0</code></li> <li><code>wso2-obam-toolkit-uk-1.0.0</code></li> </ul> </li> <li> <p>This document uses the following placeholders to refer to the following products:</p> Product Placeholder WSO2 Identity Server 6.1.0 <code>&lt;IS_HOME&gt;</code> WSO2 API Manager 4.2.0 <code>&lt;APIM_HOME&gt;</code> WSO2 Open Banking Identity Server Accelerator 3.0.0 <code>&lt;OB_IS_ACCELERATOR_HOME&gt;</code> WSO2 Open Banking API Manager Accelerator 3.0.0 <code>&lt;OB_APIM_ACCELERATOR_HOME&gt;</code> WSO2 Open Banking Identity Server UK Toolkit 1.0.0 <code>&lt;OB_IS_TOOLKIT_HOME&gt;</code> WSO2 Open Banking API Manager UK Toolkit 1.0.0 <code>&lt;OB_APIM_TOOLKIT_HOME&gt;</code> </li> <li> <p>Follow the Getting WSO2 Updates documentation and update the base products, accelerators, and toolkits using relevant scripts.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_ACCELERATOR_HOME&gt;/bin</code> and <code>&lt;IS_HOME&gt;/&lt;OB_IS_ACCELERATOR_HOME&gt;/bin</code> respectively to copy the Open Banking artifacts into the the base product packs.</p> </li> </ol> <pre><code>./merge.sh\n</code></pre> <ol> <li>Run the <code>merge.sh</code> script in <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/bin</code> and <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/bin</code> respectively:</li> </ol> <pre><code>./merge.sh\n</code></pre> <ol> <li> <p>Add the relevant modifications to the <code>wso2is-5.11.0-deployment-uk.toml</code> file in the <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/repository/resources</code> directory. </p> </li> <li> <p>Rename <code>wso2is-5.11.0-deployment-uk.toml</code> to <code>deployment.toml</code>. </p> </li> <li> <p>Copy the <code>deployment.toml</code> file to the <code>&lt;IS_HOME&gt;/repository/conf</code> directory to replace the existing file.</p> </li> <li> <p>Open the <code>&lt;IS_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related    properties accordingly.</p> </li> <li> <p>When configuring database related properties, ensure that the datasources are pointing to the existing databases. </p> </li> <li> <p>Add the relevant modifications to the <code>wso2am-4.0.0-deployment-uk.toml</code> file in the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources</code> directory.</p> </li> <li> <p>Rename <code>wso2am-4.0.0-deployment-uk.toml</code> to <code>deployment.toml</code>.</p> </li> <li> <p>Copy the <code>deployment.toml</code> file to the <code>&lt;APIM_HOME&gt;/repository/conf</code> directory to replace the existing file.</p> </li> <li> <p>Open the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related     properties accordingly.</p> <ul> <li>When configuring database related properties, ensure that the datasources are pointing to the existing databases.</li> </ul> </li> <li> <p>Add the following configurations needed for Identity Server 6.1.0 and API Manager 4.2.0.</p> <ol> <li> <p>Add the following configuration in IS 6.1.0 deployment.toml</p> <pre><code>[application_mgt]\nenable_role_validation = true\n</code></pre> </li> <li> <p>Add the following configuration in the <code>deployment.toml</code> file of API Manager 4.2.0 after the configurations done under <code>[open_banking.dcr]</code>. Note that the version must be specified as <code>v3</code> for API Manager 4.2.0.</p> <pre><code>[open_banking.dcr.apim_rest_endpoints]\napp_creation = \"api/am/devportal/v3/applications\"\nkey_generation = \"api/am/devportal/v3/applications/application-id/map-keys\"\napi_retrieve = \"api/am/devportal/v3/apis\"\napi_subscribe = \"api/am/devportal/v3/subscriptions/multiple\"\nretrieve_subscribe=\"api/am/devportal/v3/subscriptions\u201d\n</code></pre> </li> </ol> </li> <li> <p>Now all the Open Banking related artifacts and configurations are included in the base packs.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-api-manager-4.0.0-to-4.2.0-and-identity-server-5.11.0-to-6.1.0/#upgrade-to-wso2-identity-server-610","title":"Upgrade to WSO2 Identity Server 6.1.0","text":"<ol> <li> <p>Follow the Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0 documentation (<code>Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0.md</code>) from the beginning along with this document (<code>upgrade-api-manager-4.0.0-to-4.2.0-and-identity-server-5.11.0-to-6.1.0.md</code>) and start the migration. When following the above-mentioned documentation,</p> <p>Note:</p> <p>Please note that the instructions provided in the above-mentioned document are also applicable for WSO2 Identity Server 6.1.0.</p> </li> <li> <p>Follow the step 4 under Step A: Upgrade IS 5.11.0 to IS 6.0.0 &gt; Step 1: Migrate the IS configurations if applicable.</p> </li> <li> <p>Step 5 under Step A: Upgrade IS 5.11.0 to IS 6.0.0 &gt; Step 1: Migrate the IS configurations refers to the <code>Configurations</code> section of the Migrating to 6.1.0 documentation (<code>migrate-to-610.md</code>). Skip the step 3 of that section.</p> </li> <li> <p>Follow the steps mentioned in the <code>Note</code> provided under the step 5 under Step A: Upgrade IS 5.11.0 to IS 6.0.0 &gt; Step 1: Migrate the IS configurations. </p> <p>Note:</p> <p>Here, we need to point the datasources to the existing databases.</p> </li> <li> <p>When following the step 2 of the Step 2: Migrate the IS Resources in the above-mentioned document, use the IS connector related to the API Manager 4.2.0 provided by the WSO2 team (<code>wso2is-extensions-1.6.8.zip</code>). Please use the jar versions included in the provided <code>wso2is-extensions-1.6.8.zip</code> folder.</p> </li> <li> <p>For the step 4 under the Step 2: Migrate the IS Resources topic in the above-mentioned documentation please refer to the Migrating to 6.1.0 documentation (<code>migrate-to-610.md</code>). Follow the steps in order skipping the steps mentioned below.</p> <ol> <li> <p>Skip the Components section under Step 1: Migrate artifacts and configs when following the above-mentioned documentation (<code>migrate-to-610.md</code>).</p> </li> <li> <p>When following the Resources section under Step 1: Migrate artifacts and configs, skip the configurations included inside the Note.</p> </li> <li> <p>Skip the Tenants section under Step 1: Migrate artifacts and configs.</p> </li> <li> <p>The User Stores section under Step 1: Migrate artifacts and configs is optional.</p> </li> <li> <p>Skip the Webapps section under Step 1: Migrate artifacts and configs.</p> </li> <li> <p>The instructions under the Configurations section is already followed at this point. Therefore, not need to follow that..</p> </li> </ol> </li> <li> <p>When following Step 3: Migrate the IS Components in the Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0 documentation (<code>Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0.md</code>) use the migration tool provided by the WSO2 team (<code>wso2is-migration-1.1.163.zip</code>).</p> </li> <li> <p>Then run the migration tool at the step 8 after following the rest of the instructions.</p> </li> <li> <p>Following the Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0 documentation (<code>Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0.md</code>) with the above instructions, concludes the Identity Server migration.</p> </li> </ol> <p>Then start the API Manager migration.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-api-manager-4.0.0-to-4.2.0-and-identity-server-5.11.0-to-6.1.0/#upgrade-to-wso2-api-manager-420","title":"Upgrade to WSO2 API Manager 4.2.0","text":"<p>Follow the Upgrading API Manager from 4.0.0 to 4.2.0 documentation (<code>upgrading-from-400-to-420.md</code>) along with the following instructions to perform the API Manager migration.</p> <ol> <li> <p>When following step 1 in Step 1: Migrate the API Manager Configurations, make sure to point the datasources to the existing databases.</p> </li> <li> <p>When setting the <code>realm_manager</code>, set it as same as the datasource name of the user database of Open Banking (for example, by default it is <code>WSO2UM_DB</code>.)</p> </li> <li> <p>Skip step 3 under Step 1: Migrate the API Manager Configurations.</p> </li> <li> <p>Follow step 4 under Step 1: Migrate the API Manager Configurations if applicable.</p> </li> <li> <p>For the step 5 under Step 1: Migrate the API Manager Configurations use the relevant database scripts provided by the WSO2 team (<code>db-scripts/upgrading-from-400-to-420</code>).</p> </li> <li> <p>When following Step 2: Migrate the API Manager Resources in the above-mentioned documentation,</p> </li> <li> <p>Skip steps 2 and 3.</p> </li> <li>Follow the step 4 only if the secure vault is enabled.</li> <li>Skip step 5 if the setup does not have a secondary user store.</li> <li> <p>Skip step 6.</p> </li> <li> <p>Skip Step 3: Migrate the Identity Components.</p> </li> <li> <p>When migrating the API Manager components under Step 4: Migrate the API Manager Components, use the latest API Manager migration tool provided by the WSO2 team (<code>wso2am-migration-4.2.0.54.zip</code>).</p> </li> <li> <p>Before running the migration tool for APIM migration, make sure the Identity Server is up.</p> </li> <li> <p>Skip the instructions inside the Note under Step 6: Restart the API Manager Server.</p> </li> <li> <p>Restart the WSO2 API Manager Server.</p> </li> <li> <p>Following the Upgrading API Manager from 4.0.0 to 4.2.0 documentation (<code>upgrading-from-400-to-420.md</code>) with the above instructions, concludes the API Manager migration.</p> </li> <li> <p>This concludes the migration process.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-3.2.0/","title":"Upgrade to WSO2 API Manager 3.2.0","text":"<p>In this step you will be migrating your existing WSO2 API Manager 3.1.0 to 3.2.0.</p> <p>This section instructs you on how to upgrade the API Manager to 3.2.0, which is a prerequisite for upgrading to API Manager 4.0.0.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-3.2.0/#prerequisites","title":"Prerequisites","text":"<p>WSO2 API Manager 3.1.0 is a base product of WSO2 Open Banking 2.0.0. Therefore, we assume you already have WSO2 API Manager 3.1.0.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-3.2.0/#upgrade-wso2-is-as-key-manager-5100-for-api-manager-320","title":"Upgrade WSO2 IS as Key Manager 5.10.0 for API Manager 3.2.0","text":"<p>Follow the Upgrading WSO2 IS as Key Manager 5.10.0 for API Manager 3.2.0 documentation (<code>Upgrade IS as Key Manager 5.10.0 to IS 5.10.0 for APIM 3.1.0 to 3.2.0.md</code>) provided by the WSO2 team and upgrade IS as Key Manager 5.10.0 for API Manager 3.2.0. </p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-3.2.0/#upgrade-wso2-api-manager-from-310-to-320","title":"Upgrade WSO2 API Manager from 3.1.0 to 3.2.0","text":"<p>Follow the Upgrading WSO2 API Manager from 3.1.0 to 3.2.0 documentation (<code>upgrading-from-310-to-320.md</code>) provided by the WSO2 team and upgrade WSO2 API Manager from 3.1.0 to 3.2.0.</p> <p>Note</p> <p>In the above documentation, under Step 1 - Migrate the API Manager configurations, skip steps 6,7,8, and 9 as we are only trying to migrate the databases at this level.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-4.0.0/","title":"Upgrade to WSO2 API Manager 4.0.0","text":""},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-4.0.0/#prerequisites","title":"Prerequisites","text":"<p>We assume you already upgraded your API Manager to 3.2.0 as instructed previously on the Upgrading WSO2 API Manager from 3.1.0 to 3.2.0 (<code>upgrade-to-wso2-api-manager-3.2.0.md</code>) documentation.</p> <ol> <li> <p>Download and install the WSO2 API Manager 4.0.0 distribution from here. </p> </li> <li> <p>Extract the downloaded archive file. This document refers to the root folder of the extracted file as <code>&lt;APIM_HOME&gt;</code>.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-4.0.0/#upgrade-to-wso2-api-manager-400_1","title":"Upgrade to WSO2 API Manager 4.0.0","text":"<p>Before you begin:</p> <p>Once the Identity Server 5.11.0 is configured as the Resident Key Manager, start the Identity Server 5.11.0.</p> <ol> <li> <p>Start the WSO2 API Manager 4.0.0 server and create a Custom Key Manager by following the    Configuring IS as Key Manager documentation.</p> </li> <li> <p>Do not copy any other Key Manager specific configurations from the previous API Manager version to the latest one that points to the Identity Server.</p> </li> <li> <p>Follow the Upgrading WSO2 API Manager from 3.2.0 to 4.0.0 (<code>upgrading-from-320-to-400.md</code>) documentation provided by the WSO2 team and upgrade your API Manager from 3.2.0 to 4.0.0. Follow the entire documentation carefully and make sure to perform the necessary steps mentioned below:  </p> <p>Note</p> <p>When following the above-mentioned documentation:</p> <ol> <li> <p>You can skip the steps 1,2, and 3 under Step 1 - Migrate the API Manager configurations.</p> </li> <li> <p>Modify the following configurations in the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file before starting the migration.</p> <pre><code>[[apim.gateway.environment]]\nname = \"Production and Sandbox\"\n[apim.sync_runtime_artifacts.gateway]\ngateway_labels =[\"Production and Sandbox\", \"Default\"]\n</code></pre> </li> <li> <p>In Step 2 - Upgrade API Manager to 4.0.0, skip the steps 3 and 5.</p> </li> </ol> </li> <li> <p>Start the API Manager server.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-4.0.0/#replace-custom-mediation-policies","title":"Replace Custom Mediation Policies","text":"<p>This section explains how to replace the Custom Mediation Policy of each API with the latest Mediation Policy.</p> <ol> <li>Go to the API Publisher at <code>https://&lt;APIM_HOST&gt;:9443/publisher</code>.</li> <li>Select the respective API.</li> <li>Go to API Configurations &gt; Runtime.</li> <li>Click the Edit button under Request &gt; Message Mediation and remove the existing Custom Mediation Policy.</li> <li>Upload the relevant insequence file from the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources/apis</code> directory  and click Select.</li> <li>Scroll down and click SAVE.</li> <li>Go to Deployments using the left menu pane.</li> <li>Click Deploy New Version.</li> <li>Select the API Gateway type and Deploy.</li> <li>Repeat these steps for all APIs. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-4.0.0/#enable-schema-validation","title":"Enable Schema Validation","text":"<p>This section explains how to enable Schema Validation for APIs.</p> <ol> <li>Go to the API Publisher at <code>https://&lt;APIM_HOST&gt;:9443/publisher</code>.</li> <li>Select the respective API.</li> <li>Go to API Configurations &gt; Runtime.</li> <li>Enable Schema Validation.</li> <li>Scroll down and click SAVE.</li> <li>Go to Deployments using the left menu pane.</li> <li>Click Deploy New Version.</li> <li>Select the API Gateway type and Deploy.</li> <li>Repeat these steps for all APIs except for the Dynamic Client Registration(DCR) API. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-4.0.0/#update-workflow-extensions","title":"Update Workflow-Extensions","text":"<ol> <li>Go to the Management Console <code>https://&lt;APIM_HOST&gt;:9443/carbon</code> and log in as the admin user. </li> <li>Select Resources &gt; Browse in the left pane.  </li> <li>Locate the <code>/_system/governance/apimgt/applicationdata/workflow-extensions.xml</code> file. </li> <li>Get the <code>workflow.txt</code> provided by the WSO2 team.</li> <li>Click Edit as text and replace the content with the content you received. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-4.0.0/#update-api-life-cycle","title":"Update API Life Cycle","text":"<ol> <li>Go to the Management Console <code>https://&lt;APIM_HOST&gt;:9443/carbon</code> and log in as the admin user. </li> <li>Select Extensions &gt; Lifecycles.  </li> <li>Click the View/Edit button for APILifeCycle. </li> <li>Get the <code>lifecycle.txt</code> provided by the WSO2 team.</li> <li>Replace the Lifecycle Source with the content you received.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-api-manager-4.0.0/#update-identity-provider-entity-id","title":"Update Identity Provider Entity ID","text":"<ol> <li>Go to Identity Server Management Console <code>https://&lt;IS_HOST&gt;:9446/carbon</code> and log in as the admin user.</li> <li>Select Identity Providers &gt; Resident. </li> <li>Go to Inbound Authentication Configuration &gt; OAuth2/OpenID Connect Configuration.</li> <li> <p>Update the Identity Provider Entity ID to the following:      <pre><code>https://&lt;IS_HOST&gt;:9446/oauth2/token\n</code></pre></p> <p></p> </li> <li> <p>Click Update.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-identity-server-5.11.0/","title":"Upgrade to WSO2 Identity Sever 5.11.0","text":""},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-identity-server-5.11.0/#prerequisites","title":"Prerequisites","text":"<p>WSO2 Identity Sever 5.10.0 is a base product of WSO2 Open Banking 2.0.0. Therefore, we assume you already have WSO2 Identity Sever 5.10.0.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-identity-server-5.11.0/#set-up-is-5110-as-key-manager-for-api-manager-400","title":"Set up IS 5.11.0 as Key Manager for API Manager 4.0.0","text":"<ol> <li> <p>Download and install the WSO2 Identity Server 5.11.0 distribution from here.</p> </li> <li> <p>Extract the downloaded archive file. This document refers to the root folder of the extracted file as <code>&lt;IS_HOME&gt;</code>.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-to-wso2-identity-server-5.11.0/#migrate-to-wso2-identity-sever-5110","title":"Migrate to WSO2 Identity Sever 5.11.0","text":"<ol> <li> <p>Get the Upgrading WSO2 IS as Key Manager to 5.11.0 documentation (<code>Upgrade IS as Key Manager 5.10.0 to IS 5.11.0 for APIM 3.2.0 to 4.0.0.md</code>) provided by the WSO2 team.</p> </li> <li> <p>Follow Step B - Migrate IS from 5.10.0 to 5.11.0 under Step 1 - Upgrade IS as Key Manager 5.10.0 to IS 5.11.0 in the above-mentioned document and upgrade your WSO2 Identity Server.</p> </li> <li> <p>Get the Upgrading WSO2 Identity Server to 5.11.0 documentation (<code>migrating-to-5110.md</code>) provided by the WSO2 team.</p> </li> <li> <p>Follow WSO2 Identity Server Migrating to 5.11.0 to upgrade your current IS as KM 5.10.0 distribution to IS 5.11.0 by following the provided documentation.</p> <p>Note</p> <p>In the above documentation, under Steps to migrate to 5.11.0,</p> <ol> <li>Skip steps 1,2, and 4.</li> <li> <p>Do not copy the API Manager - Key Manager specific configurations from        <code>&lt;OLD_IS_KM_HOME&gt;/repository/conf/api-manager.xml</code> of the previous IS as KM version to IS 5.11.0.</p> </li> <li> <p>Before executing the IS migration client according to Step 10, remove the following entries from            <code>migration-config.yaml</code> in the migration-resources directory:</p> <pre><code>- version: \"5.10.0\"\nmigratorConfigs:\n-\nname: \"MigrationValidator\"\norder: 2\n-\nname: \"SchemaMigrator\"\norder: 5\nparameters:\nlocation: \"step2\"\nschema: \"identity\"\n-\nname: \"TenantPortalMigrator\"\norder: 11\n</code></pre> </li> <li> <p>Follow the step 11, only if you have enabled Symmetric Key Encryption in the previous IS as KM setup. If not, skip step 11.</p> </li> </ol> <p>Warning</p> <p>Based on the number of records in the identity tables, the identity component migration will take a considerable time.      Do not stop the server during the migration process. Wait until the migration process finishes completely and the server gets started.</p> </li> <li> <p>After successfully completing the migration, stop the server and remove the following directories and files.</p> <ul> <li>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file.</li> <li>Remove the <code>&lt;IS_HOME&gt;/migration-resources</code> directory.</li> </ul> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-introduction/","title":"Upgrade WSO2 Open Banking from 2.0.0 to 3.0.0 - Introduction","text":"<p>WSO2 Open Banking Accelerator runs on top of WSO2 Identity Server and WSO2 API Manager which are referred to as base products.</p> <p>Given below is the product compatibility matrix for WSO2 Open Banking. This matrix outlines the compatibility between the versions of WSO2 Open Banking solutions involved in this migration and the latest version of the base products they support.</p> WSO2 Open Banking Version Supported WSO2 Identity Server Version Supported WSO2 API Manager Version 2.0.0 5.10.0 3.1.0 3.0.0 6.1.0 4.2.0 <p>The following diagram explains the flow of upgrading the WSO2 Open Banking solution:</p> <p></p> <p>Step 1: Upgrade APIM 3.1.0 to APIM 3.2.0</p> <p>Step 2: Upgrade IS 5.10.0 to IS 5.11.0</p> <p>Step 3: Upgrade APIM 3.2.0 to APIM 4.0.0</p> <p>Step 4: Upgrade IS 5.11.0 to IS 6.1.0</p> <p>Step 5: Upgrade APIM 4.0.0 to APIM 4.2.0</p> <p>Step 6: Migrate Open Banking DB This is the step where you migrate Open Banking data. This involves moving the data from your existing Open Banking platform to the new WSO2 Open Banking platform. This includes data such as customer accounts, transactions, and permissions.</p> <p>Step 7: Migrate Reporting Data Migrating Reporting Data involves moving the data from your existing reporting system to the new WSO2 Open Banking platform. This includes data such as reports, dashboards, and visualizations.</p> <p>Follow the documents below in the given order:</p> <ol> <li>Upgrading to WSO2 API Manager 3.2.0 (<code>upgrade-to-wso2-api-manager-3.2.0.md</code>)</li> <li>Upgrading to WSO2 Identity Sever 5.11.0 (<code>upgrade-to-wso2-identity-server-5.11.0.md</code>)</li> <li>Upgrading API Manager 3.2.0 to 4.0.0 (<code>upgrade-to-wso2-api-manager-4.0.0.md</code>)</li> <li>Upgrade WSO2 API Manager from 4.0.0 to 4.2.0 and WSO2 Identity Server from 5.11.0 to 6.1.0 (<code>upgrade-api-manager-4.0.0-to-4.2.0-and-identity-server-5.11.0-to-6.1.0.md</code>)</li> <li>Migrating Open Banking Data (<code>open-banking-data-migration.md</code>)</li> <li>Migrating Reporting Data (<code>reporting-data-migration.md</code>)</li> <li>Configuring After Migration (<code>modifications-after-migration.md</code>)</li> </ol> <p>This section guides on how to upgrade your WSO2 Open Banking 2.0.0 setup to WSO2 Open Banking 3.0.0 (Accelerator Model). </p> <p>Note</p> <p>WSO2 Open Banking 2.0.0 is based on the WSO2 API Manager 3.1.0 and WSO2 Identity Server 5.10.0 products.</p> <p>Tip</p> <ul> <li>The DCR applications created in Open Banking 2.0.0 should not contain a SoftwareId/IssuerName that includes an      underscore \"_\".</li> <li>If you have such DCR applications, before the migration process, rename the Service Provider Name      of each DCR application's Service Provider application by logging into <code>https://&lt;IS_HOST&gt;:9446/carbon</code>.</li> <li> <p>In your Open Banking 2.0.0 database, check the column size of the following:</p> Database Table Column Data type Size <code>openbank_apimgtdb</code> <code>SP_METADATA</code> <code>VALUE</code> <code>VARCHAR</code> 4096 <ul> <li>If the column size is less than 4096, execute the following command against the <code>SP_METADATA</code> table:<pre><code>``` \nALTER TABLE SP_METADATA MODIFY VALUE VARCHAR(4096); \n```\n</code></pre> </li> </ul> </li> </ul> <p>Next, refer to the Upgrading to WSO2 API Manager 3.2.0 (<code>upgrade-to-wso2-api-manager-3.2.0.md</code>) documentation.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/","title":"Upgrading WSO2 Open Banking from 2.0.0 to 3.0.0","text":"<p>This documentation guides on how to upgrade your WSO2 Open Banking 2.0.0 for the UK setup to WSO2 Open Banking 3.0.0 (Accelerator Model) UK Toolkit 1.0.0.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#overview","title":"Overview","text":"<p>WSO2 Open Banking solution runs on top of WSO2 Identity Server and WSO2 API Manager which are referred to as base products.</p> <p>Given below is the product compatibility matrix for the WSO2 Open Banking solution. This matrix outlines the compatibility between the versions of WSO2 Open Banking solutions involved in this migration and the latest version of the base products they support.</p> WSO2 Open Banking Version Supported WSO2 Identity Server Version Supported WSO2 API Manager Version 2.0.0 5.10.0 3.1.0 3.0.0 6.1.0 (Latest) 4.2.0 (Latest)"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#prerequisites","title":"Prerequisites","text":"<p>We assume that you already have an existing WSO2 Open Banking 2.0.0 solution for the UK. WSO2 API Manager 3.1.0 and WSO2 Identity Server 5.10.0 are the base products required for WSO2 Open Banking 2.0.0. Therefore, we assume you already have WSO2 API Manager 3.1.0 and WSO2 Identity Server 5.10.0.</p> <p>Important:</p> <ul> <li> <p>In order to upgrade your existing Open Banking solution to the latest version, you need to upgrade the base products (WSO2 Identity Server and WSO2 API Manager) to the latest supported version as well.</p> </li> <li> <p>Upgrading the base products involves step-by-step migrations, and therefore it requires several intermediate steps.</p> </li> <li>In addition to the base product migration, you need to configure WSO2 Identity Server as Key Manager. The Key Manager handles all clients, security, and access token-related operations. So you need to configure WSO2 Identity Server as Key Manager in each WSO2 API Manager migration.</li> </ul> <p>The following diagram explains the flow of upgrading the WSO2 Open Banking solution:</p> <p></p> <p>Given below are the steps you need to follow to upgrade your WSO2 Open Banking 2.0.0 for the UK setup to WSO2 Open Banking 3.0.0 - UK Toolkit 1.0.0:</p> <ol> <li> <p>Upgrading WSO2 API Manager from 3.1.0 to 3.2.0 </p> <ol> <li>Setup IS as Key Manager 5.10.0 with API Manager 3.2.0</li> <li>Upgrade API Manager from 3.1.0 to 3.2.0</li> </ol> </li> <li> <p>Upgrading WSO2 Identity Sever from 5.10.0 to 5.11.0 </p> <ol> <li>Upgrade IS as Key Manager 5.10.0 to IS 5.11.0</li> <li>Upgrade WSO2 Identity Sever from 5.10.0 to 5.11.0</li> </ol> </li> <li> <p>Upgrading WSO2 API Manager from 3.2.0 to 4.0.0 </p> <ol> <li>Configuring IS as Key Manager</li> <li>Upgrading API Manager from 3.2.0 to 4.0.0</li> </ol> </li> <li> <p>Upgrading WSO2 API Manager from 4.0.0 to 4.2.0 and WSO2 Identity Server from 5.11.0 to 6.1.0 </p> <ol> <li>Prepare for Migration</li> <li>Upgrading WSO2 Identity Server from 5.11.0 to 6.1.0</li> <li>Upgrading WSO2 API Manager from 4.0.0 to 4.2.0</li> </ol> </li> <li> <p>Migrating Open Banking Data</p> </li> </ol> <p>This is the step where you migrate Open Banking data. This involves moving the data from your existing Open Banking platform to the new WSO2 Open Banking platform. This includes data such as customer accounts, transactions, and permissions.</p> <ol> <li>Migrating Reporting Data </li> </ol> <p>Migrating Reporting Data involves moving the data from your existing reporting system to the new WSO2 Open Banking platform. This includes data such as reports, dashboards, and visualizations.</p> <ol> <li>Configuring After Migration</li> </ol> <p>This section explains the modifications that need to be performed after the upgrade/migration process.</p> <p>Before you begin:</p> <p>Make sure the following:</p> <ul> <li> <p>The DCR applications created in Open Banking 2.0.0 should not contain a SoftwareId/IssuerName that includes an underscore \"_\".</p> </li> <li> <p>If you have such DCR applications, before the migration process, rename the Service Provider Name of each DCR application's Service Provider application by logging into <code>https://&lt;IS_HOST&gt;:9446/carbon</code>.</p> </li> <li> <p>In your Open Banking 2.0.0 database, check the column size of the following:</p> Database Table Column Data type Size <code>openbank_apimgtdb</code> <code>SP_METADATA</code> <code>VALUE</code> <code>VARCHAR</code> 4096 <ul> <li>If the column size is less than 4096, execute the following command against the <code>SP_METADATA</code> table:<pre><code>``` \nALTER TABLE SP_METADATA MODIFY VALUE VARCHAR(4096); \n```\n</code></pre> </li> </ul> </li> </ul>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#1-upgrading-from-wso2-api-manager-310-to-wso2-api-manager-320","title":"1. Upgrading from WSO2 API Manager 3.1.0 to WSO2 API Manager 3.2.0","text":"<p>This section instructs you on how to migrate WSO2 API Manager from 3.1.0 to WSO2 API Manager 3.2.0, which is a prerequisite for upgrading to the latest API Manager version.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#prerequisites_1","title":"Prerequisites","text":"<p>WSO2 API Manager 3.1.0 is a base product of WSO2 Open Banking 2.0.0. Therefore, we assume you already have WSO2 API Manager 3.1.0.</p> <p>Upgrading WSO2 API Manager from 3.1.0 to 3.2.0 consists of 2 steps:</p> <p>a. Upgrade WSO2 IS as Key Manager 5.10.0 for API Manager 3.2.0</p> <p>b. Upgrade WSO2 API Manager from 3.1.0 to 3.2.0</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#a-upgrade-wso2-is-as-key-manager-5100-for-api-manager-320","title":"a. Upgrade WSO2 IS as Key Manager 5.10.0 for API Manager 3.2.0","text":"<p>Follow the Upgrading WSO2 IS as Key Manager 5.10.0 for API Manager 3.2.0 documentation (<code>Upgrade IS as Key Manager 5.10.0 to IS 5.10.0 for APIM 3.1.0 to 3.2.0.md</code>) provided by the WSO2 team and upgrade IS as Key Manager 5.10.0 for API Manager 3.2.0. Follow the entire documentation carefully.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#b-upgrade-wso2-api-manager-from-310-to-320","title":"b. Upgrade WSO2 API Manager from 3.1.0 to 3.2.0","text":"<p>Follow the Upgrading WSO2 API Manager from 3.1.0 to 3.2.0 documentation (<code>upgrading-from-310-to-320.md</code>) provided by the WSO2 team and upgrade WSO2 API Manager from 3.1.0 to 3.2.0. Follow the entire documentation carefully and make sure to perform the necessary custom steps mentioned below:</p> <p>Note</p> <p>In the above documentation, under Step 1 - Migrate the API Manager configurations, skip steps 6,7,8, and 9 as we are only trying to migrate the databases at this level.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#2-upgrading-from-wso2-identity-sever-5100-to-wso2-identity-sever-5110","title":"2. Upgrading from WSO2 Identity Sever 5.10.0 to WSO2 Identity Sever 5.11.0","text":"<p>This section instructs you on how to migrate WSO2 Identity Sever 5.10.0 to WSO2 Identity Sever 5.11.0, which is a prerequisite for upgrading to the latest Identity Sever version.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#prerequisites_2","title":"Prerequisites","text":"<p>WSO2 Identity Sever 5.10.0 is a base product of WSO2 Open Banking 2.0.0. Therefore, we assume you already have WSO2 Identity Sever 5.10.0.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#set-up-is-5110-as-key-manager-for-api-manager-400","title":"Set up IS 5.11.0 as Key Manager for API Manager 4.0.0","text":"<ol> <li> <p>Download and install the WSO2 Identity Server 5.11.0 distribution from here.</p> </li> <li> <p>Extract the downloaded archive file. This document refers to the root folder of the extracted file as <code>&lt;IS_HOME&gt;</code>.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#migrate-to-wso2-identity-sever-5110","title":"Migrate to WSO2 Identity Sever 5.11.0","text":"<ol> <li> <p>Get the Upgrading WSO2 IS as Key Manager to 5.11.0 documentation (<code>Upgrade IS as Key Manager 5.10.0 to IS 5.11.0 for APIM 3.2.0 to 4.0.0.md</code>) provided by the WSO2 team.</p> </li> <li> <p>Follow Step B - Migrate IS from 5.10.0 to 5.11.0 under Step 1 - Upgrade IS as Key Manager 5.10.0 to IS 5.11.0 in the above-mentioned document and upgrade your WSO2 Identity Server.</p> </li> <li> <p>Get the Upgrading WSO2 Identity Server to 5.11.0 documentation (<code>migrating-to-5110.md</code>) provided by the WSO2 team.</p> </li> <li> <p>Follow WSO2 Identity Server Migrating to 5.11.0 to upgrade your current IS as KM 5.10.0 distribution to IS 5.11.0 by following the provided documentation.</p> </li> </ol> <p>Note</p> <p>In the above documentation, under Steps to migrate to 5.11.0,</p> <ol> <li>Skip steps 1,2, and 4.</li> <li> <p>Do not copy the API Manager - Key Manager specific configurations from           &gt;       <code>&lt;OLD_IS_KM_HOME&gt;/repository/conf/api-manager.xml</code> of the previous IS as KM version to IS 5.11.0.</p> </li> <li> <p>Before executing the IS migration client according to Step 10, remove the following entries from           <code>migration-config.yaml</code> in the migration-resources directory:</p> <pre><code>- version: \"5.10.0\"\nmigratorConfigs:\n-\nname: \"MigrationValidator\"\norder: 2\n-\nname: \"SchemaMigrator\"\norder: 5\nparameters:\nlocation: \"step2\"\nschema: \"identity\"\n-\nname: \"TenantPortalMigrator\"\norder: 11\n</code></pre> </li> <li> <p>Follow the step 11, only if you have enabled Symmetric Key Encryption in the previous IS as KM setup. If not, skip step 11.</p> </li> </ol> <p>Warning</p> <p>Based on the number of records in the identity tables, the identity component migration will take a considerable time.   Do not stop the server during the migration process. Wait until the migration process finishes completely and the server gets started.</p> <ol> <li>After successfully completing the migration, stop the server and remove the following directories and files.<ul> <li>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/org.wso2.carbon.is.migration-x.x.x.jar</code> file.</li> <li>Remove the <code>&lt;IS_HOME&gt;/migration-resources</code> directory.</li> </ul> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#3-upgrading-from-wso2-api-manager-320-to-wso2-api-manager-400","title":"3. Upgrading from WSO2 API Manager 3.2.0 to WSO2 API Manager 4.0.0","text":"<p>This section instructs you on how to migrate WSO2 API Manager 3.2.0 to WSO2 API Manager 4.0.0, which is a prerequisite for upgrading to the latest Identity Sever version.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#prerequisites_3","title":"Prerequisites","text":"<p>We assume you have already upgraded your API Manager to 3.2.0 as instructed in a previous step.</p> <ol> <li> <p>Download and install the WSO2 API Manager 4.0.0 distribution from here.</p> </li> <li> <p>Extract the downloaded archive file. This document refers to the root folder of the extracted file as <code>&lt;APIM_HOME&gt;</code>.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#upgrade-to-wso2-api-manager-400","title":"Upgrade to WSO2 API Manager 4.0.0","text":"<p>Before you begin:</p> <p>Once the Identity Server 5.11.0 is configured as the Resident Key Manager, start the Identity Server 5.11.0.</p> <ol> <li> <p>Start the WSO2 API Manager 4.0.0 server and create a Custom Key Manager by following the    Configuring IS as Key Manager documentation.</p> </li> <li> <p>Do not copy any other Key Manager specific configurations from the previous API Manager version to the latest one that points to the Identity Server.</p> </li> <li> <p>Follow the Upgrading WSO2 API Manager from 3.2.0 to 4.0.0 (<code>upgrading-from-320-to-400.md</code>) documentation provided by the WSO2 team and upgrade your API Manager from 3.2.0 to 4.0.0. Follow the entire documentation carefully and make sure to perform the necessary steps mentioned below:</p> </li> </ol> <p>Note</p> <p>When following the above-mentioned documentation:</p> <ol> <li> <p>You can skip the steps 1,2, and 3 under Step 1 - Migrate the API Manager configurations.</p> </li> <li> <p>Modify the following configurations in the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file before starting the migration.</p> <pre><code>[[apim.gateway.environment]]\nname = \"Production and Sandbox\"\n[apim.sync_runtime_artifacts.gateway]\ngateway_labels =[\"Production and Sandbox\", \"Default\"]\n</code></pre> </li> <li> <p>In Step 2 - Upgrade API Manager to 4.0.0, skip the steps 3 and 5.</p> </li> </ol> <ol> <li>Start the API Manager server.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#replace-custom-mediation-policies","title":"Replace Custom Mediation Policies","text":"<p>This section explains how to replace the Custom Mediation Policy of each API with the latest Mediation Policy.</p> <ol> <li>Go to the API Publisher at <code>https://&lt;APIM_HOST&gt;:9443/publisher</code>.</li> <li>Select the respective API.</li> <li>Go to API Configurations &gt; Runtime.</li> <li>Click the Edit button under Request &gt; Message Mediation and remove the existing Custom Mediation Policy.</li> <li>Upload the relevant insequence file from the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources/apis</code> directory    and click Select.</li> <li>Scroll down and click SAVE.</li> <li>Go to Deployments using the left menu pane.</li> <li>Click Deploy New Version.</li> <li>Select the API Gateway type and Deploy.</li> <li>Repeat these steps for all APIs.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#enable-schema-validation","title":"Enable Schema Validation","text":"<p>This section explains how to enable Schema Validation for APIs.</p> <ol> <li>Go to the API Publisher at <code>https://&lt;APIM_HOST&gt;:9443/publisher</code>.</li> <li>Select the respective API.</li> <li>Go to API Configurations &gt; Runtime.</li> <li>Enable Schema Validation.</li> <li>Scroll down and click SAVE.</li> <li>Go to Deployments using the left menu pane.</li> <li>Click Deploy New Version.</li> <li>Select the API Gateway type and Deploy.</li> <li>Repeat these steps for all APIs except for the Dynamic Client Registration(DCR) API.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#update-workflow-extensions","title":"Update Workflow-Extensions","text":"<ol> <li>Go to the Management Console <code>https://&lt;APIM_HOST&gt;:9443/carbon</code> and log in as the admin user. </li> <li>Select Resources &gt; Browse in the left pane.  </li> <li>Locate the <code>/_system/governance/apimgt/applicationdata/workflow-extensions.xml</code> file. </li> <li>Get the <code>workflow.txt</code> provided by the WSO2 team.</li> <li>Click Edit as text and replace the content with the content you received. </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#update-api-life-cycle","title":"Update API Life Cycle","text":"<ol> <li>Go to the Management Console <code>https://&lt;APIM_HOST&gt;:9443/carbon</code> and log in as the admin user. </li> <li>Select Extensions &gt; Lifecycles.  </li> <li>Click the View/Edit button for APILifeCycle. </li> <li>Get the <code>lifecycle.txt</code> provided by the WSO2 team.</li> <li>Replace the Lifecycle Source with the content you received.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#update-identity-provider-entity-id","title":"Update Identity Provider Entity ID","text":"<ol> <li>Go to Identity Server Management Console <code>https://&lt;IS_HOST&gt;:9446/carbon</code> and log in as the admin user.</li> <li>Select Identity Providers &gt; Resident. </li> <li>Go to Inbound Authentication Configuration &gt; OAuth2/OpenID Connect Configuration.</li> <li>Update the Identity Provider Entity ID to the following:     <pre><code>https://&lt;IS_HOST&gt;:9446/oauth2/token\n</code></pre></li> </ol> <ol> <li>Click Update.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#4-upgrading-from-wso2-api-manager-400-to-wso2-api-manager-420-and-from-wso2-identity-server-5110-to-wso2-identity-server-610","title":"4. Upgrading from WSO2 API Manager 4.0.0 to WSO2 API Manager 4.2.0 and from WSO2 Identity Server 5.11.0 to WSO2 Identity Server 6.1.0","text":"<p>WSO2 Open Banking 3.0.0 - UK Toolkit 1.0.0 runs on top of WSO2 API Manager 4.2.0 and WSO2 Identity Server 6.1.0. Therefore, you need to upgrade your API Manager and Identity Server to the above-mentioned versions in order to migrate your Open Banking Solution to the latest version.</p> <p>This section instructs you on how to migrate, - WSO2 API Manager 4.0.0 to WSO2 API Manager 4.2.0 - WSO2 Identity Server 5.11.0 to WSO2 Identity Server 6.1.0</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#prerequisites_4","title":"Prerequisites","text":"<p>Up to this point, you have already migrated to WSO2 API Manager 4.0.0 and WSO2 Identity Server to 5.11.0 as instructed in the previous steps.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#prepare-for-migration","title":"Prepare for Migration","text":"<p>In the following section, you will be setting up Open Banking Accelerator and UK Toolkit for Identity Server and API Manager. </p> <ol> <li> <p>Download WSO2 Identity Server 6.1.0 from here and extract the folder. This extracted folder will be referred to as <code>&lt;IS_HOME&gt;</code> in this document.</p> </li> <li> <p>Download WSO2 API Manager 4.2.0 from here and extract the folder. This extracted folder will be referred to as <code>&lt;APIM_HOME&gt;</code> in this document.</p> </li> <li> <p>Get WSO2 Open Banking Accelerator 3.0.0 provided by the WSO2 team.</p> </li> <li> <p>Extract the WSO2 Open Banking Accelerator zip files. Get the following accelerators and extract them.</p> <ul> <li><code>wso2-obiam-accelerator-3.0.0</code></li> <li><code>wso2-obam-accelerator-3.0.0</code></li> </ul> </li> <li> <p>Get WSO2 Open Banking UK Toolkit 1.0.0 provided by the WSO2 team. Get the following toolkits and extract them.</p> <ul> <li><code>wso2-obiam-toolkit-uk-1.0.0</code></li> <li><code>wso2-obam-toolkit-uk-1.0.0</code></li> </ul> </li> <li> <p>This document uses the following placeholders to refer to the following products:</p> </li> </ol> Product Placeholder WSO2 Identity Server 6.1.0 <code>&lt;IS_HOME&gt;</code> WSO2 API Manager 4.2.0 <code>&lt;APIM_HOME&gt;</code> WSO2 Open Banking Identity Server Accelerator 3.0.0 <code>&lt;OB_IS_ACCELERATOR_HOME&gt;</code> WSO2 Open Banking API Manager Accelerator 3.0.0 <code>&lt;OB_APIM_ACCELERATOR_HOME&gt;</code> WSO2 Open Banking Identity Server UK Toolkit 1.0.0 <code>&lt;OB_IS_TOOLKIT_HOME&gt;</code> WSO2 Open Banking API Manager UK Toolkit 1.0.0 <code>&lt;OB_APIM_TOOLKIT_HOME&gt;</code> <ol> <li> <p>Follow the Getting WSO2 Updates documentation and update the base products, accelerators, and toolkits using relevant scripts.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_ACCELERATOR_HOME&gt;/bin</code> and <code>&lt;IS_HOME&gt;/&lt;OB_IS_ACCELERATOR_HOME&gt;/bin</code> respectively to copy the Open Banking artifacts into the base product packs.</p> </li> </ol> <pre><code>./merge.sh\n</code></pre> <ol> <li>Run the <code>merge.sh</code> script in <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/bin</code> and <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/bin</code> respectively:</li> </ol> <pre><code>./merge.sh\n</code></pre> <ol> <li> <p>Add the relevant modifications to the <code>wso2is-5.11.0-deployment-uk.toml</code> file in the <code>&lt;IS_HOME&gt;/&lt;OB_IS_TOOLKIT_HOME&gt;/repository/resources</code> directory.</p> </li> <li> <p>Rename <code>wso2is-5.11.0-deployment-uk.toml</code> to <code>deployment.toml</code>.</p> </li> <li> <p>Copy the <code>deployment.toml</code> file to the <code>&lt;IS_HOME&gt;/repository/conf</code> directory to replace the existing file.</p> </li> <li> <p>Open the <code>&lt;IS_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related    properties accordingly.</p> <ul> <li>When configuring database related properties, ensure that the datasources are pointing to the existing databases.</li> </ul> </li> <li> <p>Add the relevant modifications to the <code>wso2am-4.0.0-deployment-uk.toml</code> file in the <code>&lt;APIM_HOME&gt;/&lt;OB_APIM_TOOLKIT_HOME&gt;/repository/resources</code> directory.</p> </li> <li> <p>Rename <code>wso2am-4.0.0-deployment-uk.toml</code> to <code>deployment.toml</code>.</p> </li> <li> <p>Copy the <code>deployment.toml</code> file to the <code>&lt;APIM_HOME&gt;/repository/conf</code> directory to replace the existing file.</p> </li> <li> <p>Open the <code>&lt;APIM_HOME&gt;/repository/conf/deployment.toml</code> file, and configure the hostnames and databases related     properties accordingly.</p> <ul> <li>When configuring database related properties, ensure that the datasources are pointing to the existing databases.</li> </ul> </li> <li> <p>Add the following configurations needed for Identity Server 6.1.0 and API Manager 4.2.0.</p> <ol> <li> <p>Add the following configuration in IS 6.1.0 deployment.toml</p> <pre><code>[application_mgt]\nenable_role_validation = true\n</code></pre> </li> <li> <p>Add the following configuration in the <code>deployment.toml</code> file of API Manager 4.2.0 after the configurations done under <code>[open_banking.dcr]</code>. Note that the version must be specified as <code>v3</code> for API Manager 4.2.0.</p> <pre><code>[open_banking.dcr.apim_rest_endpoints]\napp_creation = \"api/am/devportal/v3/applications\"\nkey_generation = \"api/am/devportal/v3/applications/application-id/map-keys\"\napi_retrieve = \"api/am/devportal/v3/apis\"\napi_subscribe = \"api/am/devportal/v3/subscriptions/multiple\"\nretrieve_subscribe=\"api/am/devportal/v3/subscriptions\u201d\n</code></pre> </li> </ol> </li> <li> <p>Now all the Open Banking related artifacts and configurations are included in the base packs.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#upgrading-wso2-identity-server-from-5110-to-610","title":"Upgrading WSO2 Identity Server from 5.11.0 to 6.1.0","text":"<ol> <li>Follow the Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0 documentation (<code>Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0.md</code>) provided by the WSO2 team to upgrade WSO2 Identity Server from 5.11.0 to 6.1.0. Follow the entire documentation carefully and make sure to perform the necessary custom steps mentioned below:</li> </ol> <p>Note:</p> <p>Please note that the instructions provided in the above-mentioned document are also applicable for WSO2 Identity Server 6.1.0.</p> <ol> <li> <p>Follow the step 4 under Step A: Upgrade IS 5.11.0 to IS 6.0.0 &gt; Step 1: Migrate the IS configurations if applicable.</p> </li> <li> <p>Step 5 under Step A: Upgrade IS 5.11.0 to IS 6.0.0 &gt; Step 1: Migrate the IS configurations refers to the <code>Configurations</code> section of the Migrating to 6.1.0 documentation (<code>migrate-to-610.md</code>). Skip the step 3 of that section.</p> </li> <li> <p>Follow the steps mentioned in the <code>Note</code> provided under the step 5 under Step A: Upgrade IS 5.11.0 to IS 6.0.0 &gt; Step 1: Migrate the IS configurations.</p> </li> </ol> <p>Note:</p> <p>Here, we need to point the datasources to the existing databases.</p> <ol> <li> <p>When following the step 2 of the Step 2: Migrate the IS Resources in the above-mentioned document, use the IS connector related to the API Manager 4.2.0 provided by the WSO2 team (<code>wso2is-extensions-1.6.8.zip</code>). Please use the jar versions included in the provided <code>wso2is-extensions-1.6.8.zip</code> folder.</p> </li> <li> <p>For the step 4 under the Step 2: Migrate the IS Resources topic in the above-mentioned documentation please refer to the Migrating to 6.1.0 documentation (<code>migrate-to-610.md</code>). Follow all the steps in Step A: Upgrade IS 5.11.0 to IS 6.0.0/6.1.0 in order, skipping the steps mentioned below.</p> <ol> <li> <p>Skip the Components section under Step 1: Migrate artifacts and configs when following the above-mentioned documentation (<code>migrate-to-610.md</code>).</p> </li> <li> <p>When following the Resources section under Step 1: Migrate artifacts and configs, skip the configurations included inside the Note.</p> </li> <li> <p>Skip the Tenants section under Step 1: Migrate artifacts and configs.</p> </li> <li> <p>The User Stores section under Step 1: Migrate artifacts and configs is optional.</p> </li> <li> <p>Skip the Webapps section under Step 1: Migrate artifacts and configs.</p> </li> <li> <p>The instructions under the Configurations section is already followed at this point. Therefore, not need to follow that..</p> </li> </ol> </li> <li> <p>When following Step 3: Migrate the IS Components in the Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0 documentation (<code>Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0.md</code>) use the migration tool provided by the WSO2 team (<code>wso2is-migration-1.1.163.zip</code>).</p> </li> <li> <p>Then run the migration tool at the step 8 after following the rest of the instructions.</p> </li> <li> <p>Following the Step A: Upgrade IS 5.11.0 to IS 6.0.0/6.1.0 of the Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0 documentation (<code>Upgrade IS 5.11.0 to IS 6.0.0 for APIM 4.0.0 to 4.2.0.md</code>) with the above instructions, concludes the Identity Server migration.</p> </li> </ol> <p>Then start the API Manager migration.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#upgrading-wso2-api-manager-from-400-to-420","title":"Upgrading WSO2 API Manager from 4.0.0 to 4.2.0","text":"<p>Follow the Upgrading API Manager from 4.0.0 to 4.2.0 documentation (<code>upgrading-from-400-to-420.md</code>) provided by the WSO2 team to perform the API Manager migration. Follow the entire documentation carefully and make sure to perform the necessary custom steps mentioned below:</p> <ol> <li> <p>When following step 1 in Step 1: Migrate the API Manager Configurations, make sure to point the datasources to the existing databases.</p> </li> <li> <p>When setting the <code>realm_manager</code>, set it as same as the datasource name of the user database of Open Banking (for example, by default it is <code>WSO2UM_DB</code>.)</p> </li> <li> <p>Skip step 3 under Step 1: Migrate the API Manager Configurations.</p> </li> <li> <p>Follow step 4 under Step 1: Migrate the API Manager Configurations if applicable.</p> </li> <li> <p>For the step 5 under Step 1: Migrate the API Manager Configurations use the relevant database scripts provided by the WSO2 team (<code>db-scripts/upgrading-from-400-to-420</code>).</p> </li> <li> <p>When following Step 2: Migrate the API Manager Resources in the above-mentioned documentation,</p> <ul> <li>Skip steps 2 and 3.</li> <li>Follow the step 4 only if the secure vault is enabled.</li> <li>Skip step 5 if the setup does not have a secondary user store.</li> <li>Skip step 6.</li> </ul> </li> <li> <p>Skip Step 3: Migrate the Identity Components.</p> </li> <li> <p>When migrating the API Manager components under Step 4: Migrate the API Manager Components, use the latest API Manager migration tool provided by the WSO2 team (<code>wso2am-migration-4.2.0.54.zip</code>).</p> </li> <li> <p>Before running the migration tool for APIM migration, make sure the Identity Server is up.</p> </li> <li> <p>Skip the instructions inside the Note under Step 6: Restart the API Manager Server.</p> </li> <li> <p>Restart the WSO2 API Manager Server.</p> </li> <li> <p>Following the Upgrading API Manager from 4.0.0 to 4.2.0 documentation (<code>upgrading-from-400-to-420.md</code>) with the above instructions, concludes the API Manager migration.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#5-migrating-open-banking-data","title":"5. Migrating Open Banking Data","text":"<p>In this step, you will transfer your Open Banking data from your existing Open Banking 2.0.0 platform to the new WSO2 Open Banking 3.0.0 platform. This process includes moving important information such as customer accounts, transactions, and permissions.</p> <p>Before you begin:</p> <p>Back up all the databases before performing the migration.</p> <ol> <li>To create the required database tables:<ul> <li>Run the relevant SQL script in the <code>&lt;IS_HOME&gt;/dbscripts/open-banking/consent</code> directory against   the <code>openbank_openbankingdb</code> database.</li> </ul> </li> <li>Get the WSO2 Open Banking Migration Client Tool v1.0.0 (<code>wso2-openbanking-migration-1.0.0.zip</code>) provided by the WSO2 team.</li> <li>Copy the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources</code> directory to <code>&lt;IS_HOME&gt;</code>.</li> <li>Copy the <code>wso2-openbanking-migration-1.0.0/dropins/com.wso2.openbanking.migration-1.0.0.jar</code> file to <code>&lt;IS_HOME&gt;/repository/components/dropins</code>.</li> <li>Open the <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/migration-config.yaml</code> file and    set the <code>migrationEnable</code> property to <code>true</code>.</li> <li> <p>Start the Identity Server with the following command:</p> <pre><code>   sh wso2server.sh -DobMigrationSpec=UK\n</code></pre> </li> <li> <p>Stop the server.</p> </li> </ol> <p>Warning</p> <p>If a failure occurred during the migration process, delete all the migrated data from the tables that    were generated during migration.</p> <ol> <li>Remove the <code>&lt;IS_HOME&gt;/repository/components/dropins/com.wso2.openbanking.migration-1.0.0.jar</code> file.</li> <li>Remove the <code>&lt;IS_HOME&gt;/openbanking-migration-resources</code> directory.</li> <li>Start the Identity Server and API Manager servers.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#6-migrating-reporting-data","title":"6. Migrating Reporting Data","text":"<p>In this step, you will transfer data from your existing reporting system to the new WSO2 Open Banking platform. This will involve moving data related to reports, dashboards, and visualizations.</p> <p>Before you begin:</p> <p>Make sure you are running Data Reporting v3.1.5 in your WSO2 Open Banking Business Intelligence 2.0.0 setup.    If not, follow the Upgrading Data Reporting from v3.1.2 to v3.1.5 documentation and upgrade.</p> <ol> <li>Stop the WSO2 Open Banking Business Intelligence 2.0.0 server if it is running.</li> <li>Download and install the WSO2 Streaming Integrator 4.0.0 distribution from here.</li> <li>Backup your <code>openbank_ob_reporting_statsdb</code> and <code>openbank_ob_reporting_summarizeddb</code> databases of your WSO2 Open Banking Business Intelligence 2.0.0 setup.</li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#set-up-open-banking-accelerator-and-uk-toolkit-for-streaming-integrator","title":"Set up Open Banking Accelerator and UK Toolkit for Streaming Integrator","text":"<p>Set up WSO2 Open Banking Business Intelligence Accelerator and WSO2 Open Banking Business Intelligence UK Toolkit as follows:</p> <p>Note</p> <ul> <li><code>&lt;SI_HOME&gt;</code> refers to the root directory of WSO2 Streaming Integrator.</li> <li><code>&lt;OB_BI_ACCELERATOR_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence Accelerator.</li> <li><code>&lt;OB_BI_TOOLKIT_HOME&gt;</code> refers to the root directory of WSO2 Open Banking Business Intelligence UK Toolkit.</li> </ul> <ol> <li> <p>Copy and extract the <code>wso2-obbi-accelerator-3.0.0.zip</code> accelerator file in the root directory of WSO2 Streaming    Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/bin</code>:</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Copy and extract the <code>wso2-obbi-toolkit-uk-1.0.0.zip</code> toolkit file in the root directory of WSO2 Streaming    Integrator.</p> </li> <li> <p>Run the <code>merge.sh</code> script in <code>&lt;SI_HOME&gt;/&lt;OB_BI_TOOLKIT_HOME&gt;/bin</code>.</p> <pre><code>./merge.sh\n</code></pre> </li> <li> <p>Replace the existing <code>deployment.yaml</code> file in the Streaming Integrator as follows:</p> <ul> <li>Go to the <code>&lt;SI_HOME&gt;/&lt;OB_BI_ACCELERATOR_HOME&gt;/repository/resources</code> directory.</li> <li>Rename <code>wso2si-4.0.0-deployment.yaml</code> to <code>deployment.yaml</code>.</li> <li>Copy the <code>deployment.yaml</code> file to the <code>&lt;SI_HOME&gt;/conf/server</code> directory to replace the existing file.</li> </ul> </li> <li> <p>Open the <code>&lt;SI_HOME&gt;/conf/server/deployment.toml</code> file, and configure the hostnames and databases related    properties accordingly.</p> <ul> <li>When configuring database related properties, point to your existing Open Banking 2.0 databases.</li> </ul> </li> <li> <p>Exchange the public certificates between servers.</p> </li> </ol> <p>Follow the steps given below:</p> <p>a. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and export the public certificate of the Streaming    Integrator:</p> <pre><code>keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeySI.pem\n</code></pre> <p>b. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and import the public certificate of the    Streaming Integrator to the truststore of the Identity Server:</p> <pre><code>keytool -import -alias wso2 -file publickeySI.pem -keystore client-truststore.jks -storepass wso2carbon\n</code></pre> <p>c. Go to the <code>&lt;IS_HOME&gt;/repository/resources/security</code> directory and export the public certificate of the    Identity Server:</p> <pre><code>keytool -export -alias wso2carbon -keystore wso2carbon.jks -file publickeyIAM.pem\n</code></pre> <p>d. Go to the <code>&lt;SI_HOME&gt;/resources/security</code> directory and import the public certificate of the Identity    Server to the truststore of the Streaming Integrator:</p> <pre><code>keytool -import -alias wso2 -file publickeyIAM.pem -keystore client-truststore.jks -storepass wso2carbon\n</code></pre> <p>e. Go to the <code>&lt;APIM_HOME&gt;/repository/resources/security</code> directory and repeat step b,c, and d.</p>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#upgrade-to-wso2-streaming-integrator-400","title":"Upgrade to WSO2 Streaming Integrator 4.0.0","text":"<ol> <li> <p>To migrate the reporting data and tables from the Open Banking 2.0 setup to 3.0.</p> <ul> <li>Go to the   <code>wso2-openbanking-migration-1.0.0/openbanking-migration-resources/reporting-migration-scripts/uk</code>   directory.</li> <li>Select the relevant SQL script and execute it against your <code>openbank_ob_reporting_statsdb</code> database.</li> </ul> </li> <li> <p>Start the Streaming Integrator server. For more information, see Try Out Data Publishing.</p> </li> </ol>"},{"location":"open-banking/migration-docs/ob-2.0.0-to-3.0.0/uk-toolkit-1.0.0/old-content-backup/upgrade-wso2-open-banking-2.0.0-to-3.0.0-uk-toolkit-1.0.0-v2/#7-configuring-after-migration","title":"7. Configuring After Migration","text":"<p>This section explains the modifications that need to be performed after the upgrade/migration process.</p> <ol> <li> <p>Stop the servers if running.</p> </li> <li> <p>Remove <code>com.wso2.openbanking.migration-1.0.0.jar</code> from the <code>IS_HOME&gt;/repository/components/dropins</code> folder.</p> </li> <li> <p>Remove <code>openbanking-migration-resources</code> folder from the <code>&lt;IS_HOME&gt;/repository/components/dropins</code> folder.</p> </li> </ol> <p>Note:</p> <p>Make sure to perform the following changes before starting with the Open Banking flows:    1. Redeploy the APIs with the relevant insequence files supported in WSO2 Open Banking 3.0.0 UK Toolkit 1.0.0.    2. Ensure the Production/Sandbox Endpoints of the published APIs are precise.</p> <ul> <li>Follow the Quick Start Guide - Tryout Flow of the UK Toolkit 1.0.0 documentation for a sample tryout flow of the Account and Transaction API.</li> <li>Navigate to the Tryout section in the UK Toolkit 1.0.0 documentation for more information on API flows.</li> </ul> <ol> <li> <p>Restart the WSO2 Identity Server.</p> </li> <li> <p>Restart the WSO2 API Manager Server. </p> </li> </ol>"}]}